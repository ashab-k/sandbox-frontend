Function: FUN_00401000
----------------------------------------

undefined4 FUN_00401000(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = FUN_0040113e(param_1);
  iVar2 = FUN_00401025(param_1);
  if ((iVar1 == 0) && (iVar2 == 0)) {
    return 0;
  }
  return 0xffffffff;
}



Function: FUN_00401025
----------------------------------------

undefined4 __cdecl FUN_00401025(int *param_1)

{
  int *piVar1;
  uint uVar2;
  uint uVar3;
  int iVar4;
  int unaff_ESI;
  undefined4 uVar5;
  char local_1210 [2048];
  char local_a10 [2048];
  byte local_210 [472];
  undefined4 uStackY_38;
  
  FUN_00404a80();
  piVar1 = param_1;
  uVar5 = 0;
  uVar2 = NR_RegGetKey(param_1,4,s_Mozilla_XPInstall_Replace_List_0040f050,
                       (undefined4 *)&stack0xfffffff8);
  if (uVar2 == 0) {
    param_1 = (int *)0x0;
    while (uVar2 = NR_RegEnumSubkeys(piVar1,unaff_ESI,(int *)&param_1,local_210,0x200,0), uVar2 == 0
          ) {
      uVar2 = NR_RegGetEntry(piVar1,(char *)param_1,s_ReplacementFile_0040f040,local_1210,
                             (uint *)&stack0xfffffff4);
      uStackY_38 = 0x4010a3;
      uVar3 = NR_RegGetEntry(piVar1,(char *)param_1,s_DestinationFile_0040f030,local_a10,
                             (uint *)&stack0xfffffff4);
      if (((uVar2 == 0) && (uVar3 == 0)) && (iVar4 = FUN_00401242(local_1210,local_a10), iVar4 == 0)
         ) {
        NR_RegDeleteKey(piVar1,unaff_ESI,(char *)local_210);
      }
    }
    param_1 = (int *)0x0;
    uVar2 = NR_RegEnumSubkeys(piVar1,unaff_ESI,(int *)&param_1,local_210,0x200,0);
    if (uVar2 == 2) {
      NR_RegDeleteKey(piVar1,4,s_Mozilla_XPInstall_Replace_List_0040f050);
      uVar5 = 0;
    }
    else {
      uVar5 = 0xffffffff;
    }
  }
  return uVar5;
}



Function: FUN_0040113e
----------------------------------------

undefined4 __cdecl FUN_0040113e(int *param_1)

{
  int *piVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  char local_a0c [2048];
  char local_20c [512];
  uint local_c [2];
  
  piVar1 = param_1;
  uVar4 = 0;
  local_c[1] = 0;
  uVar2 = NR_RegGetKey(param_1,4,s_Mozilla_XPInstall_Delete_List_0040f070,&param_1);
  if (uVar2 == 0) {
    while (uVar2 = NR_RegEnumEntries(piVar1,(int)param_1,(int *)(local_c + 1),local_20c,0x200,
                                     (ushort *)0x0), uVar2 == 0) {
      local_c[0] = 0x800;
      uVar2 = NR_RegGetEntry(piVar1,(char *)param_1,local_20c,local_a0c,local_c);
      if ((uVar2 == 0) && (iVar3 = FUN_0040121e(local_a0c), iVar3 == 0)) {
        NR_RegDeleteEntry(piVar1,(int)param_1,local_20c);
      }
    }
    local_c[1] = 0;
    uVar2 = NR_RegEnumEntries(piVar1,(int)param_1,(int *)(local_c + 1),local_20c,0x200,(ushort *)0x0
                             );
    if (uVar2 == 2) {
      NR_RegDeleteKey(piVar1,4,s_Mozilla_XPInstall_Delete_List_0040f070);
      uVar4 = 0;
    }
    else {
      uVar4 = 0xffffffff;
    }
  }
  return uVar4;
}



Function: FUN_0040121e
----------------------------------------

int __cdecl FUN_0040121e(LPCSTR param_1)

{
  DWORD DVar1;
  BOOL BVar2;
  
  DVar1 = GetFileAttributesA(param_1);
  if (DVar1 == 0xffffffff) {
    return 0;
  }
  BVar2 = DeleteFileA(param_1);
  return (BVar2 != 0) - 1;
}



Function: FUN_00401242
----------------------------------------

int __cdecl FUN_00401242(LPCSTR param_1,LPCSTR param_2)

{
  DWORD DVar1;
  int iVar2;
  BOOL BVar3;
  
  DVar1 = GetFileAttributesA(param_1);
  if ((DVar1 == 0xffffffff) ||
     (iVar2 = CompareStringA(0x800,0x1001,param_1,-1,param_2,-1), iVar2 == 2)) {
    return 0;
  }
  BVar3 = DeleteFileA(param_2);
  if ((BVar3 == 0) && (DVar1 = GetFileAttributesA(param_2), DVar1 != 0xffffffff)) {
    return -1;
  }
  BVar3 = MoveFileA(param_1,param_2);
  return (BVar3 != 0) - 1;
}



Function: FUN_004012a8
----------------------------------------

undefined4 FUN_004012a8(void)

{
  int iVar1;
  DWORD DVar2;
  char *pcVar3;
  uint uVar4;
  size_t cbData;
  uint local_218 [65];
  uint local_114 [65];
  DWORD local_10;
  int local_c;
  HKEY local_8;
  
  iVar1 = NR_StartupRegistry();
  if (iVar1 == 0) {
    DVar2 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_218,0x104);
    if (DVar2 != 0) {
      FUN_00404b30(local_114,local_218);
      pcVar3 = _strrchr((char *)local_114,0x5c);
      pcVar3[1] = '\0';
      FUN_00404b40(local_114,(uint *)s_xpicleanup_dat_0040f0d4);
      DVar2 = GetFileAttributesA((LPCSTR)local_114);
      if (DVar2 == 0xffffffff) {
        FUN_00404b30(local_114,(uint *)&DAT_00411eb0);
      }
      uVar4 = NR_RegOpen((char *)local_114,&local_c);
      if (uVar4 == 0) {
        RegCreateKeyExA((HKEY)0x80000001,s_Software_Microsoft_Windows_Curre_0040f0a0,0,(LPSTR)0x0,0,
                        0x20006,(LPSECURITY_ATTRIBUTES)0x0,&local_8,&local_10);
        cbData = _strlen((char *)local_218);
        RegSetValueExA(local_8,s_mozilla_cleanup_0040f090,0,1,(BYTE *)local_218,cbData);
        do {
          iVar1 = FUN_00401000(local_c);
          if (iVar1 != 0) {
            Sleep(1000);
          }
        } while (iVar1 == -1);
        RegDeleteValueA(local_8,s_mozilla_cleanup_0040f090);
        NR_RegClose(&local_c);
      }
      NR_ShutdownRegistry();
      DeleteFileA((LPCSTR)local_114);
    }
  }
  return 0;
}



Function: NR_RegGetUsername
----------------------------------------

undefined4 __cdecl NR_RegGetUsername(undefined4 *param_1)

{
  uint *puVar1;
  undefined4 uVar2;
  
                    /* 0x13e7  15  NR_RegGetUsername */
  if (param_1 == (undefined4 *)0x0) {
    uVar2 = 6;
  }
  else {
    puVar1 = (uint *)FUN_0040140f();
    puVar1 = FUN_0040c1dc(puVar1);
    *param_1 = puVar1;
    if (puVar1 != (uint *)0x0) {
      return 0;
    }
    uVar2 = 10;
  }
  return uVar2;
}



Function: FUN_0040140f
----------------------------------------

char * FUN_0040140f(void)

{
  char *pcVar1;
  
  pcVar1 = DAT_00411ec0;
  if (DAT_00411ec0 == (char *)0x0) {
    pcVar1 = s_default_0040f0e4;
  }
  return pcVar1;
}



Function: NR_RegSetBufferSize
----------------------------------------

undefined4 NR_RegSetBufferSize(void)

{
                    /* 0x141e  18  NR_RegSetBufferSize */
  return 0xffffffff;
}



Function: FUN_00401423
----------------------------------------

undefined4 FUN_00401423(void)

{
  return 0xffffffff;
}



Function: NR_RegSetUsername
----------------------------------------

undefined4 __cdecl NR_RegSetUsername(uint *param_1)

{
  uint *puVar1;
  undefined4 uVar2;
  
                    /* 0x1443  21  NR_RegSetUsername */
  if ((param_1 == (uint *)0x0) || ((char)*param_1 == '\0')) {
    uVar2 = 6;
  }
  else {
    puVar1 = FUN_0040c1dc(param_1);
    if (puVar1 != (uint *)0x0) {
      if (DAT_00411ec0 != (uint *)0x0) {
        FUN_00404d98((undefined *)DAT_00411ec0);
      }
      DAT_00411ec0 = puVar1;
      return 0;
    }
    uVar2 = 10;
  }
  return uVar2;
}



Function: NR_RegOpen
----------------------------------------

uint __cdecl NR_RegOpen(char *param_1,undefined4 *param_2)

{
  char cVar1;
  uint *puVar2;
  int *_Dst;
  uint *puVar3;
  undefined3 extraout_var;
  undefined4 *puVar4;
  uint uStack_8;
  
                    /* 0x1481  17  NR_RegOpen */
  if (param_2 == (undefined4 *)0x0) {
    return 6;
  }
  *param_2 = 0;
  puVar2 = (uint *)FUN_0040206e(param_1);
  if (puVar2 == (uint *)0x0) {
    puVar2 = (uint *)&DAT_00411eb0;
  }
  _Dst = (int *)FUN_00401615(param_1,(byte *)puVar2);
  if (_Dst != (int *)0x0) {
LAB_0040155e:
    puVar4 = (undefined4 *)_malloc(8);
    if (puVar4 == (undefined4 *)0x0) {
      if (_Dst[5] == 0) {
        FUN_00401695(_Dst);
        FUN_004015d5((undefined *)_Dst);
      }
      return 10;
    }
    *puVar4 = 0x76644441;
    puVar4[1] = _Dst;
    _Dst[5] = _Dst[5] + 1;
    *param_2 = puVar4;
    return 0;
  }
  _Dst = (int *)_malloc(0x44);
  if (_Dst == (int *)0x0) {
    return 10;
  }
  _memset(_Dst,0,0x44);
  _Dst[7] = 1;
  puVar3 = FUN_0040c1dc(puVar2);
  _Dst[9] = (int)puVar3;
  if (puVar3 == (uint *)0x0) {
    FUN_00404d98((undefined *)_Dst);
    return 10;
  }
  cVar1 = FUN_0040163b((byte *)puVar2,_Dst);
  uStack_8 = CONCAT31(extraout_var,cVar1);
  if (uStack_8 == 0x12) {
    uStack_8 = 0;
    _Dst[8] = 1;
  }
  if (uStack_8 != 0) {
    FUN_00404d98((undefined *)_Dst[9]);
    FUN_00404d98((undefined *)_Dst);
    return uStack_8;
  }
  uStack_8 = FUN_004016ae(_Dst);
  if (uStack_8 == 0) {
    _Dst[5] = 0;
    uStack_8 = FUN_00401b4b(_Dst);
    if (uStack_8 == 0) {
      FUN_004015b4((int)_Dst);
      _Dst[7] = 0;
      goto LAB_0040155e;
    }
  }
  FUN_00401695(_Dst);
  FUN_00404d98((undefined *)_Dst[9]);
  FUN_00404d98((undefined *)_Dst);
  return uStack_8;
}



Function: FUN_00401486
----------------------------------------

uint __cdecl FUN_00401486(char *param_1,undefined4 *param_2)

{
  char cVar1;
  uint *puVar2;
  int *_Dst;
  uint *puVar3;
  undefined3 extraout_var;
  undefined4 *puVar4;
  uint local_8;
  
  if (param_2 == (undefined4 *)0x0) {
    return 6;
  }
  *param_2 = 0;
  puVar2 = (uint *)FUN_0040206e(param_1);
  if (puVar2 == (uint *)0x0) {
    puVar2 = (uint *)&DAT_00411eb0;
  }
  _Dst = (int *)FUN_00401615(param_1,(byte *)puVar2);
  if (_Dst != (int *)0x0) {
LAB_0040155e:
    puVar4 = (undefined4 *)_malloc(8);
    if (puVar4 == (undefined4 *)0x0) {
      if (_Dst[5] == 0) {
        FUN_00401695(_Dst);
        FUN_004015d5((undefined *)_Dst);
      }
      return 10;
    }
    *puVar4 = 0x76644441;
    puVar4[1] = _Dst;
    _Dst[5] = _Dst[5] + 1;
    *param_2 = puVar4;
    return 0;
  }
  _Dst = (int *)_malloc(0x44);
  if (_Dst == (int *)0x0) {
    return 10;
  }
  _memset(_Dst,0,0x44);
  _Dst[7] = 1;
  puVar3 = FUN_0040c1dc(puVar2);
  _Dst[9] = (int)puVar3;
  if (puVar3 == (uint *)0x0) {
    FUN_00404d98((undefined *)_Dst);
    return 10;
  }
  cVar1 = FUN_0040163b((byte *)puVar2,_Dst);
  local_8 = CONCAT31(extraout_var,cVar1);
  if (local_8 == 0x12) {
    local_8 = 0;
    _Dst[8] = 1;
  }
  if (local_8 != 0) {
    FUN_00404d98((undefined *)_Dst[9]);
    FUN_00404d98((undefined *)_Dst);
    return local_8;
  }
  local_8 = FUN_004016ae(_Dst);
  if (local_8 == 0) {
    _Dst[5] = 0;
    local_8 = FUN_00401b4b(_Dst);
    if (local_8 == 0) {
      FUN_004015b4((int)_Dst);
      _Dst[7] = 0;
      goto LAB_0040155e;
    }
  }
  FUN_00401695(_Dst);
  FUN_00404d98((undefined *)_Dst[9]);
  FUN_00404d98((undefined *)_Dst);
  return local_8;
}



Function: FUN_004015b4
----------------------------------------

void __cdecl FUN_004015b4(int param_1)

{
  *(undefined4 *)(param_1 + 0x40) = 0;
  *(int *)(param_1 + 0x3c) = DAT_00411eb4;
  DAT_00411eb4 = param_1;
  if (*(int *)(param_1 + 0x3c) != 0) {
    *(int *)(*(int *)(param_1 + 0x3c) + 0x40) = param_1;
  }
  return;
}



Function: FUN_004015d5
----------------------------------------

void __cdecl FUN_004015d5(undefined *param_1)

{
  if (*(int *)(param_1 + 0x40) == 0) {
    DAT_00411eb4 = *(undefined4 *)(param_1 + 0x3c);
  }
  else {
    *(undefined4 *)(*(int *)(param_1 + 0x40) + 0x3c) = *(undefined4 *)(param_1 + 0x3c);
  }
  if (*(int *)(param_1 + 0x3c) != 0) {
    *(undefined4 *)(*(int *)(param_1 + 0x3c) + 0x40) = *(undefined4 *)(param_1 + 0x40);
  }
  if (*(undefined **)(param_1 + 0x24) != (undefined *)0x0) {
    FUN_00404d98(*(undefined **)(param_1 + 0x24));
  }
  FUN_00404d98(param_1);
  return;
}



Function: FUN_00401615
----------------------------------------

int __thiscall FUN_00401615(void *this,byte *param_1)

{
  byte *pbVar1;
  uint uVar2;
  int iVar3;
  
  iVar3 = DAT_00411eb4;
  while( true ) {
    if (iVar3 == 0) {
      return 0;
    }
    pbVar1 = *(byte **)(iVar3 + 0x24);
    uVar2 = FUN_0040afa0(this,param_1,*(byte **)(iVar3 + 0x24));
    this = pbVar1;
    if (uVar2 == 0) break;
    iVar3 = *(int *)(iVar3 + 0x3c);
  }
  return iVar3;
}



Function: FUN_0040163b
----------------------------------------

char __cdecl FUN_0040163b(byte *param_1,int *param_2)

{
  DWORD DVar1;
  int iVar2;
  DWORD *pDVar3;
  
  iVar2 = FUN_00403440(param_1);
  *param_2 = iVar2;
  if (iVar2 != 0) {
    return '\0';
  }
  pDVar3 = FUN_00405095();
  DVar1 = *pDVar3;
  if (DVar1 != 2) {
    if ((DVar1 != 0xd) && (DVar1 != 0x1e)) {
      return '\x01';
    }
    iVar2 = FUN_00403440(param_1);
    *param_2 = iVar2;
    return (-(iVar2 != 0) & 0x11U) + 1;
  }
  return '\t';
}



Function: FUN_00401695
----------------------------------------

undefined4 __cdecl FUN_00401695(undefined4 *param_1)

{
  if ((FILE *)*param_1 != (FILE *)0x0) {
    FUN_004050a7((FILE *)*param_1);
  }
  *param_1 = 0;
  return 0;
}



Function: FUN_004016ae
----------------------------------------

undefined4 * __cdecl FUN_004016ae(undefined4 *param_1)

{
  int iVar1;
  undefined4 *puVar2;
  undefined4 uVar3;
  char local_14 [4];
  byte local_10 [2];
  byte local_e [2];
  undefined4 local_c;
  undefined4 local_8;
  
  param_1[6] = 0;
  iVar1 = FUN_00401781((int *)*param_1,0,0x10,local_14);
  if (iVar1 == 0) {
    uVar3 = FUN_0040181f((undefined4 *)local_14);
    param_1[1] = uVar3;
    iVar1 = FUN_0040180c(local_10);
    *(short *)(param_1 + 2) = (short)iVar1;
    iVar1 = FUN_0040180c(local_e);
    *(short *)((int)param_1 + 10) = (short)iVar1;
    uVar3 = FUN_0040181f(&local_c);
    param_1[3] = uVar3;
    uVar3 = FUN_0040181f(&local_8);
    param_1[4] = uVar3;
    if (param_1[1] == 0x76644441) {
      if (*(ushort *)(param_1 + 2) < 2) {
        puVar2 = (undefined4 *)0x0;
        if ((param_1[7] != 0) && (param_1[8] == 0)) {
          iVar1 = FUN_004017d9((int *)*param_1);
          if (param_1[3] != iVar1) {
            param_1[3] = iVar1;
            param_1[6] = 1;
          }
        }
      }
      else {
        param_1 = (undefined4 *)0xd;
        puVar2 = param_1;
      }
    }
    else {
      param_1 = (undefined4 *)0x7;
      puVar2 = param_1;
    }
  }
  else if (iVar1 == 4) {
    puVar2 = (undefined4 *)FUN_00401842(param_1);
  }
  else {
    param_1 = (undefined4 *)0x1;
    puVar2 = param_1;
  }
  param_1 = puVar2;
  return param_1;
}



Function: FUN_00401781
----------------------------------------

int __cdecl FUN_00401781(int *param_1,int param_2,uint param_3,char *param_4)

{
  int iVar1;
  uint uVar2;
  DWORD *pDVar3;
  int iVar4;
  
  iVar4 = 0;
  iVar1 = FUN_0040523b(param_1,param_2,0);
  if (iVar1 == 0) {
    uVar2 = FUN_00405124(param_4,1,param_3,param_1);
    if ((int)uVar2 < 0) {
      pDVar3 = FUN_00405095();
      iVar4 = ((*pDVar3 != 9) - 1 & 0xfffffffd) + 4;
    }
    else if ((int)uVar2 < (int)param_3) {
      iVar4 = 4;
    }
  }
  else {
    iVar4 = 1;
  }
  return iVar4;
}



Function: FUN_004017d9
----------------------------------------

int __cdecl FUN_004017d9(int *param_1)

{
  int iVar1;
  int iVar2;
  
  iVar1 = FUN_004052f4((char *)param_1);
  FUN_0040523b(param_1,0,2);
  iVar2 = FUN_004052f4((char *)param_1);
  FUN_0040523b(param_1,iVar1,0);
  return iVar2;
}



Function: FUN_0040180c
----------------------------------------

int __cdecl FUN_0040180c(byte *param_1)

{
  undefined4 in_EAX;
  
  return CONCAT22((short)((uint)in_EAX >> 0x10),(ushort)param_1[1]) * 0x100 +
         CONCAT22((short)((uint)param_1 >> 0x10),(ushort)*param_1);
}



Function: FUN_0040181f
----------------------------------------

undefined4 __cdecl FUN_0040181f(undefined4 *param_1)

{
  return *param_1;
}



Function: FUN_00401842
----------------------------------------

void __cdecl FUN_00401842(undefined4 *param_1)

{
  int iVar1;
  undefined4 local_28 [2];
  undefined2 local_1e;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  param_1[1] = 0x76644441;
  *(undefined2 *)(param_1 + 2) = 1;
  *(undefined2 *)((int)param_1 + 10) = 2;
  param_1[4] = 0;
  param_1[3] = 0x80;
  local_28[0] = 0;
  local_1c = 0;
  local_14 = 0;
  local_18 = 0;
  local_1e = 1;
  local_10 = 0;
  local_c = 0;
  local_8 = 0;
  iVar1 = FUN_00401a6c(param_1,&DAT_0040f0f4,(int)local_28);
  if (iVar1 == 0) {
    iVar1 = FUN_0040199a(param_1,local_28,param_1 + 4);
    if (iVar1 == 0) {
      FUN_004018be(param_1);
    }
  }
  return;
}



Function: FUN_004018be
----------------------------------------

int __cdecl FUN_004018be(undefined4 *param_1)

{
  bool bVar1;
  undefined3 extraout_var;
  char local_14 [4];
  undefined1 local_10 [2];
  undefined1 local_e [2];
  undefined1 local_c [4];
  undefined1 local_8 [4];
  int iVar2;
  
  if (param_1[8] == 0) {
    FUN_0040196a(param_1[1],local_14);
    FUN_00401987(*(undefined2 *)(param_1 + 2),local_10);
    FUN_00401987(*(undefined2 *)((int)param_1 + 10),local_e);
    FUN_0040196a(param_1[3],local_c);
    FUN_0040196a(param_1[4],local_8);
    bVar1 = FUN_0040192f((int *)*param_1,0,0x10,local_14);
    iVar2 = CONCAT31(extraout_var,bVar1);
    if (iVar2 == 0) {
      param_1[6] = 0;
    }
  }
  else {
    iVar2 = 0x12;
  }
  return iVar2;
}



Function: FUN_0040192f
----------------------------------------

bool __cdecl FUN_0040192f(int *param_1,int param_2,uint param_3,char *param_4)

{
  int iVar1;
  uint uVar2;
  
  iVar1 = FUN_0040523b(param_1,param_2,0);
  if (iVar1 != 0) {
    return true;
  }
  uVar2 = FUN_00405477(param_4,1,param_3,param_1);
  return uVar2 != param_3;
}



Function: FUN_0040196a
----------------------------------------

void __cdecl FUN_0040196a(undefined4 param_1,undefined1 *param_2)

{
  *param_2 = (char)param_1;
  param_2[1] = (char)((uint)param_1 >> 8);
  param_2[2] = (char)((uint)param_1 >> 0x10);
  param_2[3] = (char)((uint)param_1 >> 0x18);
  return;
}



Function: FUN_00401987
----------------------------------------

void __cdecl FUN_00401987(undefined2 param_1,undefined1 *param_2)

{
  *param_2 = (char)param_1;
  param_2[1] = (char)((ushort)param_1 >> 8);
  return;
}



Function: FUN_0040199a
----------------------------------------

int __cdecl FUN_0040199a(undefined4 *param_1,undefined4 *param_2,undefined4 *param_3)

{
  bool bVar1;
  undefined3 extraout_var;
  undefined4 uVar3;
  char local_24 [4];
  undefined1 local_20 [4];
  undefined1 local_1c [2];
  undefined1 local_1a [2];
  undefined1 local_18 [4];
  undefined1 local_14 [4];
  undefined1 local_10 [4];
  undefined1 local_c [4];
  undefined1 local_8 [4];
  int iVar2;
  
  *param_3 = 0;
  if (param_1[8] == 0) {
    uVar3 = param_1[3];
    *param_2 = uVar3;
    FUN_0040196a(uVar3,local_24);
    FUN_0040196a(param_2[1],local_20);
    FUN_00401987(*(undefined2 *)(param_2 + 2),local_1c);
    FUN_00401987(*(undefined2 *)((int)param_2 + 10),local_1a);
    FUN_0040196a(param_2[3],local_18);
    FUN_0040196a(param_2[5],local_10);
    FUN_0040196a(param_2[6],local_c);
    FUN_0040196a(param_2[8],local_8);
    if ((*(byte *)((int)param_2 + 10) & 0x10) == 0) {
      uVar3 = param_2[4];
    }
    else {
      uVar3 = param_2[7];
    }
    FUN_0040196a(uVar3,local_14);
    bVar1 = FUN_0040192f((int *)*param_1,param_1[3],0x20,local_24);
    iVar2 = CONCAT31(extraout_var,bVar1);
    if (iVar2 == 0) {
      *param_3 = param_1[3];
      param_1[3] = param_1[3] + 0x20;
      param_1[6] = 1;
    }
  }
  else {
    iVar2 = 0x12;
  }
  return iVar2;
}



Function: FUN_00401a6c
----------------------------------------

int __cdecl FUN_00401a6c(undefined4 *param_1,byte *param_2,int param_3)

{
  byte bVar1;
  bool bVar2;
  int iVar3;
  size_t sVar4;
  undefined3 extraout_var;
  byte *pbVar5;
  uint uVar6;
  
  iVar3 = FUN_00401af4(param_2);
  if (iVar3 == 0) {
    iVar3 = 0x13;
  }
  else if (param_1[8] == 0) {
    sVar4 = _strlen((char *)param_2);
    uVar6 = sVar4 + 1;
    if (uVar6 == 1) {
      iVar3 = 6;
    }
    else if ((int)uVar6 < 0x201) {
      bVar1 = *param_2;
      pbVar5 = param_2;
      while (bVar1 != 0) {
        if (bVar1 < 0x20) {
          return 0x11;
        }
        pbVar5 = pbVar5 + 1;
        bVar1 = *pbVar5;
      }
      bVar2 = FUN_0040192f((int *)*param_1,param_1[3],uVar6,(char *)param_2);
      iVar3 = CONCAT31(extraout_var,bVar2);
      if (iVar3 == 0) {
        *(short *)(param_3 + 8) = (short)uVar6;
        *(undefined4 *)(param_3 + 4) = param_1[3];
        param_1[3] = param_1[3] + uVar6;
        param_1[6] = 1;
      }
    }
    else {
      iVar3 = 0xc;
    }
  }
  else {
    iVar3 = 0x12;
  }
  return iVar3;
}



Function: FUN_00401af4
----------------------------------------

undefined4 __cdecl FUN_00401af4(byte *param_1)

{
  byte bVar1;
  int iVar2;
  
  iVar2 = 0;
  if (param_1 == (byte *)0x0) {
    return 0;
  }
  bVar1 = *param_1;
  if (bVar1 != 0) {
    do {
      if (iVar2 == 0) {
        if (0x7f < bVar1) {
          if ((bVar1 & 0xc0) == 0x80) {
            return 0;
          }
          if ((bVar1 & 0xe0) == 0xc0) {
            iVar2 = 1;
          }
          else {
            if ((bVar1 & 0xf0) != 0xe0) {
              return 0;
            }
            iVar2 = 2;
          }
        }
      }
      else {
        if ((bVar1 & 0xc0) != 0x80) {
          return 0;
        }
        iVar2 = iVar2 + -1;
      }
      param_1 = param_1 + 1;
      bVar1 = *param_1;
    } while (bVar1 != 0);
    if (iVar2 != 0) {
      return 0;
    }
  }
  return 1;
}



Function: FUN_00401b4b
----------------------------------------

uint __cdecl FUN_00401b4b(undefined4 *param_1)

{
  undefined4 *_Dst;
  undefined4 *puVar1;
  uint uVar2;
  
  puVar1 = param_1;
  _Dst = param_1 + 10;
  _memset(_Dst,0,0x14);
  uVar2 = FUN_00401be8(puVar1,(byte *)puVar1[4],(byte *)s_Users_0040f124,(int *)&param_1,0);
  if (uVar2 == 0) {
    puVar1[0xb] = param_1;
    uVar2 = FUN_00401be8(puVar1,(byte *)puVar1[4],(byte *)s_Common_0040f11c,(int *)&param_1,0);
    if (uVar2 == 0) {
      puVar1[0xc] = param_1;
      uVar2 = FUN_00401be8(puVar1,(byte *)puVar1[4],(byte *)s_Version_Registry_0040f108,
                           (int *)&param_1,0);
      if (uVar2 == 0) {
        *_Dst = param_1;
        uVar2 = FUN_00401be8(puVar1,(byte *)puVar1[4],(byte *)s_Private_Arenas_0040f0f8,
                             (int *)&param_1,0);
        if (uVar2 == 0) {
          puVar1[0xe] = param_1;
          uVar2 = 0;
        }
      }
    }
  }
  return uVar2;
}



Function: FUN_00401be8
----------------------------------------

uint __cdecl FUN_00401be8(undefined4 *param_1,byte *param_2,byte *param_3,int *param_4,int param_5)

{
  int iVar1;
  uint uVar2;
  byte local_228 [512];
  int local_28 [4];
  int local_18;
  
  iVar1 = FUN_00402023((int)param_1,(int)param_2);
  if (iVar1 == 0) {
    return 6;
  }
  uVar2 = FUN_00401cd2(param_1,iVar1,local_28);
  iVar1 = local_28[0];
  if (param_5 == 1) {
    if (uVar2 != 0) {
      return uVar2;
    }
    uVar2 = FUN_00401e27(param_1,local_18,(char *)param_3,local_28,(int *)0x0);
    if (uVar2 == 3) {
      uVar2 = FUN_00401ef7(param_1,iVar1,local_28,param_3);
    }
    if (uVar2 != 0) {
      return uVar2;
    }
  }
  else {
    param_2 = param_3;
    while ((uVar2 == 0 &&
           (uVar2 = FUN_00401dad((char *)param_2,(char *)local_228,0x200,&param_2),
           iVar1 = local_28[0], uVar2 == 0))) {
      uVar2 = FUN_00401e27(param_1,local_18,(char *)local_228,local_28,(int *)0x0);
      if (uVar2 == 3) {
        uVar2 = FUN_00401ef7(param_1,iVar1,local_28,local_228);
      }
    }
    if (param_5 != 0) {
      return uVar2;
    }
    if (uVar2 != 2) {
      return uVar2;
    }
  }
  if (param_4 != (int *)0x0) {
    *param_4 = local_28[0];
  }
  return 0;
}



Function: FUN_00401cd2
----------------------------------------

int __cdecl FUN_00401cd2(undefined4 *param_1,int param_2,int *param_3)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  char local_24 [4];
  undefined4 local_20;
  byte local_1c [2];
  byte local_1a [2];
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  undefined4 local_8;
  
  param_1 = (undefined4 *)FUN_00401781((int *)*param_1,param_2,0x20,local_24);
  if (param_1 == (undefined4 *)0x0) {
    iVar1 = FUN_0040181f((undefined4 *)local_24);
    *param_3 = iVar1;
    iVar2 = FUN_0040181f(&local_20);
    param_3[1] = iVar2;
    iVar2 = FUN_0040180c(local_1c);
    *(short *)(param_3 + 2) = (short)iVar2;
    uVar3 = FUN_0040180c(local_1a);
    *(short *)((int)param_3 + 10) = (short)uVar3;
    iVar2 = FUN_0040181f(&local_18);
    param_3[3] = iVar2;
    iVar2 = FUN_0040181f(&local_10);
    param_3[5] = iVar2;
    iVar2 = FUN_0040181f(&local_c);
    param_3[6] = iVar2;
    iVar2 = FUN_0040181f(&local_8);
    param_3[8] = iVar2;
    if ((uVar3 & 0x10) == 0) {
      iVar2 = FUN_0040181f(&local_14);
      param_3[7] = 0;
      param_3[4] = iVar2;
    }
    else {
      param_3[4] = 0;
      iVar2 = FUN_0040181f(&local_14);
      param_3[7] = iVar2;
    }
    if (iVar1 == param_2) {
      if ((char)uVar3 < '\0') {
        param_1 = (undefined4 *)0xe;
      }
    }
    else {
      param_1 = (undefined4 *)0x5;
    }
  }
  return (int)param_1;
}



Function: FUN_00401dad
----------------------------------------

undefined4 __cdecl FUN_00401dad(char *param_1,char *param_2,int param_3,undefined4 *param_4)

{
  int iVar1;
  char cVar2;
  undefined4 uStack_14;
  undefined4 local_8;
  
  iVar1 = 0;
  local_8 = 0;
  *param_4 = 0;
  *param_2 = '\0';
  if ((param_1 == (char *)0x0) || (cVar2 = *param_1, cVar2 == '\0')) {
LAB_00401e20:
    uStack_14 = 2;
  }
  else {
    if (cVar2 == '/') {
      param_1 = param_1 + 1;
      cVar2 = *param_1;
      if (cVar2 == '\0') goto LAB_00401e20;
      if (cVar2 != '/') goto LAB_00401de0;
    }
    else {
LAB_00401de0:
      if (cVar2 != ' ') {
        do {
          if (cVar2 == '/') break;
          if (iVar1 == param_3) {
            local_8 = 0xc;
            break;
          }
          if ((cVar2 < ' ') && ('\0' < cVar2)) goto LAB_00401e1c;
          *param_2 = cVar2;
          param_2 = param_2 + 1;
          param_1 = param_1 + 1;
          iVar1 = iVar1 + 1;
          cVar2 = *param_1;
        } while (cVar2 != '\0');
        *param_2 = '\0';
        if (param_2[-1] != ' ') {
          *param_4 = param_1;
          return local_8;
        }
      }
    }
LAB_00401e1c:
    uStack_14 = 0x11;
  }
  return uStack_14;
}



Function: FUN_00401e27
----------------------------------------

int __cdecl
FUN_00401e27(undefined4 *param_1,int param_2,char *param_3,undefined4 *param_4,int *param_5)

{
  int iVar1;
  int iVar2;
  int iVar3;
  char local_228 [512];
  int local_28 [3];
  int local_1c;
  
  iVar2 = 0;
  do {
    iVar3 = iVar2;
    iVar2 = param_2;
    if (iVar2 == 0) break;
    iVar1 = FUN_00401cd2(param_1,iVar2,local_28);
    if (iVar1 != 0) {
      return iVar1;
    }
    iVar1 = FUN_00401ec1(param_1,(int)local_28,0x200,local_228);
    if (iVar1 != 0) {
      return iVar1;
    }
    iVar1 = _strcmp(local_228,param_3);
    param_2 = local_1c;
  } while (iVar1 != 0);
  if ((param_4 != (undefined4 *)0x0) && ((iVar3 != 0 || (iVar2 != 0)))) {
    FUN_004055b0(param_4,local_28,0x24);
  }
  if (param_5 != (int *)0x0) {
    *param_5 = iVar3;
  }
  return (-(uint)(iVar2 != 0) & 0xfffffffd) + 3;
}



Function: FUN_00401ec1
----------------------------------------

int __cdecl FUN_00401ec1(undefined4 *param_1,int param_2,uint param_3,char *param_4)

{
  int iVar1;
  
  if (param_3 < *(ushort *)(param_2 + 8)) {
    return 0xb;
  }
  iVar1 = FUN_00401781((int *)*param_1,*(int *)(param_2 + 4),(uint)*(ushort *)(param_2 + 8),param_4)
  ;
  param_4[param_3 - 1] = '\0';
  return iVar1;
}



Function: FUN_00401ef7
----------------------------------------

uint __cdecl FUN_00401ef7(undefined4 *param_1,int param_2,int *param_3,byte *param_4)

{
  undefined1 uVar1;
  uint uVar2;
  int *piVar3;
  undefined3 extraout_var;
  undefined4 local_28 [2];
  undefined2 local_1e;
  undefined4 local_1c;
  undefined4 local_18;
  undefined4 local_14;
  undefined4 local_10;
  undefined4 local_c;
  int local_8;
  
  uVar2 = FUN_00401a6c(param_1,param_4,(int)local_28);
  if (uVar2 == 0) {
    local_8 = param_2;
    local_1e = 1;
    local_1c = 0;
    local_18 = 0;
    local_14 = 0;
    local_10 = 0;
    local_c = 0;
    piVar3 = param_3 + 4;
    if (param_2 != *param_3) {
      piVar3 = param_3 + 3;
    }
    uVar2 = FUN_0040199a(param_1,local_28,piVar3);
    if (uVar2 == 0) {
      uVar1 = FUN_00401f72(param_1,param_3);
      uVar2 = CONCAT31(extraout_var,uVar1);
      FUN_004055b0(param_3,local_28,0x24);
    }
  }
  return uVar2;
}



Function: FUN_00401f72
----------------------------------------

undefined1 __cdecl FUN_00401f72(undefined4 *param_1,int *param_2)

{
  undefined1 uVar1;
  int iVar2;
  char local_24 [4];
  undefined1 local_20 [4];
  undefined1 local_1c [2];
  undefined1 local_1a [2];
  undefined1 local_18 [4];
  undefined1 local_14 [4];
  undefined1 local_10 [4];
  undefined1 local_c [4];
  undefined1 local_8 [4];
  
  if (param_1[8] == 0) {
    FUN_0040196a(*param_2,local_24);
    FUN_0040196a(param_2[1],local_20);
    FUN_00401987((short)param_2[2],local_1c);
    FUN_00401987(*(undefined2 *)((int)param_2 + 10),local_1a);
    FUN_0040196a(param_2[3],local_18);
    FUN_0040196a(param_2[5],local_10);
    FUN_0040196a(param_2[6],local_c);
    FUN_0040196a(param_2[8],local_8);
    if ((*(byte *)((int)param_2 + 10) & 0x10) == 0) {
      iVar2 = param_2[4];
    }
    else {
      iVar2 = param_2[7];
    }
    FUN_0040196a(iVar2,local_14);
    uVar1 = FUN_0040192f((int *)*param_1,*param_2,0x20,local_24);
  }
  else {
    uVar1 = 0x12;
  }
  return uVar1;
}



Function: FUN_00402023
----------------------------------------

int __cdecl FUN_00402023(int param_1,int param_2)

{
  if (param_2 < 0x80) {
    if (param_2 != 1) {
      if (param_2 == 2) {
        return *(int *)(param_1 + 0x30);
      }
      if (param_2 == 4) {
        return *(int *)(param_1 + 0x38);
      }
      if (param_2 == 0x20) {
        return *(int *)(param_1 + 0x10);
      }
      if (param_2 != 0x21) {
        return 0;
      }
      return *(int *)(param_1 + 0x28);
    }
    param_2 = *(int *)(param_1 + 0x2c);
  }
  return param_2;
}



Function: FUN_0040206e
----------------------------------------

char * __cdecl FUN_0040206e(char *param_1)

{
  if ((param_1 == (char *)0x0) || (*param_1 == '\0')) {
    param_1 = DAT_00411ebc;
  }
  return param_1;
}



Function: NR_RegClose
----------------------------------------

byte __cdecl NR_RegClose(int *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  byte bVar3;
  
                    /* 0x2081  3  NR_RegClose */
  if (param_1 == (int *)0x0) {
    bVar3 = 6;
  }
  else {
    bVar3 = -(*param_1 != 0x76644441) & 7;
    if (bVar3 == 0) {
      puVar1 = (undefined4 *)param_1[1];
      if (puVar1[6] != 0) {
        FUN_004018be(puVar1);
      }
      puVar1[5] = puVar1[5] + -1;
      iVar2 = puVar1[5];
      if (0 < iVar2) {
        FUN_00405974((int *)*puVar1);
      }
      else {
        FUN_00401695(puVar1);
      }
      *param_1 = 0;
      if (0 >= iVar2) {
        FUN_004015d5((undefined *)puVar1);
      }
      FUN_00404d98((undefined *)param_1);
      bVar3 = 0;
    }
  }
  return bVar3;
}



Function: FUN_00402086
----------------------------------------

byte __cdecl FUN_00402086(int *param_1)

{
  undefined4 *puVar1;
  int iVar2;
  byte bVar3;
  
  if (param_1 == (int *)0x0) {
    bVar3 = 6;
  }
  else {
    bVar3 = -(*param_1 != 0x76644441) & 7;
    if (bVar3 == 0) {
      puVar1 = (undefined4 *)param_1[1];
      if (puVar1[6] != 0) {
        FUN_004018be(puVar1);
      }
      puVar1[5] = puVar1[5] + -1;
      iVar2 = puVar1[5];
      if (0 < iVar2) {
        FUN_00405974((int *)*puVar1);
      }
      else {
        FUN_00401695(puVar1);
      }
      *param_1 = 0;
      if (0 >= iVar2) {
        FUN_004015d5((undefined *)puVar1);
      }
      FUN_00404d98((undefined *)param_1);
      bVar3 = 0;
    }
  }
  return bVar3;
}



Function: NR_RegFlush
----------------------------------------

uint __cdecl NR_RegFlush(int *param_1)

{
  undefined4 *puVar1;
  uint uVar2;
  
                    /* 0x20f1  9  NR_RegFlush */
  if (param_1 == (int *)0x0) {
    return 6;
  }
  uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
  if (uVar2 == 0) {
    puVar1 = (undefined4 *)param_1[1];
    if (puVar1[8] != 0) {
      return 0x12;
    }
    uVar2 = FUN_0040214a();
    if (uVar2 == 0) {
      if (puVar1[6] != 0) {
        FUN_004018be(puVar1);
      }
      FUN_00405974((int *)*puVar1);
      FUN_00402160();
    }
  }
  return uVar2;
}



Function: FUN_0040214a
----------------------------------------

void FUN_0040214a(void)

{
  FUN_0040215d();
  return;
}



Function: FUN_0040215d
----------------------------------------

undefined4 FUN_0040215d(void)

{
  return 0;
}



Function: FUN_00402160
----------------------------------------

void FUN_00402160(void)

{
  FUN_0040215d();
  return;
}



Function: NR_RegIsWritable
----------------------------------------

byte __cdecl NR_RegIsWritable(int *param_1)

{
  byte bVar1;
  
                    /* 0x2173  16  NR_RegIsWritable */
  if (param_1 == (int *)0x0) {
    return 6;
  }
  bVar1 = -(*param_1 != 0x76644441) & 7;
  if (bVar1 == 0) {
    bVar1 = -(*(int *)(param_1[1] + 0x20) != 0) & 0x12;
  }
  return bVar1;
}



Function: NR_RegAddKey
----------------------------------------

uint __cdecl NR_RegAddKey(int *param_1,int param_2,byte *param_3,int *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  byte *pbVar3;
  
                    /* 0x219d  1  NR_RegAddKey */
  if (param_4 != (int *)0x0) {
    *param_4 = 0;
  }
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    puVar1 = (undefined4 *)param_1[1];
    if (((param_3 != (byte *)0x0) && (*param_3 != 0)) && (puVar1 != (undefined4 *)0x0)) {
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      pbVar3 = (byte *)FUN_00402023((int)puVar1,param_2);
      if ((pbVar3 == (byte *)0x0) || (pbVar3 == (byte *)puVar1[4])) {
        uVar2 = 6;
      }
      else {
        uVar2 = FUN_00401be8(puVar1,pbVar3,param_3,param_4,0);
      }
      FUN_00402160();
      return uVar2;
    }
  }
  return 6;
}



Function: NR_RegAddKeyRaw
----------------------------------------

uint __cdecl NR_RegAddKeyRaw(int *param_1,int param_2,byte *param_3,int *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  byte *pbVar3;
  
                    /* 0x2222  2  NR_RegAddKeyRaw */
  if (param_4 != (int *)0x0) {
    *param_4 = 0;
  }
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    puVar1 = (undefined4 *)param_1[1];
    if (((param_3 != (byte *)0x0) && (*param_3 != 0)) && (puVar1 != (undefined4 *)0x0)) {
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      pbVar3 = (byte *)FUN_00402023((int)puVar1,param_2);
      if ((pbVar3 == (byte *)0x0) || (pbVar3 == (byte *)puVar1[4])) {
        uVar2 = 6;
      }
      else {
        uVar2 = FUN_00401be8(puVar1,pbVar3,param_3,param_4,1);
      }
      FUN_00402160();
      return uVar2;
    }
  }
  return 6;
}



Function: NR_RegDeleteKey
----------------------------------------

uint __cdecl NR_RegDeleteKey(int *param_1,int param_2,char *param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  
                    /* 0x22a8  5  NR_RegDeleteKey */
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 == 0) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 == 0) {
        uVar2 = FUN_004022f5(puVar1,param_2,param_3,0);
        FUN_00402160();
      }
    }
    return uVar2;
  }
  return 6;
}



Function: FUN_004022f5
----------------------------------------

uint __cdecl FUN_004022f5(undefined4 *param_1,int param_2,char *param_3,int param_4)

{
  undefined4 *puVar1;
  undefined1 uVar2;
  int iVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  undefined4 *puVar5;
  int local_4c [3];
  undefined4 local_40;
  undefined4 local_3c [5];
  int local_28 [2];
  byte local_1e;
  undefined4 local_1c;
  int local_18;
  
  puVar1 = param_1;
  iVar3 = FUN_00402023((int)param_1,param_2);
  if (((param_3 == (char *)0x0) || (*param_3 == '\0')) || (iVar3 == 0)) {
    uVar4 = 6;
  }
  else {
    uVar4 = FUN_004023b6(puVar1,iVar3,param_3,local_28,&param_2,(int *)&param_1,param_4);
    if (uVar4 == 0) {
      if ((local_18 == 0) && (iVar3 = FUN_004024ab((int)puVar1,local_28[0]), iVar3 == 0)) {
        if (param_2 == 0) {
          uVar4 = FUN_00401cd2(puVar1,(int)param_1,local_4c);
          puVar5 = local_3c;
        }
        else {
          uVar4 = FUN_00401cd2(puVar1,param_2,local_4c);
          puVar5 = &local_40;
        }
        if (uVar4 != 0) {
          return uVar4;
        }
        *puVar5 = local_1c;
        uVar2 = FUN_00401f72(puVar1,local_4c);
        if (CONCAT31(extraout_var,uVar2) != 0) {
          return CONCAT31(extraout_var,uVar2);
        }
        local_1e = local_1e | 0x80;
        uVar2 = FUN_00401f72(puVar1,local_28);
        return CONCAT31(extraout_var_00,uVar2);
      }
      uVar4 = 1;
    }
  }
  return uVar4;
}



Function: FUN_004023b6
----------------------------------------

int __cdecl
FUN_004023b6(undefined4 *param_1,int param_2,char *param_3,undefined4 *param_4,int *param_5,
            int *param_6,int param_7)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  char local_22c [512];
  int local_2c [4];
  int local_1c;
  int local_8;
  
  piVar1 = param_5;
  local_8 = 0;
  if (param_5 != (int *)0x0) {
    *param_5 = 0;
  }
  if (param_6 != (int *)0x0) {
    *param_6 = 0;
  }
  iVar3 = FUN_00401cd2(param_1,param_2,local_2c);
  if (param_7 == 1) {
    if (iVar3 != 0) {
      return iVar3;
    }
    iVar3 = FUN_00401e27(param_1,local_1c,param_3,local_2c,&local_8);
    param_2 = local_2c[0];
    if (iVar3 != 0) {
      return iVar3;
    }
  }
  else {
    while ((iVar3 == 0 &&
           (iVar3 = FUN_00401dad(param_3,local_22c,0x200,&param_3), iVar2 = local_2c[0], iVar3 == 0)
           )) {
      iVar3 = FUN_00401e27(param_1,local_1c,local_22c,local_2c,&local_8);
      param_2 = iVar2;
    }
    if (param_7 != 0) {
      return iVar3;
    }
    if (iVar3 != 2) {
      return iVar3;
    }
  }
  if (param_4 != (undefined4 *)0x0) {
    FUN_004055b0(param_4,local_2c,0x24);
  }
  if (piVar1 != (int *)0x0) {
    *piVar1 = local_8;
  }
  if (param_6 != (int *)0x0) {
    *param_6 = param_2;
  }
  return 0;
}



Function: FUN_004024ab
----------------------------------------

undefined4 __cdecl FUN_004024ab(int param_1,int param_2)

{
  if ((((param_2 != *(int *)(param_1 + 0x10)) && (param_2 != *(int *)(param_1 + 0x2c))) &&
      (param_2 != *(int *)(param_1 + 0x28))) &&
     ((param_2 != *(int *)(param_1 + 0x30) && (param_2 != *(int *)(param_1 + 0x34))))) {
    return 0;
  }
  return 1;
}



Function: NR_RegDeleteKeyRaw
----------------------------------------

uint __cdecl NR_RegDeleteKeyRaw(int *param_1,int param_2,char *param_3)

{
  undefined4 *puVar1;
  uint uVar2;
  
                    /* 0x24d3  6  NR_RegDeleteKeyRaw */
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 == 0) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 == 0) {
        uVar2 = FUN_004022f5(puVar1,param_2,param_3,1);
        FUN_00402160();
      }
    }
    return uVar2;
  }
  return 6;
}



Function: NR_RegGetKey
----------------------------------------

uint __cdecl NR_RegGetKey(int *param_1,int param_2,char *param_3,undefined4 *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  undefined4 local_28 [9];
  
                    /* 0x2521  13  NR_RegGetKey */
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = 0;
  }
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    if ((param_3 != (char *)0x0) && (param_4 != (undefined4 *)0x0)) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      iVar3 = FUN_00402023((int)puVar1,param_2);
      if (iVar3 == 0) {
        uVar2 = 6;
      }
      else {
        uVar2 = FUN_004023b6(puVar1,iVar3,param_3,local_28,(int *)0x0,(int *)0x0,0);
        if (uVar2 == 0) {
          *param_4 = local_28[0];
        }
      }
      FUN_00402160();
      return uVar2;
    }
  }
  return 6;
}



Function: NR_RegGetKeyRaw
----------------------------------------

uint __cdecl NR_RegGetKeyRaw(int *param_1,int param_2,char *param_3,undefined4 *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  undefined4 local_28 [9];
  
                    /* 0x25af  14  NR_RegGetKeyRaw */
  if (param_4 != (undefined4 *)0x0) {
    *param_4 = 0;
  }
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    if ((param_3 != (char *)0x0) && (param_4 != (undefined4 *)0x0)) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 == 0) {
        iVar3 = FUN_00402023((int)puVar1,param_2);
        if (iVar3 == 0) {
          uVar2 = 6;
        }
        else {
          uVar2 = FUN_004023b6(puVar1,iVar3,param_3,local_28,(int *)0x0,(int *)0x0,1);
          if (uVar2 == 0) {
            *param_4 = local_28[0];
          }
        }
        FUN_00402160();
      }
      return uVar2;
    }
  }
  return 6;
}



Function: NR_RegGetEntryInfo
----------------------------------------

uint __cdecl NR_RegGetEntryInfo(int *param_1,int param_2,char *param_3,short *param_4)

{
  undefined4 *puVar1;
  uint uVar2;
  int local_28 [2];
  short local_1e;
  int local_14;
  undefined4 local_10;
  
                    /* 0x263c  11  NR_RegGetEntryInfo */
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    if ((((param_3 != (char *)0x0) && (*param_3 != '\0')) && (param_4 != (short *)0x0)) &&
       (param_2 != 0)) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      uVar2 = FUN_00401cd2(puVar1,param_2,local_28);
      if ((uVar2 == 0) &&
         (uVar2 = FUN_00401e27(puVar1,local_14,param_3,local_28,(int *)0x0), uVar2 == 0)) {
        if (*param_4 == 8) {
          param_4[1] = local_1e;
          *(undefined4 *)(param_4 + 2) = local_10;
        }
        else {
          uVar2 = 6;
        }
      }
      FUN_00402160();
      return uVar2;
    }
  }
  return 6;
}



Function: NR_RegGetEntryString
----------------------------------------

uint __cdecl NR_RegGetEntryString(int *param_1,int param_2,char *param_3,char *param_4,uint param_5)

{
  undefined4 *puVar1;
  uint uVar2;
  int local_28 [2];
  short local_1e;
  int local_14;
  
                    /* 0x26e9  12  NR_RegGetEntryString */
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    if ((((param_3 != (char *)0x0) && (*param_3 != '\0')) && (param_4 != (char *)0x0)) &&
       ((param_5 != 0 && (param_2 != 0)))) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      uVar2 = FUN_00401cd2(puVar1,param_2,local_28);
      if ((uVar2 == 0) &&
         (uVar2 = FUN_00401e27(puVar1,local_14,param_3,local_28,(int *)0x0), uVar2 == 0)) {
        if (local_1e == 0x11) {
          uVar2 = FUN_004027b7(puVar1,(int)local_28,param_5,param_4);
          param_4[param_5 - 1] = '\0';
        }
        else {
          uVar2 = 0xf;
        }
      }
      FUN_00402160();
      return uVar2;
    }
  }
  return 6;
}



Function: FUN_004027b7
----------------------------------------

int __cdecl FUN_004027b7(undefined4 *param_1,int param_2,uint param_3,char *param_4)

{
  int iVar1;
  
  if (param_3 < *(uint *)(param_2 + 0x18)) {
    return 0xb;
  }
  iVar1 = FUN_00401781((int *)*param_1,*(int *)(param_2 + 0x14),*(uint *)(param_2 + 0x18),param_4);
  return iVar1;
}



Function: NR_RegGetEntry
----------------------------------------

uint __cdecl NR_RegGetEntry(int *param_1,char *param_2,char *param_3,char *param_4,uint *param_5)

{
  undefined4 *puVar1;
  uint uVar2;
  undefined4 uVar3;
  int iVar4;
  int local_30 [2];
  short local_26;
  int local_1c;
  uint local_18;
  int local_c;
  char *local_8;
  
                    /* 0x27df  10  NR_RegGetEntry */
  local_8 = (char *)0x0;
  local_c = 0;
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    if ((((param_3 != (char *)0x0) && (*param_3 != '\0')) && (param_4 != (char *)0x0)) &&
       ((param_5 != (uint *)0x0 && (param_2 != (char *)0x0)))) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      uVar2 = FUN_00401cd2(puVar1,(int)param_2,local_30);
      if ((uVar2 == 0) &&
         (uVar2 = FUN_00401e27(puVar1,local_1c,param_3,local_30,(int *)0x0), uVar2 == 0)) {
        uVar2 = *param_5;
        if (uVar2 < local_18) {
          uVar2 = 0xb;
        }
        else if (local_18 == 0) {
          uVar2 = 1;
        }
        else if (local_26 == 0x11) {
          local_8 = param_4;
          uVar2 = FUN_004027b7(puVar1,(int)local_30,uVar2,param_4);
          param_4[*param_5 - 1] = '\0';
        }
        else if (local_26 == 0x12) {
          local_8 = (char *)_malloc(local_18);
          if (local_8 == (char *)0x0) {
            uVar2 = 10;
          }
          else {
            local_c = 1;
            uVar2 = FUN_004027b7(puVar1,(int)local_30,local_18,local_8);
            if (uVar2 == 0) {
              param_3 = (char *)(local_18 >> 2);
              param_2 = local_8;
              if (param_3 != (char *)0x0) {
                iVar4 = (int)param_4 - (int)local_8;
                do {
                  uVar3 = FUN_0040181f((undefined4 *)param_2);
                  param_3 = param_3 + -1;
                  *(undefined4 *)(param_2 + iVar4) = uVar3;
                  param_2 = param_2 + 4;
                } while (param_3 != (char *)0x0);
              }
            }
          }
        }
        else {
          uVar2 = FUN_004027b7(puVar1,(int)local_30,uVar2,param_4);
        }
        *param_5 = local_18;
      }
      FUN_00402160();
      if (local_c == 0) {
        return uVar2;
      }
      FUN_00404d98(local_8);
      return uVar2;
    }
  }
  return 6;
}



Function: NR_RegSetEntryString
----------------------------------------

uint __cdecl NR_RegSetEntryString(int *param_1,int param_2,byte *param_3,byte *param_4)

{
  undefined4 *puVar1;
  undefined1 uVar2;
  uint uVar3;
  undefined3 extraout_var;
  int local_4c [5];
  int local_38;
  int local_28 [2];
  undefined2 local_1e;
  
                    /* 0x2979  20  NR_RegSetEntryString */
  if (param_1 != (int *)0x0) {
    uVar3 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar3 != 0) {
      return uVar3;
    }
    if ((((param_3 != (byte *)0x0) && (*param_3 != 0)) && (param_4 != (byte *)0x0)) &&
       (param_2 != 0)) {
      puVar1 = (undefined4 *)param_1[1];
      uVar3 = FUN_0040214a();
      if (uVar3 != 0) {
        return uVar3;
      }
      uVar3 = FUN_00401cd2(puVar1,param_2,local_4c);
      if (uVar3 == 0) {
        uVar3 = FUN_00401e27(puVar1,local_38,(char *)param_3,local_28,(int *)0x0);
        if (uVar3 == 0) {
          uVar3 = FUN_00402a5e(puVar1,param_4,(int)local_28);
          if (uVar3 == 0) {
            local_1e = 0x11;
            uVar2 = FUN_00401f72(puVar1,local_28);
            uVar3 = CONCAT31(extraout_var,uVar2);
          }
        }
        else if (uVar3 == 3) {
          uVar3 = FUN_00402b57(puVar1,local_4c,param_3,param_4);
        }
      }
      FUN_00402160();
      return uVar3;
    }
  }
  return 6;
}



Function: FUN_00402a5e
----------------------------------------

int __cdecl FUN_00402a5e(undefined4 *param_1,byte *param_2,int param_3)

{
  int iVar1;
  size_t sVar2;
  
  iVar1 = FUN_00401af4(param_2);
  if (iVar1 == 0) {
    iVar1 = 0x13;
  }
  else if (param_1[8] == 0) {
    sVar2 = _strlen((char *)param_2);
    iVar1 = FUN_00402a9d(param_1,(char *)param_2,sVar2 + 1,param_3);
  }
  else {
    iVar1 = 0x12;
  }
  return iVar1;
}



Function: FUN_00402a9d
----------------------------------------

int __cdecl FUN_00402a9d(undefined4 *param_1,char *param_2,uint param_3,int param_4)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  
  if (param_1[8] == 0) {
    if (param_3 == 0) {
      iVar2 = 6;
    }
    else if (param_3 < 0x8000) {
      if (*(uint *)(param_4 + 0x1c) < param_3) {
        iVar2 = FUN_00402afb(param_1,param_2,param_3,param_4);
      }
      else {
        bVar1 = FUN_0040192f((int *)*param_1,*(int *)(param_4 + 0x14),param_3,param_2);
        iVar2 = CONCAT31(extraout_var,bVar1);
        if (iVar2 == 0) {
          *(uint *)(param_4 + 0x18) = param_3;
        }
      }
    }
    else {
      iVar2 = 0xc;
    }
  }
  else {
    iVar2 = 0x12;
  }
  return iVar2;
}



Function: FUN_00402afb
----------------------------------------

int __cdecl FUN_00402afb(undefined4 *param_1,char *param_2,uint param_3,int param_4)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  
  if (param_1[8] == 0) {
    if (param_3 == 0) {
      iVar2 = 6;
    }
    else if (param_3 < 0x8000) {
      bVar1 = FUN_0040192f((int *)*param_1,param_1[3],param_3,param_2);
      iVar2 = CONCAT31(extraout_var,bVar1);
      if (iVar2 == 0) {
        *(undefined4 *)(param_4 + 0x14) = param_1[3];
        *(uint *)(param_4 + 0x18) = param_3;
        *(uint *)(param_4 + 0x1c) = param_3;
        param_1[3] = param_1[3] + param_3;
        param_1[6] = 1;
      }
    }
    else {
      iVar2 = 0xc;
    }
  }
  else {
    iVar2 = 0x12;
  }
  return iVar2;
}



Function: FUN_00402b57
----------------------------------------

void __cdecl FUN_00402b57(undefined4 *param_1,int *param_2,byte *param_3,byte *param_4)

{
  int iVar1;
  undefined4 local_28 [2];
  undefined2 local_1e;
  int local_1c;
  undefined4 local_18;
  int local_8;
  
  _memset(local_28,0,0x24);
  iVar1 = FUN_00401a6c(param_1,param_3,(int)local_28);
  if (iVar1 == 0) {
    iVar1 = FUN_00402bd0(param_1,param_4,(int)local_28);
    if (iVar1 == 0) {
      local_18 = 0;
      local_1e = 0x11;
      local_1c = param_2[5];
      local_8 = *param_2;
      iVar1 = FUN_0040199a(param_1,local_28,param_2 + 5);
      if (iVar1 == 0) {
        FUN_00401f72(param_1,param_2);
      }
    }
  }
  return;
}



Function: FUN_00402bd0
----------------------------------------

int __cdecl FUN_00402bd0(undefined4 *param_1,byte *param_2,int param_3)

{
  int iVar1;
  size_t sVar2;
  
  iVar1 = FUN_00401af4(param_2);
  if (iVar1 == 0) {
    iVar1 = 0x13;
  }
  else if (param_1[8] == 0) {
    sVar2 = _strlen((char *)param_2);
    iVar1 = FUN_00402afb(param_1,(char *)param_2,sVar2 + 1,param_3);
  }
  else {
    iVar1 = 0x12;
  }
  return iVar1;
}



Function: NR_RegSetEntry
----------------------------------------

uint __cdecl
NR_RegSetEntry(int *param_1,int param_2,byte *param_3,short param_4,char *param_5,uint param_6)

{
  undefined4 *puVar1;
  undefined1 uVar2;
  uint uVar3;
  char *pcVar4;
  undefined3 extraout_var;
  int iVar5;
  int extraout_EDX;
  char *pcVar6;
  int local_50 [5];
  int local_3c;
  int local_2c [2];
  short local_22;
  int local_8;
  
                    /* 0x2c0f  19  NR_RegSetEntry */
  local_8 = 0;
  if (param_1 != (int *)0x0) {
    uVar3 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar3 != 0) {
      return uVar3;
    }
    if ((((param_3 != (byte *)0x0) && (*param_3 != 0)) && (param_5 != (char *)0x0)) &&
       ((param_6 != 0 && (param_2 != 0)))) {
      puVar1 = (undefined4 *)param_1[1];
      pcVar4 = param_5;
      if (param_4 == 0x11) {
        if (param_5[param_6 - 1] != '\0') {
          return 6;
        }
      }
      else if (param_4 == 0x12) {
        if ((param_6 & 3) != 0) {
          return 6;
        }
        pcVar4 = (char *)_malloc(param_6);
        if (pcVar4 == (char *)0x0) {
          return 10;
        }
        local_8 = 1;
        if ((char *)(param_6 >> 2) != (char *)0x0) {
          iVar5 = (int)param_5 - (int)pcVar4;
          pcVar6 = pcVar4;
          param_5 = (char *)(param_6 >> 2);
          do {
            FUN_0040196a(*(undefined4 *)(pcVar6 + iVar5),pcVar6);
            pcVar6 = pcVar6 + 4;
            param_5 = param_5 + -1;
            iVar5 = extraout_EDX;
          } while (param_5 != (char *)0x0);
        }
      }
      else if ((param_4 != 0x13) && (param_4 != 0x14)) {
        return 0xf;
      }
      uVar3 = FUN_0040214a();
      if (uVar3 == 0) {
        uVar3 = FUN_00401cd2(puVar1,param_2,local_50);
        if (uVar3 == 0) {
          uVar3 = FUN_00401e27(puVar1,local_3c,(char *)param_3,local_2c,(int *)0x0);
          if (uVar3 == 0) {
            uVar3 = FUN_00402a9d(puVar1,pcVar4,param_6,(int)local_2c);
            if (uVar3 == 0) {
              local_22 = param_4;
              uVar2 = FUN_00401f72(puVar1,local_2c);
              uVar3 = CONCAT31(extraout_var,uVar2);
            }
          }
          else if (uVar3 == 3) {
            uVar3 = FUN_00402d8d(puVar1,local_50,param_3,param_4,pcVar4,param_6);
          }
        }
        FUN_00402160();
      }
      if (local_8 != 0) {
        FUN_00404d98(pcVar4);
        return uVar3;
      }
      return uVar3;
    }
  }
  return 6;
}



Function: FUN_00402d8d
----------------------------------------

void __cdecl
FUN_00402d8d(undefined4 *param_1,int *param_2,byte *param_3,undefined2 param_4,char *param_5,
            uint param_6)

{
  int iVar1;
  undefined4 local_28 [2];
  undefined2 local_1e;
  int local_1c;
  undefined4 local_18;
  int local_8;
  
  _memset(local_28,0,0x24);
  iVar1 = FUN_00401a6c(param_1,param_3,(int)local_28);
  if (iVar1 == 0) {
    iVar1 = FUN_00402afb(param_1,param_5,param_6,(int)local_28);
    if (iVar1 == 0) {
      local_1e = param_4;
      local_18 = 0;
      local_1c = param_2[5];
      local_8 = *param_2;
      iVar1 = FUN_0040199a(param_1,local_28,param_2 + 5);
      if (iVar1 == 0) {
        FUN_00401f72(param_1,param_2);
      }
    }
  }
  return;
}



Function: NR_RegDeleteEntry
----------------------------------------

uint __cdecl NR_RegDeleteEntry(int *param_1,int param_2,char *param_3)

{
  undefined4 *puVar1;
  char *pcVar2;
  undefined1 uVar3;
  uint uVar4;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  int local_4c [2];
  byte local_42;
  int local_40;
  int local_28 [3];
  int local_1c;
  int local_14;
  
                    /* 0x2e0b  4  NR_RegDeleteEntry */
  pcVar2 = param_3;
  if (param_1 != (int *)0x0) {
    uVar4 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar4 != 0) {
      return uVar4;
    }
    if (((param_3 != (char *)0x0) && (*param_3 != '\0')) && (param_2 != 0)) {
      puVar1 = (undefined4 *)param_1[1];
      uVar4 = FUN_0040214a();
      if (uVar4 != 0) {
        return uVar4;
      }
      uVar4 = FUN_00401cd2(puVar1,param_2,local_28);
      if ((uVar4 == 0) &&
         (uVar4 = FUN_00401e27(puVar1,local_14,pcVar2,local_4c,&param_2), uVar4 == 0)) {
        if (param_2 == 0) {
          local_14 = local_40;
        }
        else {
          uVar4 = FUN_00401cd2(puVar1,param_2,local_28);
          local_1c = local_40;
          if (uVar4 != 0) goto LAB_00402ee1;
        }
        uVar3 = FUN_00401f72(puVar1,local_28);
        uVar4 = CONCAT31(extraout_var,uVar3);
        if (uVar4 == 0) {
          local_42 = local_42 | 0x80;
          uVar3 = FUN_00401f72(puVar1,local_4c);
          uVar4 = CONCAT31(extraout_var_00,uVar3);
        }
      }
LAB_00402ee1:
      FUN_00402160();
      return uVar4;
    }
  }
  return 6;
}



Function: NR_RegEnumSubkeys
----------------------------------------

uint __cdecl
NR_RegEnumSubkeys(int *param_1,int param_2,int *param_3,byte *param_4,uint param_5,int param_6)

{
  undefined4 *puVar1;
  int iVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  int iVar6;
  int local_28 [3];
  int local_1c;
  int local_18;
  int local_8;
  
                    /* 0x2ef4  8  NR_RegEnumSubkeys */
  uVar5 = 0;
  if (param_1 == (int *)0x0) {
    return 6;
  }
  uVar3 = -(uint)(*param_1 != 0x76644441) & 7;
  if (uVar3 != 0) {
    return uVar3;
  }
  if (param_2 == 0) {
    return 6;
  }
  if (param_3 == (int *)0x0) {
    return 6;
  }
  if (param_4 == (byte *)0x0) {
    return 6;
  }
  puVar1 = (undefined4 *)param_1[1];
  uVar3 = FUN_0040214a();
  if (uVar3 != 0) {
    return uVar3;
  }
  local_18 = 0;
  local_28[0] = 0;
  iVar4 = FUN_00402023((int)puVar1,param_2);
  if (iVar4 == 0) {
LAB_00402fad:
    uVar5 = 6;
    goto LAB_00403194;
  }
  if (*param_3 == 0) {
    uVar5 = FUN_00401cd2(puVar1,iVar4,local_28);
  }
  if (uVar5 != 0) goto LAB_00403194;
  iVar2 = *param_3;
  if ((iVar2 == 0) && (local_18 == 0)) {
    uVar5 = 2;
    goto LAB_00403194;
  }
  iVar6 = local_18;
  if (param_6 == 0) {
    *param_4 = 0;
    if (*param_3 == 0) {
LAB_004030f5:
      uVar5 = FUN_0040321c(puVar1,iVar6,(char *)param_4,param_5,local_28);
    }
    else {
      uVar5 = FUN_00401cd2(puVar1,*param_3,local_28);
      if ((uVar5 == 0) || (uVar5 == 0xe)) {
        iVar6 = local_1c;
        if (local_1c != 0) goto LAB_004030f5;
LAB_00403185:
        uVar5 = 2;
      }
    }
  }
  else if (param_6 == 1) {
    if (iVar2 == 0) {
      *param_4 = *param_4 & (byte)iVar2;
      goto LAB_004030f5;
    }
    uVar5 = FUN_00401cd2(puVar1,iVar2,local_28);
    if ((uVar5 == 0) || (uVar5 == 0xe)) {
      if (local_18 == 0) {
        iVar6 = local_1c;
        if (local_1c != 0) goto LAB_004030f5;
        if (uVar5 != 0) goto LAB_00403194;
        do {
          if ((local_8 == iVar4) || (local_8 == 0)) {
            uVar5 = 2;
          }
          else {
            uVar5 = FUN_00403283((char *)param_4);
            if ((uVar5 != 0) || (uVar5 = FUN_00401cd2(puVar1,local_8,local_28), uVar5 != 0))
            goto LAB_00403194;
            iVar6 = local_1c;
            if (local_1c != 0) goto LAB_004030f5;
          }
        } while (uVar5 == 0);
      }
      else {
        uVar5 = FUN_004031a7(puVar1,local_18,(char *)param_4,param_5,local_28);
      }
    }
  }
  else {
    if (param_6 != 2) goto LAB_00402fad;
    if (iVar2 == 0) {
      *param_4 = *param_4 & (byte)iVar2;
      uVar5 = FUN_0040321c(puVar1,local_18,(char *)param_4,param_5,local_28);
      if (uVar5 != 0) goto LAB_00403194;
      do {
        if (local_18 == 0) break;
        uVar5 = FUN_004031a7(puVar1,local_18,(char *)param_4,param_5,local_28);
      } while (uVar5 == 0);
    }
    else {
      uVar5 = FUN_00401cd2(puVar1,iVar2,local_28);
      if ((uVar5 == 0) || (uVar5 == 0xe)) {
        if (local_1c == 0) {
          if ((local_8 == iVar4) || (local_8 == 0)) goto LAB_00403185;
          uVar5 = FUN_00403283((char *)param_4);
          if (uVar5 != 0) goto LAB_00403194;
          uVar5 = FUN_00401cd2(puVar1,local_8,local_28);
        }
        else {
          uVar5 = FUN_0040321c(puVar1,local_1c,(char *)param_4,param_5,local_28);
          if (uVar5 != 0) goto LAB_00403194;
          do {
            if (local_18 == 0) break;
            uVar5 = FUN_004031a7(puVar1,local_18,(char *)param_4,param_5,local_28);
          } while (uVar5 == 0);
        }
      }
    }
  }
  if (uVar5 == 0) {
    *param_3 = local_28[0];
  }
LAB_00403194:
  FUN_00402160();
  return uVar5;
}



Function: FUN_004031a7
----------------------------------------

int __cdecl FUN_004031a7(undefined4 *param_1,int param_2,char *param_3,uint param_4,int *param_5)

{
  size_t sVar1;
  char *pcVar2;
  int local_8;
  
  local_8 = 0;
  sVar1 = _strlen(param_3);
  if (sVar1 != 0) {
    pcVar2 = param_3 + (sVar1 - 1);
    if (*pcVar2 != '/') {
      if (sVar1 < param_4) {
        pcVar2 = pcVar2 + 1;
        sVar1 = sVar1 + 1;
        *pcVar2 = '/';
      }
      else {
        local_8 = 0xb;
      }
    }
    param_3 = pcVar2 + 1;
  }
  if (local_8 == 0) {
    local_8 = FUN_00401cd2(param_1,param_2,param_5);
    if (local_8 == 0) {
      local_8 = FUN_00401ec1(param_1,(int)param_5,param_4 - sVar1,param_3);
    }
  }
  return local_8;
}



Function: FUN_0040321c
----------------------------------------

int __cdecl FUN_0040321c(undefined4 *param_1,int param_2,char *param_3,uint param_4,int *param_5)

{
  size_t sVar1;
  int iVar2;
  char *pcVar3;
  
  sVar1 = _strlen(param_3);
  if (param_4 < sVar1) {
    iVar2 = 6;
  }
  else {
    pcVar3 = param_3;
    if (sVar1 != 0) {
      for (pcVar3 = param_3 + (sVar1 - 1); param_3 < pcVar3; pcVar3 = pcVar3 + -1) {
        if (*pcVar3 == '/') goto LAB_00403255;
        sVar1 = sVar1 - 1;
      }
      if (*pcVar3 == '/') {
LAB_00403255:
        pcVar3 = pcVar3 + 1;
        sVar1 = sVar1 + 1;
      }
    }
    iVar2 = FUN_00401cd2(param_1,param_2,param_5);
    if (iVar2 == 0) {
      iVar2 = FUN_00401ec1(param_1,(int)param_5,param_4 - sVar1,pcVar3);
    }
  }
  return iVar2;
}



Function: FUN_00403283
----------------------------------------

undefined4 __cdecl FUN_00403283(char *param_1)

{
  size_t sVar1;
  char *pcVar2;
  
  sVar1 = _strlen(param_1);
  if (0 < (int)sVar1) {
    pcVar2 = param_1 + (sVar1 - 1);
    if (*pcVar2 != '/') goto LAB_004032aa;
    do {
      pcVar2 = pcVar2 + -1;
LAB_004032aa:
    } while ((param_1 < pcVar2) && (*pcVar2 != '/'));
    *pcVar2 = '\0';
    return 0;
  }
  return 2;
}



Function: NR_RegEnumEntries
----------------------------------------

uint __cdecl
NR_RegEnumEntries(int *param_1,int param_2,int *param_3,char *param_4,uint param_5,ushort *param_6)

{
  undefined4 *puVar1;
  uint uVar2;
  int local_28 [2];
  ushort local_1e;
  int local_1c;
  int local_14;
  undefined4 local_10;
  
                    /* 0x32b5  7  NR_RegEnumEntries */
  if (param_1 != (int *)0x0) {
    uVar2 = -(uint)(*param_1 != 0x76644441) & 7;
    if (uVar2 != 0) {
      return uVar2;
    }
    if (((param_2 != 0) && (param_3 != (int *)0x0)) && (param_4 != (char *)0x0)) {
      puVar1 = (undefined4 *)param_1[1];
      uVar2 = FUN_0040214a();
      if (uVar2 != 0) {
        return uVar2;
      }
      uVar2 = FUN_00401cd2(puVar1,param_2,local_28);
      if (uVar2 == 0) {
        if (((*param_3 == 0) ||
            (uVar2 = FUN_00401cd2(puVar1,*param_3,local_28), local_14 = local_1c, uVar2 == 0)) ||
           (uVar2 == 0xe)) {
          if (local_14 == 0) {
            uVar2 = 2;
          }
          else {
            *param_4 = '\0';
            uVar2 = FUN_0040321c(puVar1,local_14,param_4,param_5,local_28);
          }
        }
        if (((uVar2 == 0) && (*param_3 = local_28[0], param_6 != (ushort *)0x0)) && (7 < *param_6))
        {
          param_6[1] = local_1e;
          *(undefined4 *)(param_6 + 2) = local_10;
        }
      }
      FUN_00402160();
      return uVar2;
    }
  }
  return 6;
}



Function: NR_StartupRegistry
----------------------------------------

undefined4 NR_StartupRegistry(void)

{
                    /* 0x33b6  23  NR_StartupRegistry */
  DAT_00411eb8 = DAT_00411eb8 + 1;
  if (DAT_00411eb8 == 1) {
    FUN_00403477();
  }
  return 0;
}



Function: NR_ShutdownRegistry
----------------------------------------

void NR_ShutdownRegistry(void)

{
  undefined4 *puVar1;
  
                    /* 0x33cd  22  NR_ShutdownRegistry */
  if ((DAT_00411eb8 != 0) && (DAT_00411eb8 = DAT_00411eb8 + -1, DAT_00411eb8 == 0)) {
    if (DAT_00411eb4 != (undefined4 *)0x0) {
      do {
        puVar1 = DAT_00411eb4;
        if (DAT_00411eb4[6] != 0) {
          FUN_004018be(DAT_00411eb4);
        }
        FUN_00401695(puVar1);
        FUN_004015d5((undefined *)puVar1);
      } while (DAT_00411eb4 != (undefined4 *)0x0);
    }
    if (DAT_00411ec0 != (undefined *)0x0) {
      FUN_00404d98(DAT_00411ec0);
    }
    if (DAT_00411ebc != (undefined *)0x0) {
      FUN_00404d98(DAT_00411ebc);
    }
    if (DAT_004120d8 != (undefined *)0x0) {
      FUN_00404d98(DAT_004120d8);
    }
  }
  return;
}



Function: FUN_00403440
----------------------------------------

undefined4 __cdecl FUN_00403440(byte *param_1)

{
  undefined4 uVar1;
  int iVar2;
  undefined *puVar3;
  int local_28 [9];
  
  uVar1 = 0;
  if (param_1 != (byte *)0x0) {
    iVar2 = FUN_0040c2ce(param_1,local_28);
    if (iVar2 == 0) {
      puVar3 = &DAT_0040f0f0;
    }
    else {
      puVar3 = &DAT_0040f12c;
    }
    uVar1 = FUN_00405b0b(param_1,puVar3);
  }
  return uVar1;
}



Function: FUN_00403477
----------------------------------------

void FUN_00403477(void)

{
  UINT UVar1;
  uint local_108 [65];
  
  UVar1 = GetWindowsDirectoryA((LPSTR)local_108,0x104);
  if (0 < (int)UVar1) {
    if (DAT_00411ebc != (uint *)0x0) {
      FUN_00404d98((undefined *)DAT_00411ebc);
    }
    FUN_00404b30((uint *)((int)local_108 + UVar1),(uint *)s__mozregistry_dat_0040f130);
    DAT_00411ebc = FUN_0040c1dc(local_108);
  }
  return;
}



Function: FUN_004034d2
----------------------------------------

uint * FUN_004034d2(void)

{
  UINT UVar1;
  uint local_108 [65];
  
  if (DAT_004120d8 == (uint *)0x0) {
    UVar1 = GetWindowsDirectoryA((LPSTR)local_108,0x104);
    if (0 < (int)UVar1) {
      FUN_00404b30((uint *)((int)local_108 + UVar1),(uint *)s__mozver_dat_0040f144);
      DAT_004120d8 = FUN_0040c1dc(local_108);
    }
  }
  return DAT_004120d8;
}



Function: VR_CreateRegistry
----------------------------------------

uint __cdecl VR_CreateRegistry(uint *param_1,char *param_2,uint *param_3)

{
  uint *puVar1;
  uint uVar2;
  
                    /* 0x3527  25  VR_CreateRegistry */
  puVar1 = FUN_004034d2();
  if ((param_1 != (uint *)0x0) && ((char)*param_1 != '\0')) {
    uVar2 = NR_RegOpen((char *)puVar1,&DAT_004120d0);
    if (uVar2 == 0) {
      uVar2 = FUN_00403587(param_1,param_2,param_3);
      if (uVar2 == 0) {
        DAT_004120c8 = 1;
      }
      else {
        NR_RegClose(DAT_004120d0);
      }
    }
    return uVar2;
  }
  return 6;
}



Function: FUN_00403587
----------------------------------------

uint __cdecl FUN_00403587(uint *param_1,char *param_2,uint *param_3)

{
  bool bVar1;
  uint uVar2;
  undefined3 extraout_var;
  undefined3 extraout_var_00;
  char *pcVar3;
  byte local_410 [512];
  uint local_210 [128];
  char *local_10;
  int local_c;
  char *local_8;
  
  if ((param_1 == (uint *)0x0) || (param_2 == (char *)0x0)) {
    return 6;
  }
  uVar2 = NR_RegAddKey(DAT_004120d0,0x21,(byte *)s__mozilla_org_0040f17c,(int *)&local_8);
  if (uVar2 != 0) {
    return uVar2;
  }
  uVar2 = NR_RegGetEntryString
                    (DAT_004120d0,(int)local_8,s_CurrentVersion_0040f16c,&DAT_00411ec8,0x200);
  if (uVar2 == 3) {
    uVar2 = NR_RegAddKey(DAT_004120d0,(int)local_8,(byte *)param_1,(int *)&DAT_004120cc);
    if (uVar2 != 0) {
      return uVar2;
    }
    uVar2 = FUN_0040392c(DAT_004120d0,(int)DAT_004120cc,(byte *)s_InstallDir_0040f160,param_2);
    if (uVar2 != 0) {
      return uVar2;
    }
    if (((param_3 != (uint *)0x0) && ((char)*param_3 != '\0')) &&
       (uVar2 = NR_RegSetEntryString
                          (DAT_004120d0,(int)DAT_004120cc,(byte *)s_Version_0040f158,(byte *)param_3
                          ), uVar2 != 0)) {
      return uVar2;
    }
LAB_004038b9:
    pcVar3 = s_CurrentVersion_0040f16c;
  }
  else {
    if (uVar2 != 0) {
      return uVar2;
    }
    local_c = 0;
    uVar2 = NR_RegGetKey(DAT_004120d0,(int)local_8,&DAT_00411ec8,&DAT_004120cc);
    if (uVar2 == 0) {
      uVar2 = FUN_00403951(DAT_004120d0,DAT_004120cc,s_InstallDir_0040f160,(char *)local_410);
      if (uVar2 == 0) {
        bVar1 = FUN_004038dd(local_410,param_2);
        local_c = CONCAT31(extraout_var,bVar1);
      }
      else if (uVar2 == 3) {
        uVar2 = FUN_0040392c(DAT_004120d0,(int)DAT_004120cc,(byte *)s_InstallDir_0040f160,param_2);
        local_c = 1;
      }
    }
    local_10 = (char *)0x0;
    if (local_c == 0) {
      do {
        if ((uVar2 != 0) && (uVar2 != 9)) break;
        uVar2 = NR_RegEnumSubkeys(DAT_004120d0,(int)local_8,(int *)&local_10,&DAT_00411ec8,0x200,0);
        if (uVar2 == 0) {
          uVar2 = FUN_00403951(DAT_004120d0,local_10,s_InstallDir_0040f160,(char *)local_410);
          if (uVar2 == 0) {
            bVar1 = FUN_004038dd(local_410,param_2);
            if (CONCAT31(extraout_var_00,bVar1) != 0) {
              local_c = 1;
              DAT_004120cc = local_10;
            }
          }
          else if (uVar2 == 3) {
            uVar2 = 0;
          }
        }
      } while (local_c == 0);
      if (local_c == 0) {
        if (uVar2 != 2) {
          return uVar2;
        }
        FUN_00404b30(local_210,param_1);
        while (uVar2 = NR_RegGetKey(DAT_004120d0,(int)local_8,(char *)local_210,&DAT_004120cc),
              uVar2 == 0) {
          FUN_00405b1e((undefined1 *)local_210,(byte *)s__s___d_0040f150);
        }
        if (uVar2 != 3) {
          return uVar2;
        }
        uVar2 = NR_RegAddKey(DAT_004120d0,(int)local_8,(byte *)local_210,(int *)&DAT_004120cc);
        if (uVar2 != 0) {
          return uVar2;
        }
        uVar2 = FUN_0040392c(DAT_004120d0,(int)DAT_004120cc,(byte *)s_InstallDir_0040f160,param_2);
        if (uVar2 != 0) {
          return uVar2;
        }
        uVar2 = 0;
        if ((param_3 != (uint *)0x0) && ((char)*param_3 != '\0')) {
          uVar2 = NR_RegSetEntryString
                            (DAT_004120d0,(int)DAT_004120cc,(byte *)s_Version_0040f158,
                             (byte *)param_3);
        }
        if (uVar2 != 0) {
          return uVar2;
        }
        param_1 = local_210;
        goto LAB_004038b9;
      }
    }
    uVar2 = NR_RegSetEntryString
                      (DAT_004120d0,(int)local_8,(byte *)s_CurrentVersion_0040f16c,&DAT_00411ec8);
    if (uVar2 != 0) {
      return uVar2;
    }
    if (param_3 == (uint *)0x0) {
      return 0;
    }
    if ((char)*param_3 == '\0') {
      return 0;
    }
    pcVar3 = s_Version_0040f158;
    local_8 = DAT_004120cc;
    param_1 = param_3;
  }
  uVar2 = NR_RegSetEntryString(DAT_004120d0,(int)local_8,(byte *)pcVar3,(byte *)param_1);
  return uVar2;
}



Function: FUN_004038dd
----------------------------------------

bool __cdecl FUN_004038dd(byte *param_1,char *param_2)

{
  void *pvVar1;
  void *pvVar2;
  
  if ((param_1 != (byte *)0x0) && (param_2 != (char *)0x0)) {
    pvVar1 = (void *)_strlen((char *)param_1);
    pvVar2 = (void *)_strlen(param_2);
    if (param_1[(int)pvVar1 - 1] == 0x5c) {
      pvVar1 = (void *)((int)pvVar1 - 1);
    }
    if (param_2[(int)pvVar2 - 1] == '\\') {
      pvVar2 = (void *)((int)pvVar2 - 1);
    }
    if (pvVar1 == pvVar2) {
      pvVar1 = FUN_0040b070(param_1,param_2,pvVar1);
      return (bool)('\x01' - (pvVar1 != (void *)0x0));
    }
  }
  return false;
}



Function: FUN_0040392c
----------------------------------------

void __cdecl FUN_0040392c(int *param_1,int param_2,byte *param_3,char *param_4)

{
  size_t sVar1;
  
  sVar1 = _strlen(param_4);
  NR_RegSetEntry(param_1,param_2,param_3,0x14,param_4,sVar1 + 1);
  return;
}



Function: FUN_00403951
----------------------------------------

void __cdecl FUN_00403951(int *param_1,char *param_2,char *param_3,char *param_4)

{
  NR_RegGetEntry(param_1,param_2,param_3,param_4,(uint *)&stack0x00000014);
  return;
}



Function: VR_Close
----------------------------------------

void VR_Close(void)

{
                    /* 0x396e  24  VR_Close */
  if (DAT_004120c8 != 0) {
    NR_RegClose(DAT_004120d0);
    DAT_004120c8 = 0;
  }
  return;
}



Function: VR_GetVersion
----------------------------------------

uint __cdecl VR_GetVersion(char *param_1,undefined4 *param_2)

{
  uint uVar1;
  void *this;
  byte local_220 [512];
  undefined4 local_20 [5];
  int local_c;
  int *local_8;
  
                    /* 0x398c  32  VR_GetVersion */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    local_8 = DAT_004120d0;
    uVar1 = FUN_00403b7b(param_1,&local_8,&local_c);
    if (uVar1 == 0) {
      uVar1 = NR_RegGetEntryString(local_8,local_c,s_Version_0040f158,(char *)local_220,0x200);
      if (uVar1 == 0) {
        FUN_00403ae7(this,local_220,local_20);
        FUN_004055b0(param_2,local_20,0x14);
        uVar1 = 0;
      }
    }
  }
  return uVar1;
}



Function: FUN_00403a05
----------------------------------------

uint FUN_00403a05(void)

{
  uint *puVar1;
  uint uVar2;
  uint local_208 [128];
  int local_8;
  
  uVar2 = 0;
  puVar1 = FUN_004034d2();
  if (DAT_004120c8 == 0) {
    uVar2 = NR_RegOpen((char *)puVar1,&DAT_004120d0);
    if (uVar2 == 0) {
      uVar2 = NR_RegAddKey(DAT_004120d0,0x21,(byte *)s__mozilla_org_0040f17c,&local_8);
      if (uVar2 == 0) {
        uVar2 = NR_RegGetEntryString
                          (DAT_004120d0,local_8,s_CurrentVersion_0040f16c,(char *)local_208,0x200);
        if (uVar2 == 3) {
          uVar2 = NR_RegSetEntryString
                            (DAT_004120d0,local_8,(byte *)s_CurrentVersion_0040f16c,
                             (byte *)s_Mozilla_0040f18c);
          FUN_00404b30(local_208,(uint *)s_Mozilla_0040f18c);
        }
        if (uVar2 == 0) {
          uVar2 = NR_RegAddKey(DAT_004120d0,local_8,(byte *)local_208,&DAT_004120cc);
          if (uVar2 == 0) {
            DAT_004120c8 = 1;
          }
        }
      }
    }
  }
  return uVar2;
}



Function: FUN_00403ae7
----------------------------------------

undefined4 __thiscall FUN_00403ae7(void *this,byte *param_1,undefined4 *param_2)

{
  byte bVar1;
  undefined4 uVar2;
  byte *pbVar3;
  byte *pbVar4;
  byte *this_00;
  
  param_2[3] = 0;
  param_2[2] = 0;
  param_2[1] = 0;
  *param_2 = 0;
  pbVar4 = param_1;
  uVar2 = FUN_00405bfb(this,param_1);
  *param_2 = uVar2;
  bVar1 = *param_1;
  if (bVar1 != 0) {
    do {
      if (bVar1 == 0x2e) break;
      param_1 = param_1 + 1;
      bVar1 = *param_1;
    } while (bVar1 != 0);
    if (*param_1 != 0) {
      pbVar3 = param_1 + 1;
      this_00 = pbVar3;
      uVar2 = FUN_00405bfb(pbVar4,pbVar3);
      param_2[1] = uVar2;
      bVar1 = *pbVar3;
      if (bVar1 != 0) {
        do {
          if (bVar1 == 0x2e) break;
          pbVar3 = pbVar3 + 1;
          bVar1 = *pbVar3;
        } while (bVar1 != 0);
        if (*pbVar3 != 0) {
          pbVar3 = pbVar3 + 1;
          pbVar4 = pbVar3;
          uVar2 = FUN_00405bfb(this_00,pbVar3);
          param_2[2] = uVar2;
          bVar1 = *pbVar3;
          if (bVar1 != 0) {
            do {
              if (bVar1 == 0x2e) break;
              pbVar3 = pbVar3 + 1;
              bVar1 = *pbVar3;
            } while (bVar1 != 0);
            if (*pbVar3 != 0) {
              pbVar3 = pbVar3 + 1;
              uVar2 = FUN_00405bfb(pbVar4,pbVar3);
              param_2[3] = uVar2;
              while( true ) {
                if ((*pbVar3 == 0) || (*pbVar3 == 0x2e)) break;
                pbVar3 = pbVar3 + 1;
              }
            }
          }
        }
      }
    }
  }
  return 0;
}



Function: FUN_00403b7b
----------------------------------------

uint __cdecl FUN_00403b7b(char *param_1,undefined4 *param_2,undefined4 *param_3)

{
  int iVar1;
  uint uVar2;
  
  *param_2 = DAT_004120d0;
  if ((param_1 == (char *)0x0) || (*param_1 != '/')) {
    iVar1 = DAT_004120cc;
    if (DAT_004120cc == 0) {
      return 3;
    }
  }
  else {
    iVar1 = 0x21;
  }
  uVar2 = NR_RegGetKey(DAT_004120d0,iVar1,param_1,param_3);
  return uVar2;
}



Function: VR_GetPath
----------------------------------------

void __cdecl VR_GetPath(char *param_1,undefined4 param_2,char *param_3)

{
  uint uVar1;
  char *local_c;
  int *local_8;
  
                    /* 0x3bbb  29  VR_GetPath */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    local_8 = DAT_004120d0;
    uVar1 = FUN_00403b7b(param_1,&local_8,&local_c);
    if (uVar1 == 0) {
      FUN_00403951(local_8,local_c,&DAT_0040f194,param_3);
    }
  }
  return;
}



Function: VR_SetDefaultDirectory
----------------------------------------

void __cdecl VR_SetDefaultDirectory(char *param_1,char *param_2)

{
  uint uVar1;
  int iVar2;
  int local_8;
  
                    /* 0x3c03  36  VR_SetDefaultDirectory */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    iVar2 = DAT_004120cc;
    if ((param_1 != (char *)0x0) && (*param_1 == '/')) {
      iVar2 = 0x21;
    }
    uVar1 = NR_RegGetKey(DAT_004120d0,iVar2,param_1,&local_8);
    if (uVar1 == 0) {
      FUN_0040392c(DAT_004120d0,local_8,(byte *)s_Directory_0040f19c,param_2);
    }
  }
  return;
}



Function: VR_GetDefaultDirectory
----------------------------------------

void __cdecl VR_GetDefaultDirectory(char *param_1,undefined4 param_2,char *param_3)

{
  uint uVar1;
  char *local_c;
  int *local_8;
  
                    /* 0x3c59  28  VR_GetDefaultDirectory */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    local_8 = DAT_004120d0;
    uVar1 = FUN_00403b7b(param_1,&local_8,&local_c);
    if (uVar1 == 0) {
      FUN_00403951(local_8,local_c,s_Directory_0040f19c,param_3);
    }
  }
  return;
}



Function: VR_Install
----------------------------------------

uint __cdecl VR_Install(byte *param_1,char *param_2,byte *param_3,int param_4)

{
  byte *pbVar1;
  uint uVar2;
  char *pcVar3;
  int local_8;
  
                    /* 0x3ca1  34  VR_Install */
  pbVar1 = param_1;
  uVar2 = FUN_00403a05();
  if (uVar2 != 0) {
    return uVar2;
  }
  if ((param_1 == (byte *)0x0) || (*param_1 != 0x2f)) {
    param_1 = DAT_004120cc;
  }
  else {
    param_1 = (byte *)0x21;
  }
  if ((pbVar1 == (byte *)0x0) || (*pbVar1 != 0)) {
    uVar2 = NR_RegAddKey(DAT_004120d0,(int)param_1,pbVar1,&local_8);
  }
  else {
    uVar2 = NR_RegGetKey(DAT_004120d0,(int)param_1,(char *)pbVar1,&local_8);
  }
  if (uVar2 != 0) {
    return uVar2;
  }
  if (((param_3 == (byte *)0x0) || (*param_3 == 0)) ||
     (uVar2 = NR_RegSetEntryString(DAT_004120d0,local_8,(byte *)s_Version_0040f158,param_3),
     uVar2 == 0)) {
    if ((param_2 != (char *)0x0) && (*param_2 != '\0')) {
      pcVar3 = s_Directory_0040f19c;
      if (param_4 == 0) {
        pcVar3 = &DAT_0040f194;
      }
      uVar2 = FUN_0040392c(DAT_004120d0,local_8,(byte *)pcVar3,param_2);
      if (uVar2 != 0) goto LAB_00403d67;
    }
    uVar2 = 0;
  }
  else {
LAB_00403d67:
    NR_RegDeleteKey(DAT_004120d0,(int)param_1,(char *)pbVar1);
  }
  return uVar2;
}



Function: VR_Remove
----------------------------------------

void __cdecl VR_Remove(char *param_1)

{
  uint uVar1;
  int iVar2;
  
                    /* 0x3d83  35  VR_Remove */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    iVar2 = DAT_004120cc;
    if ((param_1 != (char *)0x0) && (*param_1 == '/')) {
      iVar2 = 0x21;
    }
    NR_RegDeleteKey(DAT_004120d0,iVar2,param_1);
  }
  return;
}



Function: VR_Enum
----------------------------------------

void __cdecl VR_Enum(char *param_1,int *param_2,byte *param_3,uint param_4)

{
  uint uVar1;
  int iVar2;
  int local_8;
  
                    /* 0x3db4  26  VR_Enum */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    if ((param_1 == (char *)0x0) || (iVar2 = DAT_004120cc, *param_1 == '/')) {
      iVar2 = 0x21;
    }
    uVar1 = NR_RegGetKey(DAT_004120d0,iVar2,param_1,&local_8);
    if (uVar1 == 0) {
      NR_RegEnumSubkeys(DAT_004120d0,local_8,param_2,param_3,param_4,2);
    }
  }
  return;
}



Function: VR_InRegistry
----------------------------------------

void __cdecl VR_InRegistry(char *param_1)

{
  uint uVar1;
  undefined4 local_8;
  
                    /* 0x3e0d  33  VR_InRegistry */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    FUN_00403b7b(param_1,&param_1,&local_8);
  }
  return;
}



Function: VR_ValidateComponent
----------------------------------------

uint __cdecl VR_ValidateComponent(char *param_1)

{
  uint uVar1;
  size_t sVar2;
  int iVar3;
  byte local_830 [2048];
  int local_30 [9];
  undefined4 local_c;
  undefined4 local_8;
  
                    /* 0x3e2f  46  VR_ValidateComponent */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    uVar1 = FUN_00403b7b(param_1,&local_8,&local_c);
    if (uVar1 == 0) {
      uVar1 = VR_GetPath(param_1,0x800,(char *)local_830);
      if (uVar1 == 0) {
        sVar2 = _strlen((char *)local_830);
        if (local_830[sVar2 - 1] == 0x5c) {
          local_830[sVar2 - 1] = 0;
        }
        iVar3 = FUN_0040c2ce(local_830,local_30);
        uVar1 = -(uint)(iVar3 != 0) & 9;
      }
      else if (uVar1 == 3) {
        return 0x10;
      }
    }
  }
  return uVar1;
}



Function: VR_SetRegDirectory
----------------------------------------

undefined4 __cdecl VR_SetRegDirectory(uint *param_1)

{
  uint *puVar1;
  
                    /* 0x3eb4  38  VR_SetRegDirectory */
  puVar1 = FUN_0040c1dc(param_1);
  if (puVar1 == (uint *)0x0) {
    return 10;
  }
  if (DAT_004120d4 != (uint *)0x0) {
    FUN_00404d98((undefined *)DAT_004120d4);
  }
  DAT_004120d4 = puVar1;
  return 0;
}



Function: VR_SetRefCount
----------------------------------------

uint __cdecl VR_SetRefCount(byte *param_1)

{
  uint uVar1;
  int iVar2;
  byte local_208 [512];
  int local_8;
  
                    /* 0x3ee4  37  VR_SetRefCount */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    iVar2 = DAT_004120cc;
    if ((param_1 != (byte *)0x0) && (*param_1 == 0x2f)) {
      iVar2 = 0x21;
    }
    if ((param_1 == (byte *)0x0) || (*param_1 != 0)) {
      uVar1 = NR_RegAddKey(DAT_004120d0,iVar2,param_1,&local_8);
      if (uVar1 == 0) {
        local_208[0] = 0;
        FUN_00405b1e(local_208,&DAT_0040f1b4);
        if (local_208[0] != 0) {
          uVar1 = NR_RegSetEntryString(DAT_004120d0,local_8,(byte *)s_RefCount_0040f1a8,local_208);
        }
      }
    }
    else {
      uVar1 = 6;
    }
  }
  return uVar1;
}



Function: VR_GetRefCount
----------------------------------------

uint __cdecl VR_GetRefCount(char *param_1,undefined4 *param_2)

{
  undefined4 *puVar1;
  uint uVar2;
  int iVar3;
  undefined4 uVar4;
  void *this;
  byte local_204 [512];
  
                    /* 0x3f88  30  VR_GetRefCount */
  puVar1 = param_2;
  *param_2 = 0xffffffff;
  uVar2 = FUN_00403a05();
  if (uVar2 == 0) {
    iVar3 = DAT_004120cc;
    if ((param_1 != (char *)0x0) && (*param_1 == '/')) {
      iVar3 = 0x21;
    }
    uVar2 = NR_RegGetKey(DAT_004120d0,iVar3,param_1,&param_2);
    if ((uVar2 == 0) &&
       (uVar2 = NR_RegGetEntryString
                          (DAT_004120d0,(int)param_2,s_RefCount_0040f1a8,(char *)local_204,0x200),
       uVar2 == 0)) {
      uVar4 = FUN_00405bfb(this,local_204);
      *puVar1 = uVar4;
      uVar2 = 0;
    }
  }
  return uVar2;
}



Function: VR_UninstallCreateNode
----------------------------------------

uint __cdecl VR_UninstallCreateNode(uint *param_1,byte *param_2)

{
  uint uVar1;
  size_t sVar2;
  uint *puVar3;
  int local_8;
  
                    /* 0x4009  40  VR_UninstallCreateNode */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    sVar2 = _strlen((char *)param_1);
    puVar3 = (uint *)_malloc(sVar2 + 0x100);
    if (puVar3 == (uint *)0x0) {
      uVar1 = 10;
    }
    else {
      uVar1 = FUN_0040409d(param_1,puVar3,sVar2 + 0x100);
      if (uVar1 != 0) {
        FUN_00404d98((undefined *)puVar3);
        return uVar1;
      }
      uVar1 = NR_RegAddKey(DAT_004120d0,4,(byte *)puVar3,&local_8);
      FUN_00404d98((undefined *)puVar3);
    }
    if (uVar1 == 0) {
      uVar1 = NR_RegSetEntryString(DAT_004120d0,local_8,(byte *)s_PackageName_0040f1b8,param_2);
    }
  }
  return uVar1;
}



Function: FUN_0040409d
----------------------------------------

undefined4 __cdecl FUN_0040409d(uint *param_1,uint *param_2,uint param_3)

{
  bool bVar1;
  bool bVar2;
  size_t sVar3;
  size_t sVar4;
  char *pcVar5;
  
  bVar1 = false;
  bVar2 = false;
  if ((char)*param_1 == '\0') {
    bVar2 = true;
  }
  else if ((char)*param_1 == '/') {
    bVar1 = true;
  }
  sVar3 = _strlen(s_Mozilla_XPInstall_Uninstall__0040f1d0);
  if (sVar3 < param_3) {
    FUN_00404b30(param_2,(uint *)s_Mozilla_XPInstall_Uninstall__0040f1d0);
    if (bVar1) {
      sVar4 = _strlen(s_Shared_0040f1c8);
      if (param_3 - sVar3 <= sVar4) {
        return 0xb;
      }
      pcVar5 = s_Shared_0040f1c8;
    }
    else {
      sVar4 = _strlen(&DAT_00411ec8);
      if (param_3 - sVar3 <= sVar4) {
        return 0xb;
      }
      FUN_00404b40(param_2,(uint *)&DAT_00411ec8);
      if ((param_3 - sVar4) - sVar3 < 2) {
        return 0xb;
      }
      pcVar5 = &DAT_0040f0f4;
    }
    FUN_00404b40(param_2,(uint *)pcVar5);
    sVar3 = _strlen((char *)param_2);
    if (bVar2) {
      sVar4 = _strlen(&DAT_0040f1c4);
      if (sVar4 < param_3 - sVar3) {
        param_1 = (uint *)&DAT_0040f1c4;
LAB_00404184:
        FUN_00404b40(param_2,param_1);
        return 0;
      }
    }
    else {
      sVar4 = _strlen((char *)param_1);
      if (sVar4 < param_3 - sVar3) goto LAB_00404184;
    }
  }
  return 0xb;
}



Function: VR_GetUninstallUserName
----------------------------------------

uint __cdecl VR_GetUninstallUserName(char *param_1,char *param_2,uint param_3)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  uint *puVar3;
  int local_8;
  
                    /* 0x419a  31  VR_GetUninstallUserName */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    if (((param_1 == (char *)0x0) || (*param_1 == '\0')) || (param_2 == (char *)0x0)) {
      uVar1 = 6;
    }
    else {
      sVar2 = _strlen(param_1);
      sVar2 = sVar2 * 2 + 1;
      _Str = (uint *)_malloc(sVar2);
      if (_Str == (uint *)0x0) {
        uVar1 = 10;
      }
      else {
        uVar1 = FUN_00404283(param_1,(char *)_Str,sVar2);
        if (uVar1 == 0) {
          sVar2 = _strlen((char *)_Str);
          puVar3 = (uint *)_malloc(sVar2 + 0x100);
          if (puVar3 == (uint *)0x0) {
            uVar1 = 10;
          }
          else {
            uVar1 = FUN_0040409d(_Str,puVar3,sVar2 + 0x100);
            if (uVar1 == 0) {
              uVar1 = NR_RegGetKey(DAT_004120d0,4,(char *)puVar3,&local_8);
            }
            FUN_00404d98((undefined *)puVar3);
            if (uVar1 == 0) {
              uVar1 = NR_RegGetEntryString
                                (DAT_004120d0,local_8,s_PackageName_0040f1b8,param_2,param_3);
            }
          }
        }
        FUN_00404d98((undefined *)_Str);
      }
    }
  }
  return uVar1;
}



Function: FUN_00404283
----------------------------------------

undefined4 __cdecl FUN_00404283(char *param_1,char *param_2,uint param_3)

{
  char *pcVar1;
  size_t sVar2;
  undefined4 uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  sVar2 = _strlen(param_1);
  if (sVar2 < param_3) {
    uVar5 = 0;
    uVar4 = 0;
    if (sVar2 != 0) {
      uVar6 = 1;
      do {
        if (param_3 - 1 <= uVar4) goto LAB_0040430f;
        param_2[uVar4] = param_1[uVar5];
        if (param_1[uVar5] == '_') {
          if (param_3 - 1 <= uVar6) goto LAB_0040430f;
          param_2[uVar4 + 1] = '_';
          uVar4 = uVar4 + 1;
          uVar6 = uVar6 + 1;
        }
        uVar5 = uVar5 + 1;
        uVar4 = uVar4 + 1;
        uVar6 = uVar6 + 1;
      } while (uVar5 < sVar2);
    }
    pcVar1 = param_2 + uVar4;
    if (pcVar1[-1] == '/') {
      pcVar1[-1] = '\0';
    }
    else {
      if (param_3 <= uVar4) goto LAB_0040430f;
      *pcVar1 = '\0';
    }
    sVar2 = _strlen(param_2);
    uVar4 = 1;
    if (1 < sVar2) {
      do {
        if (param_2[uVar4] == '/') {
          param_2[uVar4] = '_';
        }
        uVar4 = uVar4 + 1;
      } while (uVar4 < sVar2);
    }
    uVar3 = 0;
  }
  else {
LAB_0040430f:
    uVar3 = 0xb;
  }
  return uVar3;
}



Function: VR_UninstallAddFileToList
----------------------------------------

uint __cdecl VR_UninstallAddFileToList(uint *param_1,byte *param_2)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  size_t sVar3;
  size_t sVar4;
  int local_8;
  
                    /* 0x4317  39  VR_UninstallAddFileToList */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    sVar2 = _strlen((char *)param_1);
    sVar2 = sVar2 + 0x100;
    _Str = (uint *)_malloc(sVar2);
    if (_Str == (uint *)0x0) {
      uVar1 = 10;
    }
    else {
      uVar1 = FUN_0040409d(param_1,_Str,sVar2);
      if (uVar1 == 0) {
        sVar3 = _strlen((char *)_Str);
        sVar4 = _strlen(s__Shared_Files_0040f1f0);
        if (sVar4 < sVar2 - sVar3) {
          FUN_00404b40(_Str,(uint *)s__Shared_Files_0040f1f0);
          uVar1 = NR_RegAddKey(DAT_004120d0,4,(byte *)_Str,&local_8);
        }
        else {
          uVar1 = 0xb;
        }
      }
      FUN_00404d98((undefined *)_Str);
    }
    if (uVar1 == 0) {
      uVar1 = NR_RegSetEntryString(DAT_004120d0,local_8,param_2,&DAT_00411eb0);
    }
  }
  return uVar1;
}



Function: VR_UninstallFileExistsInList
----------------------------------------

uint __cdecl VR_UninstallFileExistsInList(uint *param_1,char *param_2)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  size_t sVar3;
  size_t sVar4;
  char local_208 [512];
  int local_8;
  
                    /* 0x43d2  45  VR_UninstallFileExistsInList */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    sVar2 = _strlen((char *)param_1);
    sVar2 = sVar2 + 0x100;
    _Str = (uint *)_malloc(sVar2);
    if (_Str == (uint *)0x0) {
      uVar1 = 10;
    }
    else {
      uVar1 = FUN_0040409d(param_1,_Str,sVar2);
      if (uVar1 == 0) {
        sVar3 = _strlen((char *)_Str);
        sVar4 = _strlen(s__Shared_Files_0040f1f0);
        if (sVar4 < sVar2 - sVar3) {
          FUN_00404b40(_Str,(uint *)s__Shared_Files_0040f1f0);
          uVar1 = NR_RegGetKey(DAT_004120d0,4,(char *)_Str,&local_8);
        }
        else {
          uVar1 = 0xb;
        }
      }
      FUN_00404d98((undefined *)_Str);
    }
    if (uVar1 == 0) {
      uVar1 = NR_RegGetEntryString(DAT_004120d0,local_8,param_2,local_208,0x200);
    }
  }
  return uVar1;
}



Function: VR_UninstallEnumSharedFiles
----------------------------------------

uint __cdecl VR_UninstallEnumSharedFiles(char *param_1,int *param_2,char *param_3,uint param_4)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  uint *_Str_00;
  size_t sVar3;
  size_t sVar4;
  int local_8;
  
                    /* 0x4499  44  VR_UninstallEnumSharedFiles */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    if (param_1 == (char *)0x0) {
      uVar1 = 6;
    }
    else {
      sVar2 = _strlen(param_1);
      sVar2 = sVar2 * 2 + 1;
      _Str = (uint *)_malloc(sVar2);
      if (_Str == (uint *)0x0) {
        uVar1 = 10;
      }
      else {
        uVar1 = FUN_00404283(param_1,(char *)_Str,sVar2);
        if (uVar1 == 0) {
          sVar2 = _strlen((char *)_Str);
          sVar2 = sVar2 + 0x100;
          _Str_00 = (uint *)_malloc(sVar2);
          if (_Str_00 == (uint *)0x0) {
            uVar1 = 10;
          }
          else {
            uVar1 = FUN_0040409d(_Str,_Str_00,sVar2);
            if (uVar1 == 0) {
              sVar3 = _strlen((char *)_Str_00);
              sVar4 = _strlen(s__Shared_Files_0040f1f0);
              if (sVar4 < sVar2 - sVar3) {
                FUN_00404b40(_Str_00,(uint *)s__Shared_Files_0040f1f0);
                uVar1 = NR_RegGetKey(DAT_004120d0,4,(char *)_Str_00,&local_8);
              }
              else {
                uVar1 = 0xb;
              }
            }
            FUN_00404d98((undefined *)_Str_00);
          }
          FUN_00404d98((undefined *)_Str);
          if (uVar1 == 0) {
            uVar1 = NR_RegEnumEntries(DAT_004120d0,local_8,param_2,param_3,param_4,(ushort *)0x0);
          }
        }
        else {
          FUN_00404d98((undefined *)_Str);
        }
      }
    }
  }
  return uVar1;
}



Function: VR_UninstallDeleteFileFromList
----------------------------------------

uint __cdecl VR_UninstallDeleteFileFromList(char *param_1,char *param_2)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  uint *_Str_00;
  size_t sVar3;
  size_t sVar4;
  int local_8;
  
                    /* 0x45ac  41  VR_UninstallDeleteFileFromList */
  local_8 = 0;
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    sVar2 = _strlen(param_1);
    sVar2 = sVar2 * 2 + 1;
    _Str = (uint *)_malloc(sVar2);
    if (_Str == (uint *)0x0) {
      uVar1 = 10;
    }
    else {
      uVar1 = FUN_00404283(param_1,(char *)_Str,sVar2);
      if (uVar1 == 0) {
        sVar2 = _strlen((char *)_Str);
        sVar2 = sVar2 + 0x100;
        _Str_00 = (uint *)_malloc(sVar2);
        if (_Str_00 == (uint *)0x0) {
          uVar1 = 10;
        }
        else {
          uVar1 = FUN_0040409d(_Str,_Str_00,sVar2);
          if (uVar1 == 0) {
            sVar3 = _strlen((char *)_Str_00);
            sVar4 = _strlen(s__Shared_Files_0040f1f0);
            if (sVar4 < sVar2 - sVar3) {
              FUN_00404b40(_Str_00,(uint *)s__Shared_Files_0040f1f0);
              uVar1 = NR_RegGetKey(DAT_004120d0,4,(char *)_Str_00,&local_8);
            }
            else {
              uVar1 = 0xb;
            }
          }
          FUN_00404d98((undefined *)_Str_00);
        }
        FUN_00404d98((undefined *)_Str);
        if (uVar1 == 0) {
          uVar1 = NR_RegDeleteEntry(DAT_004120d0,local_8,param_2);
        }
      }
      else {
        FUN_00404d98((undefined *)_Str);
      }
    }
  }
  return uVar1;
}



Function: VR_UninstallDeleteSharedFilesKey
----------------------------------------

uint __cdecl VR_UninstallDeleteSharedFilesKey(char *param_1)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  uint *_Str_00;
  size_t sVar3;
  size_t sVar4;
  
                    /* 0x46ae  42  VR_UninstallDeleteSharedFilesKey */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    sVar2 = _strlen(param_1);
    sVar2 = sVar2 * 2 + 1;
    _Str = (uint *)_malloc(sVar2);
    if (_Str == (uint *)0x0) {
      uVar1 = 10;
    }
    else {
      uVar1 = FUN_00404283(param_1,(char *)_Str,sVar2);
      if (uVar1 == 0) {
        sVar2 = _strlen((char *)_Str);
        sVar2 = sVar2 + 0x100;
        _Str_00 = (uint *)_malloc(sVar2);
        if (_Str_00 == (uint *)0x0) {
          uVar1 = 10;
        }
        else {
          uVar1 = FUN_0040409d(_Str,_Str_00,sVar2);
          if (uVar1 == 0) {
            sVar3 = _strlen((char *)_Str_00);
            sVar4 = _strlen(s__Shared_Files_0040f1f0);
            if (sVar4 < sVar2 - sVar3) {
              FUN_00404b40(_Str_00,(uint *)s__Shared_Files_0040f1f0);
              uVar1 = NR_RegDeleteKey(DAT_004120d0,4,(char *)_Str_00);
            }
            else {
              uVar1 = 0xb;
            }
          }
          FUN_00404d98((undefined *)_Str_00);
        }
        FUN_00404d98((undefined *)_Str);
      }
      else {
        FUN_00404d98((undefined *)_Str);
      }
    }
  }
  return uVar1;
}



Function: VR_UninstallDestroy
----------------------------------------

uint __cdecl VR_UninstallDestroy(char *param_1)

{
  uint uVar1;
  size_t sVar2;
  uint *_Str;
  uint *puVar3;
  int iVar4;
  
                    /* 0x4789  43  VR_UninstallDestroy */
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    sVar2 = _strlen(param_1);
    sVar2 = sVar2 * 2 + 1;
    _Str = (uint *)_malloc(sVar2);
    if (_Str == (uint *)0x0) {
      uVar1 = 10;
    }
    else {
      uVar1 = FUN_00404283(param_1,(char *)_Str,sVar2);
      if (uVar1 == 0) {
        sVar2 = _strlen((char *)_Str);
        puVar3 = (uint *)_malloc(sVar2 + 0x100);
        if (puVar3 == (uint *)0x0) {
          uVar1 = 10;
        }
        else {
          iVar4 = FUN_0040409d(_Str,puVar3,sVar2 + 0x100);
          if (iVar4 == 0) {
            uVar1 = NR_RegDeleteKey(DAT_004120d0,4,(char *)puVar3);
          }
          else {
            uVar1 = 0xb;
          }
          FUN_00404d98((undefined *)puVar3);
        }
        FUN_00404d98((undefined *)_Str);
      }
      else {
        FUN_00404d98((undefined *)_Str);
      }
    }
  }
  return uVar1;
}



Function: VR_EnumUninstall
----------------------------------------

uint __cdecl
VR_EnumUninstall(int *param_1,char *param_2,uint param_3,undefined1 *param_4,uint param_5,
                int param_6)

{
  uint uVar1;
  size_t sVar2;
  int iVar3;
  int unaff_EBX;
  int unaff_ESI;
  undefined4 *puVar4;
  undefined1 local_1014;
  undefined4 local_1013 [512];
  undefined1 local_810;
  undefined4 local_80f [504];
  undefined4 uStackY_2c;
  char *pcVar5;
  
                    /* 0x4832  27  VR_EnumUninstall */
  FUN_00404a80();
  local_810 = 0;
  local_1014 = 0;
  puVar4 = local_80f;
  for (iVar3 = 0x200; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  puVar4 = local_1013;
  for (iVar3 = 0x200; iVar3 != 0; iVar3 = iVar3 + -1) {
    *puVar4 = 0;
    puVar4 = puVar4 + 1;
  }
  uVar1 = FUN_00403a05();
  if (uVar1 == 0) {
    FUN_00404b30((uint *)&local_810,(uint *)s_Mozilla_XPInstall_Uninstall__0040f1d0);
    if (param_6 == 0) {
      pcVar5 = &DAT_00411ec8;
    }
    else {
      pcVar5 = s_Shared_0040f1c8;
    }
    FUN_00404b40((uint *)&local_810,(uint *)pcVar5);
    uVar1 = NR_RegGetKey(DAT_004120d0,4,&local_810,(undefined4 *)&stack0xfffffff8);
    if (uVar1 == 0) {
      *param_2 = '\0';
      local_810 = 0;
      uStackY_2c = 0x4048f7;
      uVar1 = NR_RegEnumSubkeys(DAT_004120d0,unaff_EBX,param_1,&local_810,0x801,0);
      if (uVar1 == 0) {
        if ((param_6 == 0) && (iVar3 = _strcmp(&local_810,&DAT_0040f1c4), iVar3 == 0)) {
          uStackY_2c = 0x404938;
          uVar1 = NR_RegEnumSubkeys(DAT_004120d0,unaff_EBX,param_1,&local_810,0x801,0);
          if (uVar1 != 0) {
            return uVar1;
          }
        }
        uVar1 = NR_RegGetKey(DAT_004120d0,unaff_EBX,&local_810,(undefined4 *)&stack0xfffffff4);
        if (uVar1 == 0) {
          uVar1 = NR_RegGetEntryString
                            (DAT_004120d0,unaff_ESI,s_PackageName_0040f1b8,param_2,param_3);
          if (uVar1 == 0) {
            sVar2 = _strlen(&local_810);
            if ((int)sVar2 < (int)param_5) {
              *param_4 = 0;
              if (param_6 != 0) {
                FUN_00404b30((uint *)&local_1014,(uint *)&DAT_0040f0f4);
                FUN_00404b40((uint *)&local_1014,(uint *)&local_810);
                local_810 = 0;
                uStackY_2c = 0x4049e5;
                FUN_00404b30((uint *)&local_810,(uint *)&local_1014);
              }
              uVar1 = FUN_00404a00(&local_810,(int)param_4,param_5);
              return uVar1;
            }
            uVar1 = 0xb;
          }
          *param_2 = '\0';
        }
      }
    }
  }
  return uVar1;
}



Function: FUN_00404a00
----------------------------------------

undefined4 __cdecl FUN_00404a00(char *param_1,int param_2,uint param_3)

{
  size_t sVar1;
  uint uVar2;
  uint uVar3;
  
  uVar3 = 0;
  uVar2 = 0;
  sVar1 = _strlen(param_1);
  if (sVar1 < param_3) {
    if (sVar1 != 0) {
      do {
        if ((param_1[uVar3] == '_') && (uVar3 != sVar1 - 1)) {
          if (param_1[uVar3 + 1] != '_') {
            if (param_3 - 1 <= uVar2) {
              return 0xb;
            }
            *(undefined1 *)(uVar2 + param_2) = 0x2f;
            goto LAB_00404a5c;
          }
          if (param_3 - 1 <= uVar2) {
            return 0xb;
          }
          *(undefined1 *)(uVar2 + param_2) = 0x5f;
          uVar3 = uVar3 + 2;
        }
        else {
          if (param_3 - 1 <= uVar2) {
            return 0xb;
          }
          *(char *)(uVar2 + param_2) = param_1[uVar3];
LAB_00404a5c:
          uVar3 = uVar3 + 1;
        }
        uVar2 = uVar2 + 1;
      } while (uVar3 < sVar1);
    }
    if (uVar2 < param_3) {
      *(undefined1 *)(uVar2 + param_2) = 0;
      return 0;
    }
  }
  return 0xb;
}



Function: FUN_00404a80
----------------------------------------

/* WARNING: Unable to track spacebase fully for stack */

void FUN_00404a80(void)

{
  uint in_EAX;
  undefined1 *puVar1;
  undefined4 unaff_retaddr;
  
  puVar1 = &stack0x00000004;
  if (0xfff < in_EAX) {
    do {
      puVar1 = puVar1 + -0x1000;
      in_EAX = in_EAX - 0x1000;
    } while (0xfff < in_EAX);
  }
  *(undefined4 *)(puVar1 + (-4 - in_EAX)) = unaff_retaddr;
  return;
}



Function: _strlen
----------------------------------------

/* Library Function - Single Match
    _strlen
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

size_t __cdecl _strlen(char *_Str)

{
  uint uVar1;
  uint *puVar2;
  uint *puVar3;
  
  uVar1 = (uint)_Str & 3;
  puVar2 = (uint *)_Str;
  while (uVar1 != 0) {
    uVar1 = *puVar2;
    puVar2 = (uint *)((int)puVar2 + 1);
    if ((char)uVar1 == '\0') goto LAB_00404b03;
    uVar1 = (uint)puVar2 & 3;
  }
  do {
    do {
      puVar3 = puVar2;
      puVar2 = puVar3 + 1;
    } while (((*puVar3 ^ 0xffffffff ^ *puVar3 + 0x7efefeff) & 0x81010100) == 0);
    uVar1 = *puVar3;
    if ((char)uVar1 == '\0') {
      return (int)puVar3 - (int)_Str;
    }
    if ((char)(uVar1 >> 8) == '\0') {
      return (size_t)((int)puVar3 + (1 - (int)_Str));
    }
    if ((uVar1 & 0xff0000) == 0) {
      return (size_t)((int)puVar3 + (2 - (int)_Str));
    }
  } while ((uVar1 & 0xff000000) != 0);
LAB_00404b03:
  return (size_t)((int)puVar2 + (-1 - (int)_Str));
}



Function: FUN_00404b30
----------------------------------------

uint * __cdecl FUN_00404b30(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint uVar3;
  uint *puVar4;
  
  uVar3 = (uint)param_2 & 3;
  puVar4 = param_1;
  while (uVar3 != 0) {
    bVar1 = (byte)*param_2;
    uVar3 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_00404c18;
    *(byte *)puVar4 = bVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    uVar3 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar3 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar3 == '\0') {
LAB_00404c18:
        *(byte *)puVar4 = (byte)uVar3;
        return param_1;
      }
      if ((char)(uVar3 >> 8) == '\0') {
        *(short *)puVar4 = (short)uVar3;
        return param_1;
      }
      if ((uVar3 & 0xff0000) == 0) {
        *(short *)puVar4 = (short)uVar3;
        *(byte *)((int)puVar4 + 2) = 0;
        return param_1;
      }
      if ((uVar3 & 0xff000000) == 0) {
        *puVar4 = uVar3;
        return param_1;
      }
    }
    *puVar4 = uVar3;
    puVar4 = puVar4 + 1;
  } while( true );
}



Function: FUN_00404b40
----------------------------------------

uint * __cdecl FUN_00404b40(uint *param_1,uint *param_2)

{
  byte bVar1;
  uint uVar2;
  uint *puVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar4 = (uint)param_1 & 3;
  puVar3 = param_1;
  while (uVar4 != 0) {
    uVar4 = *puVar3;
    puVar3 = (uint *)((int)puVar3 + 1);
    if ((byte)uVar4 == 0) goto LAB_00404b8f;
    uVar4 = (uint)puVar3 & 3;
  }
  do {
    do {
      puVar5 = puVar3;
      puVar3 = puVar5 + 1;
    } while (((*puVar5 ^ 0xffffffff ^ *puVar5 + 0x7efefeff) & 0x81010100) == 0);
    uVar4 = *puVar5;
    if ((char)uVar4 == '\0') goto LAB_00404ba1;
    if ((char)(uVar4 >> 8) == '\0') {
      puVar5 = (uint *)((int)puVar5 + 1);
      goto LAB_00404ba1;
    }
    if ((uVar4 & 0xff0000) == 0) {
      puVar5 = (uint *)((int)puVar5 + 2);
      goto LAB_00404ba1;
    }
  } while ((uVar4 & 0xff000000) != 0);
LAB_00404b8f:
  puVar5 = (uint *)((int)puVar3 + -1);
LAB_00404ba1:
  uVar4 = (uint)param_2 & 3;
  while (uVar4 != 0) {
    bVar1 = (byte)*param_2;
    uVar4 = (uint)bVar1;
    param_2 = (uint *)((int)param_2 + 1);
    if (bVar1 == 0) goto LAB_00404c18;
    *(byte *)puVar5 = bVar1;
    puVar5 = (uint *)((int)puVar5 + 1);
    uVar4 = (uint)param_2 & 3;
  }
  do {
    uVar2 = *param_2;
    uVar4 = *param_2;
    param_2 = param_2 + 1;
    if (((uVar2 ^ 0xffffffff ^ uVar2 + 0x7efefeff) & 0x81010100) != 0) {
      if ((char)uVar4 == '\0') {
LAB_00404c18:
        *(byte *)puVar5 = (byte)uVar4;
        return param_1;
      }
      if ((char)(uVar4 >> 8) == '\0') {
        *(short *)puVar5 = (short)uVar4;
        return param_1;
      }
      if ((uVar4 & 0xff0000) == 0) {
        *(short *)puVar5 = (short)uVar4;
        *(byte *)((int)puVar5 + 2) = 0;
        return param_1;
      }
      if ((uVar4 & 0xff000000) == 0) {
        *puVar5 = uVar4;
        return param_1;
      }
    }
    *puVar5 = uVar4;
    puVar5 = puVar5 + 1;
  } while( true );
}



Function: _strrchr
----------------------------------------

/* Library Function - Single Match
    _strrchr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strrchr(char *_Str,int _Ch)

{
  char cVar1;
  int iVar2;
  char *pcVar3;
  char *pcVar4;
  
  iVar2 = -1;
  do {
    pcVar4 = _Str;
    if (iVar2 == 0) break;
    iVar2 = iVar2 + -1;
    pcVar4 = _Str + 1;
    cVar1 = *_Str;
    _Str = pcVar4;
  } while (cVar1 != '\0');
  iVar2 = -(iVar2 + 1);
  pcVar4 = pcVar4 + -1;
  do {
    pcVar3 = pcVar4;
    if (iVar2 == 0) break;
    iVar2 = iVar2 + -1;
    pcVar3 = pcVar4 + -1;
    cVar1 = *pcVar4;
    pcVar4 = pcVar3;
  } while ((char)_Ch != cVar1);
  pcVar3 = pcVar3 + 1;
  if (*pcVar3 != (char)_Ch) {
    pcVar3 = (char *)0x0;
  }
  return pcVar3;
}



Function: entry
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void entry(void)

{
  DWORD DVar1;
  int iVar2;
  UINT UVar3;
  _STARTUPINFOA local_60;
  undefined1 *local_1c;
  _EXCEPTION_POINTERS *local_18;
  void *pvStack_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d160;
  puStack_10 = &LAB_00406884;
  pvStack_14 = ExceptionList;
  local_1c = &stack0xffffff88;
  ExceptionList = &pvStack_14;
  DVar1 = GetVersion();
  _DAT_004120f8 = DVar1 >> 8 & 0xff;
  _DAT_004120f4 = DVar1 & 0xff;
  _DAT_004120f0 = _DAT_004120f4 * 0x100 + _DAT_004120f8;
  _DAT_004120ec = DVar1 >> 0x10;
  iVar2 = FUN_0040672d(1);
  if (iVar2 == 0) {
    FUN_00404d74(0x1c);
  }
  iVar2 = FUN_004064ea();
  if (iVar2 == 0) {
    FUN_00404d74(0x10);
  }
  local_8 = 0;
  FUN_0040632e();
  DAT_004137d8 = GetCommandLineA();
  DAT_004120dc = FUN_004061fc();
  FUN_00405faf();
  FUN_00405ef6();
  FUN_00405c06();
  local_60.dwFlags = 0;
  GetStartupInfoA(&local_60);
  FUN_00405e9e();
  GetModuleHandleA((LPCSTR)0x0);
  UVar3 = FUN_004012a8();
  FUN_00405c33(UVar3);
  FUN_00405d26(local_18->ExceptionRecord->ExceptionCode,local_18);
  return;
}



Function: __amsg_exit
----------------------------------------

/* Library Function - Single Match
    __amsg_exit
   
   Library: Visual Studio 2003 Release */

void __cdecl __amsg_exit(int param_1)

{
  if (DAT_004120e4 == 1) {
    FUN_0040695c();
  }
  FUN_00406995(param_1);
  (*(code *)PTR___exit_0040f200)(0xff);
  return;
}



Function: FUN_00404d74
----------------------------------------

void __cdecl FUN_00404d74(DWORD param_1)

{
  if (DAT_004120e4 == 1) {
    FUN_0040695c();
  }
  FUN_00406995(param_1);
                    /* WARNING: Subroutine does not return */
  ExitProcess(0xff);
}



Function: FUN_00404d98
----------------------------------------

void __cdecl FUN_00404d98(undefined *param_1)

{
  uint *puVar1;
  int local_2c;
  uint *local_28;
  uint local_24;
  uint *local_20;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d170;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  if (param_1 == (undefined *)0x0) {
    return;
  }
  if (DAT_004136a4 == 3) {
    ExceptionList = &local_14;
    FUN_00407d25(9);
    local_8 = 0;
    local_20 = (uint *)FUN_00406b30((int)param_1);
    if (local_20 != (uint *)0x0) {
      FUN_00406b5b(local_20,(int)param_1);
    }
    local_8 = 0xffffffff;
    FUN_00404e02();
    puVar1 = local_20;
  }
  else {
    ExceptionList = &local_14;
    if (DAT_004136a4 != 2) goto LAB_00404e64;
    ExceptionList = &local_14;
    FUN_00407d25(9);
    local_8 = 1;
    local_28 = (uint *)FUN_0040788b(param_1,&local_2c,&local_24);
    if (local_28 != (uint *)0x0) {
      FUN_004078e2(local_2c,local_24,(byte *)local_28);
    }
    local_8 = 0xffffffff;
    FUN_00404e5a();
    puVar1 = local_28;
  }
  if (puVar1 != (uint *)0x0) {
    ExceptionList = local_14;
    return;
  }
LAB_00404e64:
  HeapFree(DAT_004136a0,0,param_1);
  ExceptionList = local_14;
  return;
}



Function: FUN_00404e02
----------------------------------------

void FUN_00404e02(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_00404e5a
----------------------------------------

void FUN_00404e5a(void)

{
  FUN_00407d86(9);
  return;
}



Function: _memset
----------------------------------------

/* Library Function - Single Match
    _memset
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

void * __cdecl _memset(void *_Dst,int _Val,size_t _Size)

{
  uint uVar1;
  uint uVar2;
  size_t sVar3;
  uint *puVar4;
  
  if (_Size == 0) {
    return _Dst;
  }
  uVar1 = _Val & 0xff;
  puVar4 = (uint *)_Dst;
  if (3 < _Size) {
    uVar2 = -(int)_Dst & 3;
    sVar3 = _Size;
    if (uVar2 != 0) {
      sVar3 = _Size - uVar2;
      do {
        *(undefined1 *)puVar4 = (undefined1)_Val;
        puVar4 = (uint *)((int)puVar4 + 1);
        uVar2 = uVar2 - 1;
      } while (uVar2 != 0);
    }
    uVar1 = uVar1 * 0x1010101;
    _Size = sVar3 & 3;
    uVar2 = sVar3 >> 2;
    if (uVar2 != 0) {
      for (; uVar2 != 0; uVar2 = uVar2 - 1) {
        *puVar4 = uVar1;
        puVar4 = puVar4 + 1;
      }
      if (_Size == 0) {
        return _Dst;
      }
    }
  }
  do {
    *(char *)puVar4 = (char)uVar1;
    puVar4 = (uint *)((int)puVar4 + 1);
    _Size = _Size - 1;
  } while (_Size != 0);
  return _Dst;
}



Function: _malloc
----------------------------------------

/* Library Function - Single Match
    _malloc
   
   Library: Visual Studio 2003 Release */

void * __cdecl _malloc(size_t _Size)

{
  void *pvVar1;
  
  pvVar1 = __nh_malloc(_Size,DAT_004122a0);
  return pvVar1;
}



Function: __nh_malloc
----------------------------------------

/* Library Function - Single Match
    __nh_malloc
   
   Library: Visual Studio 2003 Release */

void * __cdecl __nh_malloc(size_t _Size,int _NhFlag)

{
  void *pvVar1;
  int iVar2;
  
  if (_Size < 0xffffffe1) {
    do {
      pvVar1 = (void *)FUN_00404f26((uint *)_Size);
      if (pvVar1 != (void *)0x0) {
        return pvVar1;
      }
      if (_NhFlag == 0) {
        return (void *)0x0;
      }
      iVar2 = FUN_00407d9b(_Size);
    } while (iVar2 != 0);
  }
  return (void *)0x0;
}



Function: FUN_00404f26
----------------------------------------

void __cdecl FUN_00404f26(uint *param_1)

{
  int *piVar1;
  uint dwBytes;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d188;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  if (DAT_004136a4 == 3) {
    ExceptionList = &local_14;
    if (param_1 <= DAT_0041369c) {
      ExceptionList = &local_14;
      FUN_00407d25(9);
      local_8 = 0;
      piVar1 = FUN_00406e84(param_1);
      local_8 = 0xffffffff;
      FUN_00404f8d();
      if (piVar1 != (int *)0x0) {
        ExceptionList = local_14;
        return;
      }
    }
  }
  else {
    ExceptionList = &local_14;
    if (DAT_004136a4 == 2) {
      if (param_1 == (uint *)0x0) {
        dwBytes = 0x10;
      }
      else {
        dwBytes = (int)param_1 + 0xfU & 0xfffffff0;
      }
      ExceptionList = &local_14;
      if (dwBytes <= DAT_004114fc) {
        ExceptionList = &local_14;
        FUN_00407d25(9);
        local_8 = 1;
        piVar1 = FUN_00407927(dwBytes >> 4);
        local_8 = 0xffffffff;
        FUN_00404fec();
        if (piVar1 != (int *)0x0) {
          ExceptionList = local_14;
          return;
        }
      }
      goto LAB_00405005;
    }
  }
  if (param_1 == (uint *)0x0) {
    param_1 = (uint *)0x1;
  }
  dwBytes = (int)param_1 + 0xfU & 0xfffffff0;
LAB_00405005:
  HeapAlloc(DAT_004136a0,0,dwBytes);
  ExceptionList = local_14;
  return;
}



Function: FUN_00404f8d
----------------------------------------

void FUN_00404f8d(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_00404fec
----------------------------------------

void FUN_00404fec(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_00405022
----------------------------------------

void __cdecl FUN_00405022(uint param_1)

{
  DWORD *pDVar1;
  uint *puVar2;
  int iVar3;
  
  pDVar1 = FUN_0040509e();
  iVar3 = 0;
  *pDVar1 = param_1;
  puVar2 = &DAT_0040f210;
  do {
    if (param_1 == *puVar2) {
      pDVar1 = FUN_00405095();
      *pDVar1 = (&DAT_0040f214)[iVar3 * 2];
      return;
    }
    puVar2 = puVar2 + 2;
    iVar3 = iVar3 + 1;
  } while ((int)puVar2 < 0x40f378);
  if ((0x12 < param_1) && (param_1 < 0x25)) {
    pDVar1 = FUN_00405095();
    *pDVar1 = 0xd;
    return;
  }
  if ((0xbb < param_1) && (param_1 < 0xcb)) {
    pDVar1 = FUN_00405095();
    *pDVar1 = 8;
    return;
  }
  pDVar1 = FUN_00405095();
  *pDVar1 = 0x16;
  return;
}



Function: FUN_00405095
----------------------------------------

DWORD * FUN_00405095(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_00406551();
  return pDVar1 + 2;
}



Function: FUN_0040509e
----------------------------------------

DWORD * FUN_0040509e(void)

{
  DWORD *pDVar1;
  
  pDVar1 = FUN_00406551();
  return pDVar1 + 3;
}



Function: FUN_004050a7
----------------------------------------

undefined4 __cdecl FUN_004050a7(FILE *param_1)

{
  undefined4 uVar1;
  
  uVar1 = 0xffffffff;
  if ((param_1->_flag & 0x40) == 0) {
    FUN_00407e72((uint)param_1);
    uVar1 = __fclose_lk(param_1);
    FUN_00407ec4((uint)param_1);
  }
  else {
    param_1->_flag = 0;
  }
  return uVar1;
}



Function: __fclose_lk
----------------------------------------

/* Library Function - Single Match
    __fclose_lk
   
   Library: Visual Studio 2003 Release */

undefined4 __cdecl __fclose_lk(FILE *param_1)

{
  int iVar1;
  undefined4 uVar2;
  
  uVar2 = 0xffffffff;
  if ((param_1->_flag & 0x83) != 0) {
    uVar2 = FUN_004059d1((int *)param_1);
    __freebuf(param_1);
    iVar1 = FUN_00407f16(param_1->_file);
    if (iVar1 < 0) {
      uVar2 = 0xffffffff;
    }
    else if (param_1->_tmpfname != (char *)0x0) {
      FUN_00404d98(param_1->_tmpfname);
      param_1->_tmpfname = (char *)0x0;
    }
  }
  param_1->_flag = 0;
  return uVar2;
}



Function: FUN_00405124
----------------------------------------

uint __cdecl FUN_00405124(char *param_1,uint param_2,uint param_3,int *param_4)

{
  uint uVar1;
  
  FUN_00407e72((uint)param_4);
  uVar1 = FUN_00405153(param_1,param_2,param_3,param_4);
  FUN_00407ec4((uint)param_4);
  return uVar1;
}



Function: FUN_00405153
----------------------------------------

uint __cdecl FUN_00405153(char *param_1,uint param_2,uint param_3,int *param_4)

{
  int *piVar1;
  char *pcVar2;
  int iVar3;
  uint uVar4;
  char *pcVar5;
  char *pcVar6;
  char *pcVar7;
  
  piVar1 = param_4;
  pcVar6 = (char *)(param_2 * param_3);
  if (pcVar6 == (char *)0x0) {
    param_3 = 0;
  }
  else {
    pcVar5 = param_1;
    param_1 = pcVar6;
    if ((*(ushort *)(param_4 + 3) & 0x10c) == 0) {
      param_4 = (int *)0x1000;
    }
    else {
      param_4 = (int *)param_4[6];
    }
    do {
      if (((*(ushort *)(piVar1 + 3) & 0x10c) == 0) ||
         (pcVar2 = (char *)piVar1[1], pcVar2 == (char *)0x0)) {
        if (param_1 < param_4) {
          uVar4 = FUN_00408021(piVar1);
          if (uVar4 == 0xffffffff) goto LAB_0040522f;
          *pcVar5 = (char)uVar4;
          param_4 = (int *)piVar1[6];
          pcVar5 = pcVar5 + 1;
          param_1 = param_1 + -1;
        }
        else {
          pcVar2 = param_1;
          if (param_4 != (int *)0x0) {
            pcVar2 = param_1 + -((uint)param_1 % (uint)param_4);
          }
          iVar3 = FUN_004080fd(piVar1[4],pcVar5,pcVar2);
          if (iVar3 == 0) {
            piVar1[3] = piVar1[3] | 0x10;
LAB_0040522f:
            return (uint)((int)pcVar6 - (int)param_1) / param_2;
          }
          if (iVar3 == -1) {
            piVar1[3] = piVar1[3] | 0x20;
            goto LAB_0040522f;
          }
          param_1 = param_1 + -iVar3;
          pcVar5 = pcVar5 + iVar3;
        }
      }
      else {
        pcVar7 = param_1;
        if (pcVar2 <= param_1) {
          pcVar7 = pcVar2;
        }
        FUN_004055b0((undefined4 *)pcVar5,(undefined4 *)*piVar1,(uint)pcVar7);
        param_1 = param_1 + -(int)pcVar7;
        piVar1[1] = piVar1[1] - (int)pcVar7;
        *piVar1 = (int)(pcVar7 + *piVar1);
        pcVar5 = pcVar5 + (int)pcVar7;
      }
    } while (param_1 != (char *)0x0);
  }
  return param_3;
}



Function: FUN_0040523b
----------------------------------------

int __cdecl FUN_0040523b(int *param_1,int param_2,DWORD param_3)

{
  int iVar1;
  
  FUN_00407e72((uint)param_1);
  iVar1 = FUN_00405267(param_1,param_2,param_3);
  FUN_00407ec4((uint)param_1);
  return iVar1;
}



Function: FUN_00405267
----------------------------------------

int __cdecl FUN_00405267(int *param_1,int param_2,DWORD param_3)

{
  uint uVar1;
  int iVar2;
  DWORD DVar3;
  DWORD *pDVar4;
  
  if (((param_1[3] & 0x83U) == 0) || (((param_3 != 0 && (param_3 != 1)) && (param_3 != 2)))) {
    pDVar4 = FUN_00405095();
    *pDVar4 = 0x16;
    iVar2 = -1;
  }
  else {
    param_1[3] = param_1[3] & 0xffffffef;
    if (param_3 == 1) {
      iVar2 = FUN_00405316((char *)param_1);
      param_2 = param_2 + iVar2;
      param_3 = 0;
    }
    FUN_004059d1(param_1);
    uVar1 = param_1[3];
    if ((uVar1 & 0x80) == 0) {
      if ((((uVar1 & 1) != 0) && ((uVar1 & 8) != 0)) && ((uVar1 & 0x400) == 0)) {
        param_1[6] = 0x200;
      }
    }
    else {
      param_1[3] = uVar1 & 0xfffffffc;
    }
    DVar3 = FUN_0040833b(param_1[4],param_2,param_3);
    iVar2 = (DVar3 != 0xffffffff) - 1;
  }
  return iVar2;
}



Function: FUN_004052f4
----------------------------------------

int __cdecl FUN_004052f4(char *param_1)

{
  int iVar1;
  
  FUN_00407e72((uint)param_1);
  iVar1 = FUN_00405316(param_1);
  FUN_00407ec4((uint)param_1);
  return iVar1;
}



Function: FUN_00405316
----------------------------------------

int __cdecl FUN_00405316(char *param_1)

{
  uint uVar1;
  uint uVar2;
  byte bVar3;
  DWORD *pDVar4;
  char *pcVar5;
  DWORD DVar6;
  char *pcVar7;
  char *pcVar8;
  char *pcVar9;
  int iVar10;
  int local_c;
  DWORD local_8;
  
  pcVar8 = param_1;
  uVar1 = *(uint *)(param_1 + 0x10);
  if (*(int *)(param_1 + 4) < 0) {
    param_1[4] = '\0';
    param_1[5] = '\0';
    param_1[6] = '\0';
    param_1[7] = '\0';
  }
  local_8 = FUN_0040833b(uVar1,0,1);
  if ((int)local_8 < 0) {
LAB_004053a4:
    local_c = -1;
  }
  else {
    uVar2 = *(uint *)(param_1 + 0xc);
    if ((uVar2 & 0x108) == 0) {
      return local_8 - *(int *)(param_1 + 4);
    }
    pcVar5 = *(char **)param_1;
    pcVar7 = *(char **)(param_1 + 8);
    local_c = (int)pcVar5 - (int)pcVar7;
    if ((uVar2 & 3) == 0) {
      if ((uVar2 & 0x80) == 0) {
        pDVar4 = FUN_00405095();
        *pDVar4 = 0x16;
        goto LAB_004053a4;
      }
    }
    else {
      pcVar9 = pcVar7;
      if ((*(byte *)((&DAT_004136c0)[(int)uVar1 >> 5] + 4 + (uVar1 & 0x1f) * 0x24) & 0x80) != 0) {
        for (; pcVar9 < pcVar5; pcVar9 = pcVar9 + 1) {
          if (*pcVar9 == '\n') {
            local_c = local_c + 1;
          }
        }
      }
    }
    if (local_8 != 0) {
      if ((param_1[0xc] & 1U) != 0) {
        if (*(int *)(param_1 + 4) == 0) {
          local_c = 0;
        }
        else {
          pcVar5 = pcVar5 + (*(int *)(param_1 + 4) - (int)pcVar7);
          iVar10 = (uVar1 & 0x1f) * 0x24;
          if ((*(byte *)(iVar10 + 4 + (&DAT_004136c0)[(int)uVar1 >> 5]) & 0x80) != 0) {
            DVar6 = FUN_0040833b(uVar1,0,2);
            if (DVar6 == local_8) {
              pcVar7 = *(char **)(param_1 + 8);
              pcVar9 = pcVar5 + (int)pcVar7;
              param_1 = pcVar5;
              for (; pcVar7 < pcVar9; pcVar7 = pcVar7 + 1) {
                if (*pcVar7 == '\n') {
                  param_1 = param_1 + 1;
                }
              }
              bVar3 = pcVar8[0xd] & 0x20;
            }
            else {
              FUN_0040833b(uVar1,local_8,0);
              pcVar8 = (char *)0x200;
              if ((((char *)0x200 < pcVar5) || ((*(uint *)(param_1 + 0xc) & 8) == 0)) ||
                 ((*(uint *)(param_1 + 0xc) & 0x400) != 0)) {
                pcVar8 = *(char **)(param_1 + 0x18);
              }
              bVar3 = *(byte *)(iVar10 + 4 + (&DAT_004136c0)[(int)uVar1 >> 5]) & 4;
              param_1 = pcVar8;
            }
            pcVar5 = param_1;
            if (bVar3 != 0) {
              pcVar5 = param_1 + 1;
            }
          }
          param_1 = pcVar5;
          local_8 = local_8 - (int)param_1;
        }
      }
      local_c = local_c + local_8;
    }
  }
  return local_c;
}



Function: FUN_00405477
----------------------------------------

uint __cdecl FUN_00405477(char *param_1,uint param_2,uint param_3,int *param_4)

{
  uint uVar1;
  
  FUN_00407e72((uint)param_4);
  uVar1 = FUN_004054a6(param_1,param_2,param_3,param_4);
  FUN_00407ec4((uint)param_4);
  return uVar1;
}



Function: FUN_004054a6
----------------------------------------

uint __cdecl FUN_004054a6(char *param_1,uint param_2,uint param_3,int *param_4)

{
  int *piVar1;
  int iVar2;
  int *piVar3;
  uint uVar4;
  int *piVar5;
  int *piVar6;
  int *piVar7;
  
  piVar1 = param_4;
  piVar6 = (int *)(param_2 * param_3);
  if (piVar6 == (int *)0x0) {
    param_3 = 0;
  }
  else {
    piVar5 = piVar6;
    if ((*(ushort *)(param_4 + 3) & 0x10c) == 0) {
      param_4 = (int *)0x1000;
    }
    else {
      param_4 = (int *)param_4[6];
    }
    do {
      if (((piVar1[3] & 0x108U) == 0) || (piVar7 = (int *)piVar1[1], piVar7 == (int *)0x0)) {
        if (param_4 <= piVar5) {
          if (((piVar1[3] & 0x108U) != 0) && (iVar2 = FUN_004059d1(piVar1), iVar2 != 0)) {
LAB_004055a7:
            return (uint)((int)piVar6 - (int)piVar5) / param_2;
          }
          piVar7 = piVar5;
          if (param_4 != (int *)0x0) {
            piVar7 = (int *)((int)piVar5 - (uint)piVar5 % (uint)param_4);
          }
          piVar3 = (int *)FUN_0040852b(piVar1[4],param_1,(uint)piVar7);
          if ((piVar3 == (int *)0xffffffff) ||
             (piVar5 = (int *)((int)piVar5 - (int)piVar3), piVar3 < piVar7)) {
            piVar1[3] = piVar1[3] | 0x20;
            goto LAB_004055a7;
          }
          goto LAB_0040555e;
        }
        uVar4 = FUN_00408413((int)*param_1,piVar1);
        if (uVar4 == 0xffffffff) goto LAB_004055a7;
        param_1 = param_1 + 1;
        param_4 = (int *)piVar1[6];
        piVar5 = (int *)((int)piVar5 - 1);
        if ((int)param_4 < 1) {
          param_4 = (int *)0x1;
        }
      }
      else {
        piVar3 = piVar5;
        if (piVar7 <= piVar5) {
          piVar3 = piVar7;
        }
        FUN_004055b0((undefined4 *)*piVar1,(undefined4 *)param_1,(uint)piVar3);
        piVar1[1] = piVar1[1] - (int)piVar3;
        *piVar1 = *piVar1 + (int)piVar3;
        piVar5 = (int *)((int)piVar5 - (int)piVar3);
LAB_0040555e:
        param_1 = param_1 + (int)piVar3;
      }
    } while (piVar5 != (int *)0x0);
  }
  return param_3;
}



Function: FUN_004055b0
----------------------------------------

undefined4 * __cdecl FUN_004055b0(undefined4 *param_1,undefined4 *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((param_2 < param_1) && (param_1 < (undefined4 *)(param_3 + (int)param_2))) {
    puVar3 = (undefined4 *)((param_3 - 4) + (int)param_2);
    puVar4 = (undefined4 *)((param_3 - 4) + (int)param_1);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = param_3 >> 2;
      uVar2 = param_3 & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return param_1;
        case 2:
          goto switchD_00405767_caseD_2;
        case 3:
          goto switchD_00405767_caseD_3;
        }
        goto switchD_00405767_caseD_1;
      }
    }
    else {
      switch(param_3) {
      case 0:
        goto switchD_00405767_caseD_0;
      case 1:
        goto switchD_00405767_caseD_1;
      case 2:
        goto switchD_00405767_caseD_2;
      case 3:
        goto switchD_00405767_caseD_3;
      default:
        uVar1 = param_3 - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_00405767_caseD_2;
            case 3:
              goto switchD_00405767_caseD_3;
            }
            goto switchD_00405767_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_00405767_caseD_2;
            case 3:
              goto switchD_00405767_caseD_3;
            }
            goto switchD_00405767_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_00405767_caseD_2;
            case 3:
              goto switchD_00405767_caseD_3;
            }
            goto switchD_00405767_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_00405767_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return param_1;
    case 2:
switchD_00405767_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return param_1;
    case 3:
switchD_00405767_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return param_1;
    }
switchD_00405767_caseD_0:
    return param_1;
  }
  puVar3 = param_1;
  if (((uint)param_1 & 3) == 0) {
    uVar1 = param_3 >> 2;
    uVar2 = param_3 & 3;
    if (7 < uVar1) {
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *param_2;
        param_2 = param_2 + 1;
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return param_1;
      case 2:
        goto switchD_004055e5_caseD_2;
      case 3:
        goto switchD_004055e5_caseD_3;
      }
      goto switchD_004055e5_caseD_1;
    }
  }
  else {
    switch(param_3) {
    case 0:
      goto switchD_004055e5_caseD_0;
    case 1:
      goto switchD_004055e5_caseD_1;
    case 2:
      goto switchD_004055e5_caseD_2;
    case 3:
      goto switchD_004055e5_caseD_3;
    default:
      uVar1 = (param_3 - 4) + ((uint)param_1 & 3);
      switch((uint)param_1 & 3) {
      case 1:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 2) = *(undefined1 *)((int)param_2 + 2);
        param_2 = (undefined4 *)((int)param_2 + 3);
        puVar3 = (undefined4 *)((int)param_1 + 3);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_004055e5_caseD_2;
          case 3:
            goto switchD_004055e5_caseD_3;
          }
          goto switchD_004055e5_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        param_2 = (undefined4 *)((int)param_2 + 2);
        puVar3 = (undefined4 *)((int)param_1 + 2);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_004055e5_caseD_2;
          case 3:
            goto switchD_004055e5_caseD_3;
          }
          goto switchD_004055e5_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        param_2 = (undefined4 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)param_1 + 1);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_004055e5_caseD_2;
          case 3:
            goto switchD_004055e5_caseD_3;
          }
          goto switchD_004055e5_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = param_2[uVar1 - 7];
  case 6:
    puVar3[uVar1 - 6] = param_2[uVar1 - 6];
  case 5:
    puVar3[uVar1 - 5] = param_2[uVar1 - 5];
  case 4:
    puVar3[uVar1 - 4] = param_2[uVar1 - 4];
  case 3:
    puVar3[uVar1 - 3] = param_2[uVar1 - 3];
  case 2:
    puVar3[uVar1 - 2] = param_2[uVar1 - 2];
  case 1:
    puVar3[uVar1 - 1] = param_2[uVar1 - 1];
    param_2 = param_2 + uVar1;
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_004055e5_caseD_1:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    return param_1;
  case 2:
switchD_004055e5_caseD_2:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    return param_1;
  case 3:
switchD_004055e5_caseD_3:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)param_2 + 2);
    return param_1;
  }
switchD_004055e5_caseD_0:
  return param_1;
}



Function: _strcmp
----------------------------------------

/* Library Function - Single Match
    _strcmp
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

int __cdecl _strcmp(char *_Str1,char *_Str2)

{
  undefined2 uVar1;
  undefined4 uVar2;
  byte bVar3;
  byte bVar4;
  bool bVar5;
  
  if (((uint)_Str1 & 3) != 0) {
    if (((uint)_Str1 & 1) != 0) {
      bVar4 = *_Str1;
      _Str1 = _Str1 + 1;
      bVar5 = bVar4 < (byte)*_Str2;
      if (bVar4 != *_Str2) goto LAB_00405934;
      _Str2 = _Str2 + 1;
      if (bVar4 == 0) {
        return 0;
      }
      if (((uint)_Str1 & 2) == 0) goto LAB_00405900;
    }
    uVar1 = *(undefined2 *)_Str1;
    _Str1 = _Str1 + 2;
    bVar4 = (byte)uVar1;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) goto LAB_00405934;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((ushort)uVar1 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) goto LAB_00405934;
    if (bVar4 == 0) {
      return 0;
    }
    _Str2 = (char *)((byte *)_Str2 + 2);
  }
LAB_00405900:
  while( true ) {
    uVar2 = *(undefined4 *)_Str1;
    bVar4 = (byte)uVar2;
    bVar5 = bVar4 < (byte)*_Str2;
    if (bVar4 != *_Str2) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 8);
    bVar5 = bVar4 < ((byte *)_Str2)[1];
    if (bVar4 != ((byte *)_Str2)[1]) break;
    if (bVar4 == 0) {
      return 0;
    }
    bVar4 = (byte)((uint)uVar2 >> 0x10);
    bVar5 = bVar4 < ((byte *)_Str2)[2];
    if (bVar4 != ((byte *)_Str2)[2]) break;
    bVar3 = (byte)((uint)uVar2 >> 0x18);
    if (bVar4 == 0) {
      return 0;
    }
    bVar5 = bVar3 < ((byte *)_Str2)[3];
    if (bVar3 != ((byte *)_Str2)[3]) break;
    _Str2 = (char *)((byte *)_Str2 + 4);
    _Str1 = _Str1 + 4;
    if (bVar3 == 0) {
      return 0;
    }
  }
LAB_00405934:
  return (uint)bVar5 * -2 + 1;
}



Function: FUN_00405974
----------------------------------------

int __cdecl FUN_00405974(int *param_1)

{
  int iVar1;
  
  if (param_1 == (int *)0x0) {
    iVar1 = FUN_00405a36(0);
    return iVar1;
  }
  FUN_00407e72((uint)param_1);
  iVar1 = FUN_004059a3(param_1);
  FUN_00407ec4((uint)param_1);
  return iVar1;
}



Function: FUN_004059a3
----------------------------------------

int __cdecl FUN_004059a3(int *param_1)

{
  int iVar1;
  DWORD DVar2;
  
  iVar1 = FUN_004059d1(param_1);
  if (iVar1 != 0) {
    return -1;
  }
  if ((*(byte *)((int)param_1 + 0xd) & 0x40) != 0) {
    DVar2 = FUN_0040871b(param_1[4]);
    return -(uint)(DVar2 != 0);
  }
  return 0;
}



Function: FUN_004059d1
----------------------------------------

undefined4 __cdecl FUN_004059d1(int *param_1)

{
  uint uVar1;
  undefined4 uVar2;
  uint uVar3;
  
  uVar2 = 0;
  if ((((byte)param_1[3] & 3) == 2) && ((param_1[3] & 0x108U) != 0)) {
    uVar3 = *param_1 - param_1[2];
    if (0 < (int)uVar3) {
      uVar1 = FUN_0040852b(param_1[4],(char *)param_1[2],uVar3);
      if (uVar1 == uVar3) {
        if ((param_1[3] & 0x80U) != 0) {
          param_1[3] = param_1[3] & 0xfffffffd;
        }
      }
      else {
        param_1[3] = param_1[3] | 0x20;
        uVar2 = 0xffffffff;
      }
    }
  }
  param_1[1] = 0;
  *param_1 = param_1[2];
  return uVar2;
}



Function: FUN_00405a36
----------------------------------------

int __cdecl FUN_00405a36(int param_1)

{
  int *piVar1;
  int iVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  
  iVar3 = 0;
  iVar5 = 0;
  FUN_00407d25(2);
  iVar4 = 0;
  if (0 < DAT_00413680) {
    do {
      iVar2 = *(int *)(DAT_00412668 + iVar4 * 4);
      if ((iVar2 != 0) && ((*(byte *)(iVar2 + 0xc) & 0x83) != 0)) {
        FUN_00407ea1(iVar4,iVar2);
        piVar1 = *(int **)(DAT_00412668 + iVar4 * 4);
        if ((piVar1[3] & 0x83U) != 0) {
          if (param_1 == 1) {
            iVar2 = FUN_004059a3(piVar1);
            if (iVar2 != -1) {
              iVar3 = iVar3 + 1;
            }
          }
          else if ((param_1 == 0) && ((piVar1[3] & 2U) != 0)) {
            iVar2 = FUN_004059a3(piVar1);
            if (iVar2 == -1) {
              iVar5 = -1;
            }
          }
        }
        FUN_00407ef3(iVar4,*(int *)(DAT_00412668 + iVar4 * 4));
      }
      iVar4 = iVar4 + 1;
    } while (iVar4 < DAT_00413680);
  }
  FUN_00407d86(2);
  if (param_1 != 1) {
    iVar3 = iVar5;
  }
  return iVar3;
}



Function: FUN_00405ada
----------------------------------------

undefined4 * FUN_00405ada(LPCSTR param_1,char *param_2,uint param_3)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  
  puVar1 = FUN_0040891e();
  if (puVar1 == (undefined4 *)0x0) {
    return (undefined4 *)0x0;
  }
  puVar2 = FUN_004087ae(param_1,param_2,param_3,puVar1);
  FUN_00407ec4((uint)puVar1);
  return puVar2;
}



Function: FUN_00405b0b
----------------------------------------

void __cdecl FUN_00405b0b(undefined4 param_1,undefined4 param_2)

{
  FUN_00405ada(param_1,param_2,0x40);
  return;
}



Function: FUN_00405b1e
----------------------------------------

int __cdecl FUN_00405b1e(undefined1 *param_1,byte *param_2)

{
  int iVar1;
  undefined1 *local_24;
  int local_20;
  undefined1 *local_1c;
  undefined4 local_18;
  
  local_1c = param_1;
  local_24 = param_1;
  local_18 = 0x42;
  local_20 = 0x7fffffff;
  iVar1 = FUN_004089e6((int *)&local_24,param_2,(undefined4 *)&stack0x0000000c);
  local_20 = local_20 + -1;
  if (local_20 < 0) {
    FUN_00408413(0,(int *)&local_24);
  }
  else {
    *local_24 = 0;
  }
  return iVar1;
}



Function: FUN_00405b70
----------------------------------------

int __thiscall FUN_00405b70(void *this,byte *param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  byte *pbVar5;
  undefined *puVar6;
  
  while( true ) {
    if (DAT_00411a54 < 2) {
      uVar1 = (byte)PTR_DAT_00411848[(uint)*param_1 * 2] & 8;
      this = PTR_DAT_00411848;
    }
    else {
      puVar6 = (undefined *)0x8;
      uVar1 = FUN_004091f0(this,(uint)*param_1,8);
      this = puVar6;
    }
    if (uVar1 == 0) break;
    param_1 = param_1 + 1;
  }
  uVar1 = (uint)*param_1;
  pbVar5 = param_1 + 1;
  if ((uVar1 == 0x2d) || (uVar4 = uVar1, uVar1 == 0x2b)) {
    uVar4 = (uint)*pbVar5;
    pbVar5 = param_1 + 2;
  }
  iVar3 = 0;
  while( true ) {
    if (DAT_00411a54 < 2) {
      uVar2 = (byte)PTR_DAT_00411848[uVar4 * 2] & 4;
    }
    else {
      puVar6 = (undefined *)0x4;
      uVar2 = FUN_004091f0(this,uVar4,4);
      this = puVar6;
    }
    if (uVar2 == 0) break;
    iVar3 = (uVar4 - 0x30) + iVar3 * 10;
    uVar4 = (uint)*pbVar5;
    pbVar5 = pbVar5 + 1;
  }
  if (uVar1 == 0x2d) {
    iVar3 = -iVar3;
  }
  return iVar3;
}



Function: FUN_00405bfb
----------------------------------------

void __thiscall FUN_00405bfb(void *this,byte *param_1)

{
  FUN_00405b70(this,param_1);
  return;
}



Function: FUN_00405c06
----------------------------------------

void FUN_00405c06(void)

{
  if (DAT_004137d4 != (code *)0x0) {
    (*DAT_004137d4)();
  }
  FUN_00405d0c((undefined4 *)&DAT_0040f008,(undefined4 *)&DAT_0040f014);
  FUN_00405d0c((undefined4 *)&DAT_0040f000,(undefined4 *)&DAT_0040f004);
  return;
}



Function: FUN_00405c33
----------------------------------------

void __cdecl FUN_00405c33(UINT param_1)

{
  FUN_00405c55(param_1,0,0);
  return;
}



Function: __exit
----------------------------------------

/* Library Function - Single Match
    __exit
   
   Library: Visual Studio 2003 Release */

void __cdecl __exit(int _Code)

{
  FUN_00405c55(_Code,1,0);
  return;
}



Function: FUN_00405c55
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_00405c55(UINT param_1,int param_2,int param_3)

{
  HANDLE hProcess;
  undefined4 *puVar1;
  UINT uExitCode;
  
  FUN_00405cfa();
  if (DAT_00412128 == 1) {
    uExitCode = param_1;
    hProcess = GetCurrentProcess();
    TerminateProcess(hProcess,uExitCode);
  }
  _DAT_00412124 = 1;
  DAT_00412120 = (undefined1)param_3;
  if (param_2 == 0) {
    if ((DAT_004137d0 != (undefined4 *)0x0) &&
       (puVar1 = (undefined4 *)(DAT_004137cc - 4), DAT_004137d0 <= puVar1)) {
      do {
        if ((code *)*puVar1 != (code *)0x0) {
          (*(code *)*puVar1)();
        }
        puVar1 = puVar1 + -1;
      } while (DAT_004137d0 <= puVar1);
    }
    FUN_00405d0c((undefined4 *)&DAT_0040f018,(undefined4 *)&DAT_0040f020);
  }
  FUN_00405d0c((undefined4 *)&DAT_0040f024,(undefined4 *)&DAT_0040f028);
  if (param_3 == 0) {
    DAT_00412128 = 1;
                    /* WARNING: Subroutine does not return */
    ExitProcess(param_1);
  }
  FUN_00405d03();
  return;
}



Function: FUN_00405cfa
----------------------------------------

void FUN_00405cfa(void)

{
  FUN_00407d25(0xd);
  return;
}



Function: FUN_00405d03
----------------------------------------

void FUN_00405d03(void)

{
  FUN_00407d86(0xd);
  return;
}



Function: FUN_00405d0c
----------------------------------------

void __cdecl FUN_00405d0c(undefined4 *param_1,undefined4 *param_2)

{
  for (; param_1 < param_2; param_1 = param_1 + 1) {
    if ((code *)*param_1 != (code *)0x0) {
      (*(code *)*param_1)();
    }
  }
  return;
}



Function: FUN_00405d26
----------------------------------------

LONG __cdecl FUN_00405d26(int param_1,_EXCEPTION_POINTERS *param_2)

{
  code *pcVar1;
  DWORD DVar2;
  DWORD DVar3;
  DWORD *pDVar4;
  int *piVar5;
  LONG LVar6;
  int iVar7;
  int iVar8;
  
  pDVar4 = FUN_00406551();
  piVar5 = FUN_00405e64(param_1,(int *)pDVar4[0x14]);
  if ((piVar5 == (int *)0x0) || (pcVar1 = (code *)piVar5[2], pcVar1 == (code *)0x0)) {
    LVar6 = UnhandledExceptionFilter(param_2);
  }
  else if (pcVar1 == (code *)0x5) {
    piVar5[2] = 0;
    LVar6 = 1;
  }
  else {
    if (pcVar1 != (code *)0x1) {
      DVar2 = pDVar4[0x15];
      pDVar4[0x15] = (DWORD)param_2;
      if (piVar5[1] == 8) {
        if (DAT_0040f3f8 < DAT_0040f3fc + DAT_0040f3f8) {
          iVar7 = DAT_0040f3f8 * 0xc;
          iVar8 = DAT_0040f3f8;
          do {
            *(undefined4 *)(iVar7 + 8 + pDVar4[0x14]) = 0;
            iVar8 = iVar8 + 1;
            iVar7 = iVar7 + 0xc;
          } while (iVar8 < DAT_0040f3fc + DAT_0040f3f8);
        }
        iVar7 = *piVar5;
        DVar3 = pDVar4[0x16];
        if (iVar7 == -0x3fffff72) {
          pDVar4[0x16] = 0x83;
        }
        else if (iVar7 == -0x3fffff70) {
          pDVar4[0x16] = 0x81;
        }
        else if (iVar7 == -0x3fffff6f) {
          pDVar4[0x16] = 0x84;
        }
        else if (iVar7 == -0x3fffff6d) {
          pDVar4[0x16] = 0x85;
        }
        else if (iVar7 == -0x3fffff73) {
          pDVar4[0x16] = 0x82;
        }
        else if (iVar7 == -0x3fffff71) {
          pDVar4[0x16] = 0x86;
        }
        else if (iVar7 == -0x3fffff6e) {
          pDVar4[0x16] = 0x8a;
        }
        (*pcVar1)(8,pDVar4[0x16]);
        pDVar4[0x16] = DVar3;
      }
      else {
        piVar5[2] = 0;
        (*pcVar1)(piVar5[1]);
      }
      pDVar4[0x15] = DVar2;
    }
    LVar6 = -1;
  }
  return LVar6;
}



Function: FUN_00405e64
----------------------------------------

int * __cdecl FUN_00405e64(int param_1,int *param_2)

{
  int *piVar1;
  
  piVar1 = param_2;
  if (*param_2 != param_1) {
    do {
      piVar1 = piVar1 + 3;
      if (param_2 + DAT_0040f404 * 3 <= piVar1) break;
    } while (*piVar1 != param_1);
  }
  if ((param_2 + DAT_0040f404 * 3 <= piVar1) || (*piVar1 != param_1)) {
    piVar1 = (int *)0x0;
  }
  return piVar1;
}



Function: FUN_00405e9e
----------------------------------------

byte * FUN_00405e9e(void)

{
  byte bVar1;
  int iVar2;
  byte *pbVar3;
  byte *pbVar4;
  
  if (DAT_004137c8 == 0) {
    FUN_004096be();
  }
  bVar1 = *DAT_004137d8;
  pbVar4 = DAT_004137d8;
  if (bVar1 == 0x22) {
    while( true ) {
      pbVar3 = pbVar4;
      bVar1 = pbVar3[1];
      pbVar4 = pbVar3 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      iVar2 = FUN_004092a4((uint)bVar1);
      if (iVar2 != 0) {
        pbVar4 = pbVar3 + 2;
      }
    }
    if (*pbVar4 == 0x22) goto LAB_00405edb;
  }
  else {
    while (0x20 < bVar1) {
      bVar1 = pbVar4[1];
      pbVar4 = pbVar4 + 1;
    }
  }
  for (; (*pbVar4 != 0 && (*pbVar4 < 0x21)); pbVar4 = pbVar4 + 1) {
LAB_00405edb:
  }
  return pbVar4;
}



Function: FUN_00405ef6
----------------------------------------

void FUN_00405ef6(void)

{
  char cVar1;
  size_t sVar2;
  undefined4 *puVar3;
  void *pvVar4;
  int iVar5;
  uint *puVar6;
  
  if (DAT_004137c8 == 0) {
    FUN_004096be();
  }
  iVar5 = 0;
  for (puVar6 = DAT_004120dc; (char)*puVar6 != '\0'; puVar6 = (uint *)((int)puVar6 + sVar2 + 1)) {
    if ((char)*puVar6 != '=') {
      iVar5 = iVar5 + 1;
    }
    sVar2 = _strlen((char *)puVar6);
  }
  puVar3 = (undefined4 *)_malloc(iVar5 * 4 + 4);
  DAT_00412108 = puVar3;
  if (puVar3 == (undefined4 *)0x0) {
    __amsg_exit(9);
  }
  cVar1 = (char)*DAT_004120dc;
  puVar6 = DAT_004120dc;
  while (cVar1 != '\0') {
    sVar2 = _strlen((char *)puVar6);
    if ((char)*puVar6 != '=') {
      pvVar4 = _malloc(sVar2 + 1);
      *puVar3 = pvVar4;
      if (pvVar4 == (void *)0x0) {
        __amsg_exit(9);
      }
      FUN_00404b30((uint *)*puVar3,puVar6);
      puVar3 = puVar3 + 1;
    }
    puVar6 = (uint *)((int)puVar6 + sVar2 + 1);
    cVar1 = (char)*puVar6;
  }
  FUN_00404d98((undefined *)DAT_004120dc);
  DAT_004120dc = (uint *)0x0;
  *puVar3 = 0;
  DAT_004137c4 = 1;
  return;
}



Function: FUN_00405faf
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_00405faf(void)

{
  undefined4 *puVar1;
  byte *pbVar2;
  int local_c;
  int local_8;
  
  if (DAT_004137c8 == 0) {
    FUN_004096be();
  }
  GetModuleFileNameA((HMODULE)0x0,&DAT_0041212c,0x104);
  _DAT_00412118 = &DAT_0041212c;
  pbVar2 = &DAT_0041212c;
  if (*DAT_004137d8 != 0) {
    pbVar2 = DAT_004137d8;
  }
  FUN_00406048(pbVar2,(undefined4 *)0x0,(byte *)0x0,&local_8,&local_c);
  puVar1 = (undefined4 *)_malloc(local_c + local_8 * 4);
  if (puVar1 == (undefined4 *)0x0) {
    __amsg_exit(8);
  }
  FUN_00406048(pbVar2,puVar1,(byte *)(puVar1 + local_8),&local_8,&local_c);
  _DAT_00412100 = puVar1;
  _DAT_004120fc = local_8 + -1;
  return;
}



Function: FUN_00406048
----------------------------------------

void __cdecl FUN_00406048(byte *param_1,undefined4 *param_2,byte *param_3,int *param_4,int *param_5)

{
  byte bVar1;
  bool bVar2;
  bool bVar3;
  byte *pbVar4;
  byte *pbVar5;
  uint uVar6;
  undefined4 *puVar7;
  
  *param_5 = 0;
  *param_4 = 1;
  if (param_2 != (undefined4 *)0x0) {
    *param_2 = param_3;
    param_2 = param_2 + 1;
  }
  if (*param_1 == 0x22) {
    while( true ) {
      bVar1 = param_1[1];
      pbVar4 = param_1 + 1;
      if ((bVar1 == 0x22) || (bVar1 == 0)) break;
      if ((((&DAT_00412561)[bVar1] & 4) != 0) && (*param_5 = *param_5 + 1, param_3 != (byte *)0x0))
      {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
        pbVar4 = param_1 + 2;
      }
      *param_5 = *param_5 + 1;
      param_1 = pbVar4;
      if (param_3 != (byte *)0x0) {
        *param_3 = *pbVar4;
        param_3 = param_3 + 1;
      }
    }
    *param_5 = *param_5 + 1;
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    if (*pbVar4 == 0x22) {
      pbVar4 = param_1 + 2;
    }
  }
  else {
    do {
      *param_5 = *param_5 + 1;
      if (param_3 != (byte *)0x0) {
        *param_3 = *param_1;
        param_3 = param_3 + 1;
      }
      bVar1 = *param_1;
      pbVar4 = param_1 + 1;
      if (((&DAT_00412561)[bVar1] & 4) != 0) {
        *param_5 = *param_5 + 1;
        if (param_3 != (byte *)0x0) {
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        pbVar4 = param_1 + 2;
      }
      if (bVar1 == 0x20) break;
      if (bVar1 == 0) goto LAB_004060f3;
      param_1 = pbVar4;
    } while (bVar1 != 9);
    if (bVar1 == 0) {
LAB_004060f3:
      pbVar4 = pbVar4 + -1;
    }
    else if (param_3 != (byte *)0x0) {
      param_3[-1] = 0;
    }
  }
  bVar2 = false;
  puVar7 = param_2;
  while (*pbVar4 != 0) {
    for (; (*pbVar4 == 0x20 || (*pbVar4 == 9)); pbVar4 = pbVar4 + 1) {
    }
    if (*pbVar4 == 0) break;
    if (puVar7 != (undefined4 *)0x0) {
      *puVar7 = param_3;
      puVar7 = puVar7 + 1;
      param_2 = puVar7;
    }
    *param_4 = *param_4 + 1;
    while( true ) {
      bVar3 = true;
      uVar6 = 0;
      for (; *pbVar4 == 0x5c; pbVar4 = pbVar4 + 1) {
        uVar6 = uVar6 + 1;
      }
      if (*pbVar4 == 0x22) {
        pbVar5 = pbVar4;
        if ((uVar6 & 1) == 0) {
          if ((!bVar2) || (pbVar5 = pbVar4 + 1, pbVar4[1] != 0x22)) {
            bVar3 = false;
            pbVar5 = pbVar4;
          }
          bVar2 = !bVar2;
          puVar7 = param_2;
        }
        uVar6 = uVar6 >> 1;
        pbVar4 = pbVar5;
      }
      for (; uVar6 != 0; uVar6 = uVar6 - 1) {
        if (param_3 != (byte *)0x0) {
          *param_3 = 0x5c;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      bVar1 = *pbVar4;
      if ((bVar1 == 0) || ((!bVar2 && ((bVar1 == 0x20 || (bVar1 == 9)))))) break;
      if (bVar3) {
        if (param_3 == (byte *)0x0) {
          if (((&DAT_00412561)[bVar1] & 4) != 0) {
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
        }
        else {
          if (((&DAT_00412561)[bVar1] & 4) != 0) {
            *param_3 = bVar1;
            param_3 = param_3 + 1;
            pbVar4 = pbVar4 + 1;
            *param_5 = *param_5 + 1;
          }
          *param_3 = *pbVar4;
          param_3 = param_3 + 1;
        }
        *param_5 = *param_5 + 1;
      }
      pbVar4 = pbVar4 + 1;
    }
    if (param_3 != (byte *)0x0) {
      *param_3 = 0;
      param_3 = param_3 + 1;
    }
    *param_5 = *param_5 + 1;
  }
  if (puVar7 != (undefined4 *)0x0) {
    *puVar7 = 0;
  }
  *param_4 = *param_4 + 1;
  return;
}



Function: FUN_004061fc
----------------------------------------

LPSTR FUN_004061fc(void)

{
  char cVar1;
  WCHAR WVar2;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  int iVar5;
  size_t _Size;
  LPSTR pCVar6;
  char *pcVar7;
  LPWCH lpWideCharStr;
  LPCH pCVar9;
  LPSTR local_8;
  char *pcVar8;
  
  lpWideCharStr = (LPWCH)0x0;
  pCVar9 = (LPCH)0x0;
  if (DAT_00412230 == 0) {
    lpWideCharStr = GetEnvironmentStringsW();
    if (lpWideCharStr != (LPWCH)0x0) {
      DAT_00412230 = 1;
LAB_00406253:
      if ((lpWideCharStr == (LPWCH)0x0) &&
         (lpWideCharStr = GetEnvironmentStringsW(), lpWideCharStr == (LPWCH)0x0)) {
        return (LPSTR)0x0;
      }
      WVar2 = *lpWideCharStr;
      pWVar4 = lpWideCharStr;
      while (WVar2 != L'\0') {
        do {
          pWVar3 = pWVar4;
          pWVar4 = pWVar3 + 1;
        } while (*pWVar4 != L'\0');
        pWVar4 = pWVar3 + 2;
        WVar2 = *pWVar4;
      }
      iVar5 = ((int)pWVar4 - (int)lpWideCharStr >> 1) + 1;
      _Size = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
      local_8 = (LPSTR)0x0;
      if (((_Size != 0) && (pCVar6 = (LPSTR)_malloc(_Size), pCVar6 != (LPSTR)0x0)) &&
         (iVar5 = WideCharToMultiByte(0,0,lpWideCharStr,iVar5,pCVar6,_Size,(LPCSTR)0x0,(LPBOOL)0x0),
         local_8 = pCVar6, iVar5 == 0)) {
        FUN_00404d98(pCVar6);
        local_8 = (LPSTR)0x0;
      }
      FreeEnvironmentStringsW(lpWideCharStr);
      return local_8;
    }
    pCVar9 = GetEnvironmentStrings();
    if (pCVar9 == (LPCH)0x0) {
      return (LPSTR)0x0;
    }
    DAT_00412230 = 2;
  }
  else {
    if (DAT_00412230 == 1) goto LAB_00406253;
    if (DAT_00412230 != 2) {
      return (LPSTR)0x0;
    }
  }
  if ((pCVar9 == (LPCH)0x0) && (pCVar9 = GetEnvironmentStrings(), pCVar9 == (LPCH)0x0)) {
    return (LPSTR)0x0;
  }
  cVar1 = *pCVar9;
  pcVar7 = pCVar9;
  while (cVar1 != '\0') {
    do {
      pcVar8 = pcVar7;
      pcVar7 = pcVar8 + 1;
    } while (*pcVar7 != '\0');
    pcVar7 = pcVar8 + 2;
    cVar1 = *pcVar7;
  }
  pCVar6 = (LPSTR)_malloc((size_t)(pcVar7 + (1 - (int)pCVar9)));
  if (pCVar6 == (LPSTR)0x0) {
    pCVar6 = (LPSTR)0x0;
  }
  else {
    FUN_004055b0((undefined4 *)pCVar6,(undefined4 *)pCVar9,(uint)(pcVar7 + (1 - (int)pCVar9)));
  }
  FreeEnvironmentStringsA(pCVar9);
  return pCVar6;
}



Function: FUN_0040632e
----------------------------------------

void FUN_0040632e(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  undefined4 *puVar3;
  DWORD DVar4;
  HANDLE hFile;
  UINT *pUVar5;
  int iVar6;
  uint uVar7;
  UINT UVar8;
  UINT UVar9;
  _STARTUPINFOA local_4c;
  byte *local_8;
  
  puVar2 = (undefined4 *)_malloc(0x480);
  if (puVar2 == (undefined4 *)0x0) {
    __amsg_exit(0x1b);
  }
  DAT_004137c0 = 0x20;
  DAT_004136c0 = puVar2;
  for (; puVar2 < DAT_004136c0 + 0x120; puVar2 = puVar2 + 9) {
    *(undefined1 *)(puVar2 + 1) = 0;
    *puVar2 = 0xffffffff;
    puVar2[2] = 0;
    *(undefined1 *)((int)puVar2 + 5) = 10;
  }
  GetStartupInfoA(&local_4c);
  if ((local_4c.cbReserved2 != 0) && ((UINT *)local_4c.lpReserved2 != (UINT *)0x0)) {
    UVar8 = *(UINT *)local_4c.lpReserved2;
    pUVar5 = (UINT *)((int)local_4c.lpReserved2 + 4);
    local_8 = (byte *)((int)pUVar5 + UVar8);
    if (0x7ff < (int)UVar8) {
      UVar8 = 0x800;
    }
    UVar9 = UVar8;
    if ((int)DAT_004137c0 < (int)UVar8) {
      puVar2 = &DAT_004136c4;
      do {
        puVar3 = (undefined4 *)_malloc(0x480);
        UVar9 = DAT_004137c0;
        if (puVar3 == (undefined4 *)0x0) break;
        DAT_004137c0 = DAT_004137c0 + 0x20;
        *puVar2 = puVar3;
        puVar1 = puVar3;
        for (; puVar3 < puVar1 + 0x120; puVar3 = puVar3 + 9) {
          *(undefined1 *)(puVar3 + 1) = 0;
          *puVar3 = 0xffffffff;
          puVar3[2] = 0;
          *(undefined1 *)((int)puVar3 + 5) = 10;
          puVar1 = (undefined4 *)*puVar2;
        }
        puVar2 = puVar2 + 1;
        UVar9 = UVar8;
      } while ((int)DAT_004137c0 < (int)UVar8);
    }
    uVar7 = 0;
    if (0 < (int)UVar9) {
      do {
        if (((*(HANDLE *)local_8 != (HANDLE)0xffffffff) && ((*pUVar5 & 1) != 0)) &&
           (((*pUVar5 & 8) != 0 || (DVar4 = GetFileType(*(HANDLE *)local_8), DVar4 != 0)))) {
          puVar2 = (undefined4 *)((int)(&DAT_004136c0)[(int)uVar7 >> 5] + (uVar7 & 0x1f) * 0x24);
          *puVar2 = *(undefined4 *)local_8;
          *(byte *)(puVar2 + 1) = (byte)*pUVar5;
        }
        local_8 = local_8 + 4;
        uVar7 = uVar7 + 1;
        pUVar5 = (UINT *)((int)pUVar5 + 1);
      } while ((int)uVar7 < (int)UVar9);
    }
  }
  iVar6 = 0;
  do {
    puVar2 = DAT_004136c0 + iVar6 * 9;
    if (DAT_004136c0[iVar6 * 9] == -1) {
      *(undefined1 *)(puVar2 + 1) = 0x81;
      if (iVar6 == 0) {
        DVar4 = 0xfffffff6;
      }
      else {
        DVar4 = 0xfffffff5 - (iVar6 != 1);
      }
      hFile = GetStdHandle(DVar4);
      if ((hFile != (HANDLE)0xffffffff) && (DVar4 = GetFileType(hFile), DVar4 != 0)) {
        *puVar2 = hFile;
        if ((DVar4 & 0xff) != 2) {
          if ((DVar4 & 0xff) == 3) {
            *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 8;
          }
          goto LAB_004064d3;
        }
      }
      *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 0x40;
    }
    else {
      *(byte *)(puVar2 + 1) = *(byte *)(puVar2 + 1) | 0x80;
    }
LAB_004064d3:
    iVar6 = iVar6 + 1;
    if (2 < iVar6) {
      SetHandleCount(DAT_004137c0);
      return;
    }
  } while( true );
}



Function: FUN_004064ea
----------------------------------------

undefined4 FUN_004064ea(void)

{
  DWORD *lpTlsValue;
  BOOL BVar1;
  DWORD DVar2;
  
  FUN_00407cfc();
  DAT_0040f42c = TlsAlloc();
  if (DAT_0040f42c != 0xffffffff) {
    lpTlsValue = (DWORD *)FUN_004096da(1,0x74);
    if (lpTlsValue != (DWORD *)0x0) {
      BVar1 = TlsSetValue(DAT_0040f42c,lpTlsValue);
      if (BVar1 != 0) {
        FUN_0040653e((int)lpTlsValue);
        DVar2 = GetCurrentThreadId();
        lpTlsValue[1] = 0xffffffff;
        *lpTlsValue = DVar2;
        return 1;
      }
    }
  }
  return 0;
}



Function: FUN_0040653e
----------------------------------------

void __cdecl FUN_0040653e(int param_1)

{
  *(undefined **)(param_1 + 0x50) = &DAT_0040f380;
  *(undefined4 *)(param_1 + 0x14) = 1;
  return;
}



Function: FUN_00406551
----------------------------------------

DWORD * FUN_00406551(void)

{
  DWORD dwErrCode;
  DWORD *lpTlsValue;
  BOOL BVar1;
  DWORD DVar2;
  
  dwErrCode = GetLastError();
  lpTlsValue = (DWORD *)TlsGetValue(DAT_0040f42c);
  if (lpTlsValue == (DWORD *)0x0) {
    lpTlsValue = (DWORD *)FUN_004096da(1,0x74);
    if (lpTlsValue != (DWORD *)0x0) {
      BVar1 = TlsSetValue(DAT_0040f42c,lpTlsValue);
      if (BVar1 != 0) {
        FUN_0040653e((int)lpTlsValue);
        DVar2 = GetCurrentThreadId();
        lpTlsValue[1] = 0xffffffff;
        *lpTlsValue = DVar2;
        goto LAB_004065ac;
      }
    }
    __amsg_exit(0x10);
  }
LAB_004065ac:
  SetLastError(dwErrCode);
  return lpTlsValue;
}



Function: FUN_004065b8
----------------------------------------

void __cdecl FUN_004065b8(undefined4 *param_1)

{
  int iVar1;
  HMODULE pHVar2;
  
  *param_1 = 0;
  pHVar2 = GetModuleHandleA((LPCSTR)0x0);
  if (((short)pHVar2->unused == 0x5a4d) && (iVar1 = pHVar2[0xf].unused, iVar1 != 0)) {
    *(undefined1 *)param_1 = *(undefined1 *)((int)&pHVar2[6].unused + iVar1 + 2);
    *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)&pHVar2[6].unused + iVar1 + 3);
  }
  return;
}



Function: FUN_004065e5
----------------------------------------

int FUN_004065e5(void)

{
  char cVar1;
  byte bVar2;
  BOOL BVar3;
  DWORD DVar4;
  int iVar5;
  byte *pbVar6;
  char *pcVar7;
  byte *this;
  byte unaff_BL;
  char local_1230 [4240];
  char local_1a0 [260];
  DWORD local_9c;
  uint local_98;
  DWORD local_8c;
  CHAR aCStackY_18 [4];
  
  FUN_00404a80();
  local_9c = 0x94;
  BVar3 = GetVersionExA((LPOSVERSIONINFOA)&local_9c);
  if (((BVar3 == 0) || (local_8c != 2)) || (local_98 < 5)) {
    builtin_memcpy(aCStackY_18,"?f@",4);
    DVar4 = GetEnvironmentVariableA("__MSVCRT_HEAP_SELECT",local_1230,0x1090);
    if (DVar4 != 0) {
      pcVar7 = local_1230;
      while (local_1230[0] != '\0') {
        cVar1 = *pcVar7;
        if (('`' < cVar1) && (cVar1 < '{')) {
          *pcVar7 = cVar1 + -0x20;
        }
        pcVar7 = pcVar7 + 1;
        local_1230[0] = *pcVar7;
      }
      builtin_memcpy(aCStackY_18,"}f@",4);
      iVar5 = _strncmp("__GLOBAL_HEAP_SELECTED",local_1230,0x16);
      if (iVar5 == 0) {
        pcVar7 = local_1230;
      }
      else {
        aCStackY_18[0] = -0x61;
        aCStackY_18[1] = 'f';
        aCStackY_18[2] = '@';
        aCStackY_18[3] = '\0';
        GetModuleFileNameA((HMODULE)0x0,local_1a0,0x104);
        pcVar7 = local_1a0;
        while (local_1a0[0] != '\0') {
          cVar1 = *pcVar7;
          if (('`' < cVar1) && (cVar1 < '{')) {
            *pcVar7 = cVar1 + -0x20;
          }
          pcVar7 = pcVar7 + 1;
          local_1a0[0] = *pcVar7;
        }
        pcVar7 = _strstr(local_1230,local_1a0);
      }
      if ((pcVar7 != (char *)0x0) && (pcVar7 = _strchr(pcVar7,0x2c), pcVar7 != (char *)0x0)) {
        pbVar6 = (byte *)(pcVar7 + 1);
        bVar2 = *pbVar6;
        this = pbVar6;
        while (bVar2 != 0) {
          if (*this == 0x3b) {
            *this = 0;
          }
          else {
            this = this + 1;
          }
          bVar2 = *this;
        }
        builtin_memcpy(aCStackY_18,"\x05g@",4);
        iVar5 = FUN_00409817(this,pbVar6,(int *)0x0,(void *)0xa);
        if (iVar5 == 2) {
          return 2;
        }
        if (iVar5 == 3) {
          return 3;
        }
        if (iVar5 == 1) {
          return 1;
        }
      }
    }
    FUN_004065b8((undefined4 *)&stack0xfffffff8);
    iVar5 = 3 - (uint)(unaff_BL < 6);
  }
  else {
    iVar5 = 1;
  }
  return iVar5;
}



Function: FUN_0040672d
----------------------------------------

undefined4 __cdecl FUN_0040672d(int param_1)

{
  undefined **ppuVar1;
  
  DAT_004136a0 = HeapCreate((uint)(param_1 == 0),0x1000,0);
  if (DAT_004136a0 != (HANDLE)0x0) {
    DAT_004136a4 = FUN_004065e5();
    if (DAT_004136a4 == 3) {
      ppuVar1 = (undefined **)FUN_00406ae8(0x3f8);
    }
    else {
      if (DAT_004136a4 != 2) {
        return 1;
      }
      ppuVar1 = FUN_0040762f();
    }
    if (ppuVar1 != (undefined **)0x0) {
      return 1;
    }
    HeapDestroy(DAT_004136a0);
  }
  return 0;
}



Function: __global_unwind2
----------------------------------------

/* Library Function - Single Match
    __global_unwind2
   
   Library: Visual Studio */

void __cdecl __global_unwind2(PVOID param_1)

{
  RtlUnwind(param_1,(PVOID)0x4067a4,(PEXCEPTION_RECORD)0x0,(PVOID)0x0);
  return;
}



Function: __local_unwind2
----------------------------------------

/* Library Function - Single Match
    __local_unwind2
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release, Visual Studio 2003 Debug, Visual
   Studio 2003 Release */

void __cdecl __local_unwind2(int param_1,int param_2)

{
  int iVar1;
  int iVar2;
  void *pvStack_1c;
  undefined1 *puStack_18;
  undefined4 local_14;
  int iStack_10;
  
  iStack_10 = param_1;
  puStack_18 = &LAB_004067ac;
  pvStack_1c = ExceptionList;
  ExceptionList = &pvStack_1c;
  while( true ) {
    iVar1 = *(int *)(param_1 + 8);
    iVar2 = *(int *)(param_1 + 0xc);
    if ((iVar2 == -1) || (iVar2 == param_2)) break;
    local_14 = *(undefined4 *)(iVar1 + iVar2 * 0xc);
    *(undefined4 *)(param_1 + 0xc) = local_14;
    if (*(int *)(iVar1 + 4 + iVar2 * 0xc) == 0) {
      FUN_00406862();
      (**(code **)(iVar1 + 8 + iVar2 * 0xc))();
    }
  }
  ExceptionList = pvStack_1c;
  return;
}



Function: FUN_00406862
----------------------------------------

void FUN_00406862(void)

{
  undefined4 in_EAX;
  int unaff_EBP;
  
  DAT_0040f43c = *(undefined4 *)(unaff_EBP + 8);
  DAT_0040f438 = in_EAX;
  DAT_0040f440 = unaff_EBP;
  return;
}



Function: FUN_00406941
----------------------------------------

void FUN_00406941(int param_1)

{
  __local_unwind2(*(int *)(param_1 + 0x18),*(int *)(param_1 + 0x1c));
  return;
}



Function: FUN_0040695c
----------------------------------------

void FUN_0040695c(void)

{
  if ((DAT_004120e4 == 1) || ((DAT_004120e4 == 0 && (DAT_0040f204 == 1)))) {
    FUN_00406995(0xfc);
    if (DAT_00412234 != (code *)0x0) {
      (*DAT_00412234)();
    }
    FUN_00406995(0xff);
  }
  return;
}



Function: FUN_00406995
----------------------------------------

void __cdecl FUN_00406995(DWORD param_1)

{
  undefined4 *puVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  size_t sVar4;
  HANDLE hFile;
  int iVar5;
  uint *_Dest;
  undefined1 auStackY_1e3 [7];
  LPCVOID lpBuffer;
  LPOVERLAPPED lpOverlapped;
  uint local_1a8 [65];
  uint local_a4 [40];
  
  iVar5 = 0;
  pDVar2 = &DAT_0040f448;
  do {
    if (param_1 == *pDVar2) break;
    pDVar2 = pDVar2 + 2;
    iVar5 = iVar5 + 1;
  } while ((int)pDVar2 < 0x40f4d8);
  if (param_1 == (&DAT_0040f448)[iVar5 * 2]) {
    if ((DAT_004120e4 == 1) || ((DAT_004120e4 == 0 && (DAT_0040f204 == 1)))) {
      pDVar2 = &param_1;
      puVar1 = (undefined4 *)(iVar5 * 8 + 0x40f44c);
      lpOverlapped = (LPOVERLAPPED)0x0;
      sVar4 = _strlen((char *)*puVar1);
      lpBuffer = (LPCVOID)*puVar1;
      hFile = GetStdHandle(0xfffffff4);
      WriteFile(hFile,lpBuffer,sVar4,pDVar2,lpOverlapped);
    }
    else if (param_1 != 0xfc) {
      DVar3 = GetModuleFileNameA((HMODULE)0x0,(LPSTR)local_1a8,0x104);
      if (DVar3 == 0) {
        FUN_00404b30(local_1a8,(uint *)"<program name unknown>");
      }
      _Dest = local_1a8;
      sVar4 = _strlen((char *)local_1a8);
      if (0x3c < sVar4 + 1) {
        sVar4 = _strlen((char *)local_1a8);
        _Dest = (uint *)(auStackY_1e3 + sVar4);
        _strncpy((char *)_Dest,"...",3);
      }
      FUN_00404b30(local_a4,(uint *)"Runtime Error!\n\nProgram: ");
      FUN_00404b40(local_a4,_Dest);
      FUN_00404b40(local_a4,(uint *)&DAT_0040d484);
      FUN_00404b40(local_a4,*(uint **)(iVar5 * 8 + 0x40f44c));
      auStackY_1e3._3_4_ = 0x406ab9;
      FUN_00409bc8(local_a4,"Microsoft Visual C++ Runtime Library",0x12010);
    }
  }
  return;
}



Function: FUN_00406ae8
----------------------------------------

undefined4 FUN_00406ae8(undefined4 param_1)

{
  DAT_00413698 = HeapAlloc(DAT_004136a0,0,0x140);
  if (DAT_00413698 == (LPVOID)0x0) {
    return 0;
  }
  DAT_00413690 = 0;
  DAT_00413694 = 0;
  DAT_0041368c = DAT_00413698;
  DAT_0041369c = param_1;
  DAT_00413684 = 0x10;
  return 1;
}



Function: FUN_00406b30
----------------------------------------

uint __cdecl FUN_00406b30(int param_1)

{
  uint uVar1;
  
  uVar1 = DAT_00413698;
  while( true ) {
    if (DAT_00413698 + DAT_00413694 * 0x14 <= uVar1) {
      return 0;
    }
    if ((uint)(param_1 - *(int *)(uVar1 + 0xc)) < 0x100000) break;
    uVar1 = uVar1 + 0x14;
  }
  return uVar1;
}



Function: FUN_00406b5b
----------------------------------------

void __cdecl FUN_00406b5b(uint *param_1,int param_2)

{
  char *pcVar1;
  uint *puVar2;
  int *piVar3;
  char cVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  byte bVar8;
  uint uVar9;
  uint *puVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  uint uVar14;
  uint local_8;
  
  uVar5 = param_1[4];
  puVar12 = (uint *)(param_2 + -4);
  uVar14 = param_2 - param_1[3] >> 0xf;
  piVar3 = (int *)(uVar14 * 0x204 + 0x144 + uVar5);
  uVar13 = *puVar12;
  local_8 = uVar13 - 1;
  if ((local_8 & 1) == 0) {
    uVar6 = *(uint *)(local_8 + (int)puVar12);
    uVar7 = *(uint *)(param_2 + -8);
    if ((uVar6 & 1) == 0) {
      uVar9 = ((int)uVar6 >> 4) - 1;
      if (0x3f < uVar9) {
        uVar9 = 0x3f;
      }
      if (*(int *)((int)puVar12 + uVar13 + 3) == *(int *)((int)puVar12 + uVar13 + 7)) {
        if (uVar9 < 0x20) {
          pcVar1 = (char *)(uVar9 + 4 + uVar5);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 & 0x1f));
          puVar10 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 & uVar9;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar9;
          }
        }
        else {
          pcVar1 = (char *)(uVar9 + 4 + uVar5);
          uVar9 = ~(0x80000000U >> ((byte)uVar9 - 0x20 & 0x1f));
          puVar10 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 & uVar9;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar9;
          }
        }
      }
      local_8 = local_8 + uVar6;
      *(undefined4 *)(*(int *)((int)puVar12 + uVar13 + 7) + 4) =
           *(undefined4 *)((int)puVar12 + uVar13 + 3);
      *(undefined4 *)(*(int *)((int)puVar12 + uVar13 + 3) + 8) =
           *(undefined4 *)((int)puVar12 + uVar13 + 7);
    }
    puVar10 = (uint *)(((int)local_8 >> 4) - 1);
    if ((uint *)0x3f < puVar10) {
      puVar10 = (uint *)0x3f;
    }
    puVar11 = param_1;
    if ((uVar7 & 1) == 0) {
      puVar12 = (uint *)((int)puVar12 - uVar7);
      puVar11 = (uint *)(((int)uVar7 >> 4) - 1);
      if ((uint *)0x3f < puVar11) {
        puVar11 = (uint *)0x3f;
      }
      local_8 = local_8 + uVar7;
      puVar10 = (uint *)(((int)local_8 >> 4) - 1);
      if ((uint *)0x3f < puVar10) {
        puVar10 = (uint *)0x3f;
      }
      if (puVar11 != puVar10) {
        if (puVar12[1] == puVar12[2]) {
          if (puVar11 < (uint *)0x20) {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 & 0x1f));
            puVar2 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
            *puVar2 = *puVar2 & uVar13;
            pcVar1 = (char *)((int)puVar11 + uVar5 + 4);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              *param_1 = *param_1 & uVar13;
            }
          }
          else {
            uVar13 = ~(0x80000000U >> ((byte)puVar11 - 0x20 & 0x1f));
            puVar2 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
            *puVar2 = *puVar2 & uVar13;
            pcVar1 = (char *)((int)puVar11 + uVar5 + 4);
            *pcVar1 = *pcVar1 + -1;
            if (*pcVar1 == '\0') {
              param_1[1] = param_1[1] & uVar13;
            }
          }
        }
        *(uint *)(puVar12[2] + 4) = puVar12[1];
        *(uint *)(puVar12[1] + 8) = puVar12[2];
      }
    }
    if (((uVar7 & 1) != 0) || (puVar11 != puVar10)) {
      puVar12[1] = piVar3[(int)puVar10 * 2 + 1];
      puVar12[2] = (uint)(piVar3 + (int)puVar10 * 2);
      (piVar3 + (int)puVar10 * 2)[1] = (int)puVar12;
      *(uint **)(puVar12[1] + 8) = puVar12;
      if (puVar12[1] == puVar12[2]) {
        cVar4 = *(char *)((int)puVar10 + uVar5 + 4);
        *(char *)((int)puVar10 + uVar5 + 4) = cVar4 + '\x01';
        bVar8 = (byte)puVar10;
        if (puVar10 < (uint *)0x20) {
          if (cVar4 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar10 = (uint *)(uVar5 + 0x44 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 & 0x1f);
        }
        else {
          if (cVar4 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar10 = (uint *)(uVar5 + 0xc4 + uVar14 * 4);
          *puVar10 = *puVar10 | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
      }
    }
    *puVar12 = local_8;
    *(uint *)((local_8 - 4) + (int)puVar12) = local_8;
    *piVar3 = *piVar3 + -1;
    if (*piVar3 == 0) {
      if (DAT_00413690 != (uint *)0x0) {
        VirtualFree((LPVOID)(DAT_00413688 * 0x8000 + DAT_00413690[3]),0x8000,0x4000);
        DAT_00413690[2] = DAT_00413690[2] | 0x80000000U >> ((byte)DAT_00413688 & 0x1f);
        *(undefined4 *)(DAT_00413690[4] + 0xc4 + DAT_00413688 * 4) = 0;
        *(char *)(DAT_00413690[4] + 0x43) = *(char *)(DAT_00413690[4] + 0x43) + -1;
        if (*(char *)(DAT_00413690[4] + 0x43) == '\0') {
          DAT_00413690[1] = DAT_00413690[1] & 0xfffffffe;
        }
        if (DAT_00413690[2] == 0xffffffff) {
          VirtualFree((LPVOID)DAT_00413690[3],0,0x8000);
          HeapFree(DAT_004136a0,0,(LPVOID)DAT_00413690[4]);
          FUN_00409d60(DAT_00413690,DAT_00413690 + 5,
                       (DAT_00413694 * 0x14 - (int)DAT_00413690) + -0x14 + DAT_00413698);
          DAT_00413694 = DAT_00413694 + -1;
          if (DAT_00413690 < param_1) {
            param_1 = param_1 + -5;
          }
          DAT_0041368c = DAT_00413698;
        }
      }
      DAT_00413690 = param_1;
      DAT_00413688 = uVar14;
    }
  }
  return;
}



Function: FUN_00406e84
----------------------------------------

int * __cdecl FUN_00406e84(uint *param_1)

{
  char *pcVar1;
  int *piVar2;
  char cVar3;
  int *piVar4;
  byte bVar5;
  uint uVar6;
  int iVar7;
  uint *puVar8;
  int iVar9;
  int *piVar10;
  uint *puVar11;
  uint *puVar12;
  uint uVar13;
  int iVar14;
  uint local_10;
  uint local_c;
  int local_8;
  
  puVar8 = DAT_00413698 + DAT_00413694 * 5;
  uVar6 = (int)param_1 + 0x17U & 0xfffffff0;
  iVar7 = ((int)((int)param_1 + 0x17U) >> 4) + -1;
  bVar5 = (byte)iVar7;
  if (iVar7 < 0x20) {
    local_10 = 0xffffffff >> (bVar5 & 0x1f);
    local_c = 0xffffffff;
  }
  else {
    local_c = 0xffffffff >> (bVar5 - 0x20 & 0x1f);
    local_10 = 0;
  }
  param_1 = DAT_0041368c;
  if (DAT_0041368c < puVar8) {
    do {
      if ((param_1[1] & local_c) != 0 || (*param_1 & local_10) != 0) break;
      param_1 = param_1 + 5;
    } while (param_1 < puVar8);
  }
  puVar11 = DAT_00413698;
  if (param_1 == puVar8) {
    for (; (puVar11 < DAT_0041368c && ((puVar11[1] & local_c) == 0 && (*puVar11 & local_10) == 0));
        puVar11 = puVar11 + 5) {
    }
    param_1 = puVar11;
    if (puVar11 == DAT_0041368c) {
      for (; (puVar11 < puVar8 && (puVar11[2] == 0)); puVar11 = puVar11 + 5) {
      }
      puVar12 = DAT_00413698;
      param_1 = puVar11;
      if (puVar11 == puVar8) {
        for (; (puVar12 < DAT_0041368c && (puVar12[2] == 0)); puVar12 = puVar12 + 5) {
        }
        param_1 = puVar12;
        if ((puVar12 == DAT_0041368c) && (param_1 = FUN_0040718d(), param_1 == (uint *)0x0)) {
          return (int *)0x0;
        }
      }
      iVar7 = FUN_0040723e((int)param_1);
      *(int *)param_1[4] = iVar7;
      if (*(int *)param_1[4] == -1) {
        return (int *)0x0;
      }
    }
  }
  piVar4 = (int *)param_1[4];
  local_8 = *piVar4;
  if ((local_8 == -1) ||
     ((piVar4[local_8 + 0x31] & local_c) == 0 && (piVar4[local_8 + 0x11] & local_10) == 0)) {
    local_8 = 0;
    puVar8 = (uint *)(piVar4 + 0x11);
    if ((piVar4[0x31] & local_c) == 0 && (piVar4[0x11] & local_10) == 0) {
      do {
        puVar11 = puVar8 + 0x21;
        local_8 = local_8 + 1;
        puVar8 = puVar8 + 1;
      } while ((*puVar11 & local_c) == 0 && (local_10 & *puVar8) == 0);
    }
  }
  iVar7 = 0;
  piVar2 = piVar4 + local_8 * 0x81 + 0x51;
  local_10 = piVar4[local_8 + 0x11] & local_10;
  if (local_10 == 0) {
    local_10 = piVar4[local_8 + 0x31] & local_c;
    iVar7 = 0x20;
  }
  for (; -1 < (int)local_10; local_10 = local_10 << 1) {
    iVar7 = iVar7 + 1;
  }
  piVar10 = (int *)piVar2[iVar7 * 2 + 1];
  iVar9 = *piVar10 - uVar6;
  iVar14 = (iVar9 >> 4) + -1;
  if (0x3f < iVar14) {
    iVar14 = 0x3f;
  }
  DAT_0041368c = param_1;
  if (iVar14 != iVar7) {
    if (piVar10[1] == piVar10[2]) {
      if (iVar7 < 0x20) {
        pcVar1 = (char *)((int)piVar4 + iVar7 + 4);
        uVar13 = ~(0x80000000U >> ((byte)iVar7 & 0x1f));
        piVar4[local_8 + 0x11] = uVar13 & piVar4[local_8 + 0x11];
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar13;
        }
      }
      else {
        pcVar1 = (char *)((int)piVar4 + iVar7 + 4);
        uVar13 = ~(0x80000000U >> ((byte)iVar7 - 0x20 & 0x1f));
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] & uVar13;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar13;
        }
      }
    }
    *(int *)(piVar10[2] + 4) = piVar10[1];
    *(int *)(piVar10[1] + 8) = piVar10[2];
    if (iVar9 == 0) goto LAB_0040714a;
    piVar10[1] = piVar2[iVar14 * 2 + 1];
    piVar10[2] = (int)(piVar2 + iVar14 * 2);
    (piVar2 + iVar14 * 2)[1] = (int)piVar10;
    *(int **)(piVar10[1] + 8) = piVar10;
    if (piVar10[1] == piVar10[2]) {
      cVar3 = *(char *)(iVar14 + 4 + (int)piVar4);
      bVar5 = (byte)iVar14;
      if (iVar14 < 0x20) {
        *(char *)(iVar14 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar5 & 0x1f);
        }
        piVar4[local_8 + 0x11] = piVar4[local_8 + 0x11] | 0x80000000U >> (bVar5 & 0x1f);
      }
      else {
        *(char *)(iVar14 + 4 + (int)piVar4) = cVar3 + '\x01';
        if (cVar3 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar5 - 0x20 & 0x1f);
        }
        piVar4[local_8 + 0x31] = piVar4[local_8 + 0x31] | 0x80000000U >> (bVar5 - 0x20 & 0x1f);
      }
    }
  }
  if (iVar9 != 0) {
    *piVar10 = iVar9;
    *(int *)(iVar9 + -4 + (int)piVar10) = iVar9;
  }
LAB_0040714a:
  piVar10 = (int *)((int)piVar10 + iVar9);
  *piVar10 = uVar6 + 1;
  *(uint *)((int)piVar10 + (uVar6 - 4)) = uVar6 + 1;
  iVar7 = *piVar2;
  *piVar2 = iVar7 + 1;
  if (((iVar7 == 0) && (param_1 == DAT_00413690)) && (local_8 == DAT_00413688)) {
    DAT_00413690 = (uint *)0x0;
  }
  *piVar4 = local_8;
  return piVar10 + 1;
}



Function: FUN_0040718d
----------------------------------------

undefined4 * FUN_0040718d(void)

{
  undefined4 *puVar1;
  LPVOID pvVar2;
  
  if (DAT_00413694 == DAT_00413684) {
    pvVar2 = HeapReAlloc(DAT_004136a0,0,DAT_00413698,(DAT_00413684 * 5 + 0x50) * 4);
    if (pvVar2 == (LPVOID)0x0) {
      return (undefined4 *)0x0;
    }
    DAT_00413684 = DAT_00413684 + 0x10;
    DAT_00413698 = pvVar2;
  }
  puVar1 = (undefined4 *)((int)DAT_00413698 + DAT_00413694 * 0x14);
  pvVar2 = HeapAlloc(DAT_004136a0,8,0x41c4);
  puVar1[4] = pvVar2;
  if (pvVar2 != (LPVOID)0x0) {
    pvVar2 = VirtualAlloc((LPVOID)0x0,0x100000,0x2000,4);
    puVar1[3] = pvVar2;
    if (pvVar2 != (LPVOID)0x0) {
      puVar1[2] = 0xffffffff;
      *puVar1 = 0;
      puVar1[1] = 0;
      DAT_00413694 = DAT_00413694 + 1;
      *(undefined4 *)puVar1[4] = 0xffffffff;
      return puVar1;
    }
    HeapFree(DAT_004136a0,0,(LPVOID)puVar1[4]);
  }
  return (undefined4 *)0x0;
}



Function: FUN_0040723e
----------------------------------------

int __cdecl FUN_0040723e(int param_1)

{
  int *piVar1;
  char cVar2;
  int iVar3;
  int iVar4;
  int iVar5;
  LPVOID pvVar6;
  int *piVar7;
  int iVar8;
  int iVar9;
  int *lpAddress;
  
  iVar3 = *(int *)(param_1 + 0x10);
  iVar9 = 0;
  for (iVar4 = *(int *)(param_1 + 8); -1 < iVar4; iVar4 = iVar4 << 1) {
    iVar9 = iVar9 + 1;
  }
  iVar8 = 0x3f;
  iVar4 = iVar9 * 0x204 + 0x144 + iVar3;
  iVar5 = iVar4;
  do {
    *(int *)(iVar5 + 8) = iVar5;
    *(int *)(iVar5 + 4) = iVar5;
    iVar5 = iVar5 + 8;
    iVar8 = iVar8 + -1;
  } while (iVar8 != 0);
  lpAddress = (int *)(iVar9 * 0x8000 + *(int *)(param_1 + 0xc));
  pvVar6 = VirtualAlloc(lpAddress,0x8000,0x1000,4);
  if (pvVar6 == (LPVOID)0x0) {
    iVar9 = -1;
  }
  else {
    if (lpAddress <= lpAddress + 0x1c00) {
      piVar7 = lpAddress + 4;
      do {
        piVar7[-2] = -1;
        piVar7[0x3fb] = -1;
        piVar7[-1] = 0xff0;
        *piVar7 = (int)(piVar7 + 0x3ff);
        piVar7[1] = (int)(piVar7 + -0x401);
        piVar7[0x3fa] = 0xff0;
        piVar1 = piVar7 + 0x3fc;
        piVar7 = piVar7 + 0x400;
      } while (piVar1 <= lpAddress + 0x1c00);
    }
    *(int **)(iVar4 + 0x1fc) = lpAddress + 3;
    lpAddress[5] = iVar4 + 0x1f8;
    *(int **)(iVar4 + 0x200) = lpAddress + 0x1c03;
    lpAddress[0x1c04] = iVar4 + 0x1f8;
    *(undefined4 *)(iVar3 + 0x44 + iVar9 * 4) = 0;
    *(undefined4 *)(iVar3 + 0xc4 + iVar9 * 4) = 1;
    cVar2 = *(char *)(iVar3 + 0x43);
    *(char *)(iVar3 + 0x43) = cVar2 + '\x01';
    if (cVar2 == '\0') {
      *(uint *)(param_1 + 4) = *(uint *)(param_1 + 4) | 1;
    }
    *(uint *)(param_1 + 8) = *(uint *)(param_1 + 8) & ~(0x80000000U >> ((byte)iVar9 & 0x1f));
  }
  return iVar9;
}



Function: FUN_00407339
----------------------------------------

undefined4 __cdecl FUN_00407339(uint *param_1,int param_2,int param_3)

{
  char *pcVar1;
  int *piVar2;
  int iVar3;
  char cVar4;
  uint uVar5;
  int iVar6;
  uint *puVar7;
  byte bVar8;
  int iVar9;
  uint uVar10;
  uint uVar11;
  uint uVar12;
  uint uVar13;
  uint local_c;
  
  uVar5 = param_1[4];
  uVar12 = param_3 + 0x17U & 0xfffffff0;
  uVar10 = param_2 - param_1[3] >> 0xf;
  iVar3 = uVar10 * 0x204 + 0x144 + uVar5;
  iVar6 = *(int *)(param_2 + -4);
  iVar9 = iVar6 + -1;
  uVar13 = *(uint *)(iVar6 + -5 + param_2);
  iVar6 = iVar6 + -5 + param_2;
  if (iVar9 < (int)uVar12) {
    if (((uVar13 & 1) != 0) || ((int)(uVar13 + iVar9) < (int)uVar12)) {
      return 0;
    }
    local_c = ((int)uVar13 >> 4) - 1;
    if (0x3f < local_c) {
      local_c = 0x3f;
    }
    if (*(int *)(iVar6 + 4) == *(int *)(iVar6 + 8)) {
      if (local_c < 0x20) {
        pcVar1 = (char *)(local_c + 4 + uVar5);
        uVar11 = ~(0x80000000U >> ((byte)local_c & 0x1f));
        puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
        *puVar7 = *puVar7 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          *param_1 = *param_1 & uVar11;
        }
      }
      else {
        pcVar1 = (char *)(local_c + 4 + uVar5);
        uVar11 = ~(0x80000000U >> ((byte)local_c - 0x20 & 0x1f));
        puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
        *puVar7 = *puVar7 & uVar11;
        *pcVar1 = *pcVar1 + -1;
        if (*pcVar1 == '\0') {
          param_1[1] = param_1[1] & uVar11;
        }
      }
    }
    *(undefined4 *)(*(int *)(iVar6 + 8) + 4) = *(undefined4 *)(iVar6 + 4);
    *(undefined4 *)(*(int *)(iVar6 + 4) + 8) = *(undefined4 *)(iVar6 + 8);
    iVar6 = uVar13 + (iVar9 - uVar12);
    if (0 < iVar6) {
      uVar13 = (iVar6 >> 4) - 1;
      iVar9 = param_2 + -4 + uVar12;
      if (0x3f < uVar13) {
        uVar13 = 0x3f;
      }
      iVar3 = iVar3 + uVar13 * 8;
      *(undefined4 *)(iVar9 + 4) = *(undefined4 *)(iVar3 + 4);
      *(int *)(iVar9 + 8) = iVar3;
      *(int *)(iVar3 + 4) = iVar9;
      *(int *)(*(int *)(iVar9 + 4) + 8) = iVar9;
      if (*(int *)(iVar9 + 4) == *(int *)(iVar9 + 8)) {
        cVar4 = *(char *)(uVar13 + 4 + uVar5);
        *(char *)(uVar13 + 4 + uVar5) = cVar4 + '\x01';
        bVar8 = (byte)uVar13;
        if (uVar13 < 0x20) {
          if (cVar4 == '\0') {
            *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
          }
          puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
        }
        else {
          if (cVar4 == '\0') {
            param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
          }
          puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
          bVar8 = bVar8 - 0x20;
        }
        *puVar7 = *puVar7 | 0x80000000U >> (bVar8 & 0x1f);
      }
      piVar2 = (int *)(param_2 + -4 + uVar12);
      *piVar2 = iVar6;
      *(int *)(iVar6 + -4 + (int)piVar2) = iVar6;
    }
    *(uint *)(param_2 + -4) = uVar12 + 1;
    *(uint *)(param_2 + -8 + uVar12) = uVar12 + 1;
  }
  else if ((int)uVar12 < iVar9) {
    param_3 = iVar9 - uVar12;
    *(uint *)(param_2 + -4) = uVar12 + 1;
    piVar2 = (int *)(param_2 + -4 + uVar12);
    uVar11 = (param_3 >> 4) - 1;
    piVar2[-1] = uVar12 + 1;
    if (0x3f < uVar11) {
      uVar11 = 0x3f;
    }
    if ((uVar13 & 1) == 0) {
      uVar12 = ((int)uVar13 >> 4) - 1;
      if (0x3f < uVar12) {
        uVar12 = 0x3f;
      }
      if (*(int *)(iVar6 + 4) == *(int *)(iVar6 + 8)) {
        if (uVar12 < 0x20) {
          pcVar1 = (char *)(uVar12 + 4 + uVar5);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 & 0x1f));
          puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
          *puVar7 = *puVar7 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            *param_1 = *param_1 & uVar12;
          }
        }
        else {
          pcVar1 = (char *)(uVar12 + 4 + uVar5);
          uVar12 = ~(0x80000000U >> ((byte)uVar12 - 0x20 & 0x1f));
          puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
          *puVar7 = *puVar7 & uVar12;
          *pcVar1 = *pcVar1 + -1;
          if (*pcVar1 == '\0') {
            param_1[1] = param_1[1] & uVar12;
          }
        }
      }
      *(undefined4 *)(*(int *)(iVar6 + 8) + 4) = *(undefined4 *)(iVar6 + 4);
      *(undefined4 *)(*(int *)(iVar6 + 4) + 8) = *(undefined4 *)(iVar6 + 8);
      param_3 = param_3 + uVar13;
      uVar11 = (param_3 >> 4) - 1;
      if (0x3f < uVar11) {
        uVar11 = 0x3f;
      }
    }
    iVar6 = iVar3 + uVar11 * 8;
    piVar2[1] = *(int *)(iVar3 + 4 + uVar11 * 8);
    piVar2[2] = iVar6;
    *(int **)(iVar6 + 4) = piVar2;
    *(int **)(piVar2[1] + 8) = piVar2;
    if (piVar2[1] == piVar2[2]) {
      cVar4 = *(char *)(uVar11 + 4 + uVar5);
      *(char *)(uVar11 + 4 + uVar5) = cVar4 + '\x01';
      bVar8 = (byte)uVar11;
      if (uVar11 < 0x20) {
        if (cVar4 == '\0') {
          *param_1 = *param_1 | 0x80000000U >> (bVar8 & 0x1f);
        }
        puVar7 = (uint *)(uVar5 + 0x44 + uVar10 * 4);
      }
      else {
        if (cVar4 == '\0') {
          param_1[1] = param_1[1] | 0x80000000U >> (bVar8 - 0x20 & 0x1f);
        }
        puVar7 = (uint *)(uVar5 + 0xc4 + uVar10 * 4);
        bVar8 = bVar8 - 0x20;
      }
      *puVar7 = *puVar7 | 0x80000000U >> (bVar8 & 0x1f);
    }
    *piVar2 = param_3;
    *(int *)(param_3 + -4 + (int)piVar2) = param_3;
  }
  return 1;
}



Function: FUN_0040762f
----------------------------------------

undefined ** FUN_0040762f(void)

{
  bool bVar1;
  int *lpAddress;
  LPVOID pvVar2;
  undefined **ppuVar3;
  int iVar4;
  undefined **lpMem;
  
  if (DAT_0040f4e8 == -1) {
    lpMem = &PTR_LOOP_0040f4d8;
  }
  else {
    lpMem = (undefined **)HeapAlloc(DAT_004136a0,0,0x2020);
    if (lpMem == (undefined **)0x0) {
      return (undefined **)0x0;
    }
  }
  lpAddress = (int *)VirtualAlloc((LPVOID)0x0,0x400000,0x2000,4);
  if (lpAddress != (int *)0x0) {
    pvVar2 = VirtualAlloc(lpAddress,0x10000,0x1000,4);
    if (pvVar2 != (LPVOID)0x0) {
      if (lpMem == &PTR_LOOP_0040f4d8) {
        if (PTR_LOOP_0040f4d8 == (undefined *)0x0) {
          PTR_LOOP_0040f4d8 = (undefined *)&PTR_LOOP_0040f4d8;
        }
        if (PTR_LOOP_0040f4dc == (undefined *)0x0) {
          PTR_LOOP_0040f4dc = (undefined *)&PTR_LOOP_0040f4d8;
        }
      }
      else {
        *lpMem = (undefined *)&PTR_LOOP_0040f4d8;
        lpMem[1] = PTR_LOOP_0040f4dc;
        PTR_LOOP_0040f4dc = (undefined *)lpMem;
        *(undefined ***)lpMem[1] = lpMem;
      }
      lpMem[5] = (undefined *)(lpAddress + 0x100000);
      ppuVar3 = lpMem + 6;
      lpMem[3] = (undefined *)(lpMem + 0x26);
      lpMem[4] = (undefined *)lpAddress;
      lpMem[2] = (undefined *)ppuVar3;
      iVar4 = 0;
      do {
        bVar1 = 0xf < iVar4;
        iVar4 = iVar4 + 1;
        *ppuVar3 = (undefined *)((bVar1 - 1 & 0xf1) - 1);
        ppuVar3[1] = (undefined *)0xf1;
        ppuVar3 = ppuVar3 + 2;
      } while (iVar4 < 0x400);
      _memset(lpAddress,0,0x10000);
      for (; lpAddress < lpMem[4] + 0x10000; lpAddress = lpAddress + 0x400) {
        *(undefined1 *)(lpAddress + 0x3e) = 0xff;
        *lpAddress = (int)(lpAddress + 2);
        lpAddress[1] = 0xf0;
      }
      return lpMem;
    }
    VirtualFree(lpAddress,0,0x8000);
  }
  if (lpMem != &PTR_LOOP_0040f4d8) {
    HeapFree(DAT_004136a0,0,lpMem);
  }
  return (undefined **)0x0;
}



Function: FUN_00407773
----------------------------------------

void __cdecl FUN_00407773(undefined **param_1)

{
  VirtualFree(param_1[4],0,0x8000);
  if ((undefined **)PTR_LOOP_004114f8 == param_1) {
    PTR_LOOP_004114f8 = param_1[1];
  }
  if (param_1 != &PTR_LOOP_0040f4d8) {
    *(undefined **)param_1[1] = *param_1;
    *(undefined **)(*param_1 + 4) = param_1[1];
    HeapFree(DAT_004136a0,0,param_1);
    return;
  }
  DAT_0040f4e8 = 0xffffffff;
  return;
}



Function: FUN_004077c9
----------------------------------------

void __cdecl FUN_004077c9(int param_1)

{
  BOOL BVar1;
  undefined **ppuVar2;
  int iVar3;
  undefined **ppuVar4;
  undefined **ppuVar5;
  int local_8;
  
  ppuVar4 = (undefined **)PTR_LOOP_0040f4dc;
  do {
    ppuVar5 = ppuVar4;
    if (ppuVar4[4] != (undefined *)0xffffffff) {
      local_8 = 0;
      ppuVar5 = ppuVar4 + 0x804;
      iVar3 = 0x3ff000;
      do {
        if (*ppuVar5 == (undefined *)0xf0) {
          BVar1 = VirtualFree(ppuVar4[4] + iVar3,0x1000,0x4000);
          if (BVar1 != 0) {
            *ppuVar5 = (undefined *)0xffffffff;
            DAT_00412238 = DAT_00412238 + -1;
            if (((undefined **)ppuVar4[3] == (undefined **)0x0) || (ppuVar5 < ppuVar4[3])) {
              ppuVar4[3] = (undefined *)ppuVar5;
            }
            local_8 = local_8 + 1;
            param_1 = param_1 + -1;
            if (param_1 == 0) break;
          }
        }
        iVar3 = iVar3 + -0x1000;
        ppuVar5 = ppuVar5 + -2;
      } while (-1 < iVar3);
      ppuVar5 = (undefined **)ppuVar4[1];
      if ((local_8 != 0) && (ppuVar4[6] == (undefined *)0xffffffff)) {
        ppuVar2 = ppuVar4 + 8;
        iVar3 = 1;
        do {
          if (*ppuVar2 != (undefined *)0xffffffff) break;
          iVar3 = iVar3 + 1;
          ppuVar2 = ppuVar2 + 2;
        } while (iVar3 < 0x400);
        if (iVar3 == 0x400) {
          FUN_00407773(ppuVar4);
        }
      }
    }
    if ((ppuVar5 == (undefined **)PTR_LOOP_0040f4dc) || (ppuVar4 = ppuVar5, param_1 < 1)) {
      return;
    }
  } while( true );
}



Function: FUN_0040788b
----------------------------------------

int __cdecl FUN_0040788b(undefined *param_1,undefined4 *param_2,uint *param_3)

{
  undefined **ppuVar1;
  uint uVar2;
  
  ppuVar1 = &PTR_LOOP_0040f4d8;
  while ((param_1 <= ppuVar1[4] || (ppuVar1[5] <= param_1))) {
    ppuVar1 = (undefined **)*ppuVar1;
    if (ppuVar1 == &PTR_LOOP_0040f4d8) {
      return 0;
    }
  }
  if (((uint)param_1 & 0xf) != 0) {
    return 0;
  }
  if (((uint)param_1 & 0xfff) < 0x100) {
    return 0;
  }
  *param_2 = ppuVar1;
  uVar2 = (uint)param_1 & 0xfffff000;
  *param_3 = uVar2;
  return ((int)(param_1 + (-0x100 - uVar2)) >> 4) + 8 + uVar2;
}



Function: FUN_004078e2
----------------------------------------

void __cdecl FUN_004078e2(int param_1,int param_2,byte *param_3)

{
  int *piVar1;
  
  piVar1 = (int *)(param_1 + 0x18 + (param_2 - *(int *)(param_1 + 0x10) >> 0xc) * 8);
  *piVar1 = *piVar1 + (uint)*param_3;
  *param_3 = 0;
  piVar1[1] = 0xf1;
  if ((*piVar1 == 0xf0) && (DAT_00412238 = DAT_00412238 + 1, DAT_00412238 == 0x20)) {
    FUN_004077c9(0x10);
  }
  return;
}



Function: FUN_00407927
----------------------------------------

/* WARNING: Type propagation algorithm not settling */

int * __cdecl FUN_00407927(uint param_1)

{
  uint *puVar1;
  undefined **ppuVar2;
  undefined *puVar3;
  int *piVar4;
  int *piVar5;
  undefined **ppuVar6;
  int *piVar7;
  uint *puVar8;
  undefined **ppuVar9;
  int local_8;
  
  piVar7 = (int *)PTR_LOOP_004114f8;
  do {
    if (piVar7[4] != -1) {
      puVar8 = (uint *)piVar7[2];
      piVar4 = (int *)(((int)puVar8 + (-0x18 - (int)piVar7) >> 3) * 0x1000 + piVar7[4]);
      if (puVar8 < piVar7 + 0x806) {
        do {
          if (((int)param_1 <= (int)*puVar8) && (param_1 < puVar8[1])) {
            piVar5 = (int *)FUN_00407b2f(piVar4,*puVar8,param_1);
            if (piVar5 != (int *)0x0) goto LAB_004079f2;
            puVar8[1] = param_1;
          }
          puVar8 = puVar8 + 2;
          piVar4 = piVar4 + 0x400;
        } while (puVar8 < piVar7 + 0x806);
      }
      puVar1 = (uint *)piVar7[2];
      piVar4 = (int *)piVar7[4];
      for (puVar8 = (uint *)(piVar7 + 6); puVar8 < puVar1; puVar8 = puVar8 + 2) {
        if (((int)param_1 <= (int)*puVar8) && (param_1 < puVar8[1])) {
          piVar5 = (int *)FUN_00407b2f(piVar4,*puVar8,param_1);
          if (piVar5 != (int *)0x0) {
LAB_004079f2:
            PTR_LOOP_004114f8 = (undefined *)piVar7;
            *puVar8 = *puVar8 - param_1;
            piVar7[2] = (int)puVar8;
            return piVar5;
          }
          puVar8[1] = param_1;
        }
        piVar4 = piVar4 + 0x400;
      }
    }
    piVar7 = (int *)*piVar7;
    if (piVar7 == (int *)PTR_LOOP_004114f8) {
      ppuVar9 = &PTR_LOOP_0040f4d8;
      while ((ppuVar9[4] == (undefined *)0xffffffff || (ppuVar9[3] == (undefined *)0x0))) {
        ppuVar9 = (undefined **)*ppuVar9;
        if (ppuVar9 == &PTR_LOOP_0040f4d8) {
          ppuVar9 = FUN_0040762f();
          if (ppuVar9 == (undefined **)0x0) {
            return (int *)0x0;
          }
          piVar7 = (int *)ppuVar9[4];
          *(char *)(piVar7 + 2) = (char)param_1;
          PTR_LOOP_004114f8 = (undefined *)ppuVar9;
          *piVar7 = (int)piVar7 + param_1 + 8;
          piVar7[1] = 0xf0 - param_1;
          ppuVar9[6] = ppuVar9[6] + -(param_1 & 0xff);
          return piVar7 + 0x40;
        }
      }
      ppuVar2 = (undefined **)ppuVar9[3];
      local_8 = 0;
      piVar7 = (int *)(ppuVar9[4] + ((int)ppuVar2 + (-0x18 - (int)ppuVar9) >> 3) * 0x1000);
      puVar3 = *ppuVar2;
      ppuVar6 = ppuVar2;
      for (; (puVar3 == (undefined *)0xffffffff && (local_8 < 0x10)); local_8 = local_8 + 1) {
        ppuVar6 = ppuVar6 + 2;
        puVar3 = *ppuVar6;
      }
      piVar4 = (int *)VirtualAlloc(piVar7,local_8 << 0xc,0x1000,4);
      if (piVar4 != piVar7) {
        return (int *)0x0;
      }
      _memset(piVar7,local_8 << 0xc,0);
      ppuVar6 = ppuVar2;
      if (0 < local_8) {
        piVar4 = piVar7 + 1;
        do {
          *(undefined1 *)(piVar4 + 0x3d) = 0xff;
          piVar4[-1] = (int)(piVar4 + 1);
          *piVar4 = 0xf0;
          *ppuVar6 = (undefined *)0xf0;
          ppuVar6[1] = (undefined *)0xf1;
          piVar4 = piVar4 + 0x400;
          ppuVar6 = ppuVar6 + 2;
          local_8 = local_8 + -1;
        } while (local_8 != 0);
      }
      for (; (ppuVar6 < ppuVar9 + 0x806 && (*ppuVar6 != (undefined *)0xffffffff));
          ppuVar6 = ppuVar6 + 2) {
      }
      PTR_LOOP_004114f8 = (undefined *)ppuVar9;
      ppuVar9[3] = (undefined *)(-(uint)(ppuVar6 < ppuVar9 + 0x806) & (uint)ppuVar6);
      *(char *)(piVar7 + 2) = (char)param_1;
      ppuVar9[2] = (undefined *)ppuVar2;
      *ppuVar2 = *ppuVar2 + -param_1;
      piVar7[1] = piVar7[1] - param_1;
      *piVar7 = (int)piVar7 + param_1 + 8;
      return piVar7 + 0x40;
    }
  } while( true );
}



Function: FUN_00407b2f
----------------------------------------

int __cdecl FUN_00407b2f(int *param_1,uint param_2,uint param_3)

{
  byte *pbVar1;
  byte *pbVar2;
  byte bVar3;
  byte *pbVar4;
  uint uVar5;
  byte *pbVar6;
  
  pbVar2 = (byte *)*param_1;
  pbVar1 = (byte *)(param_1 + 0x3e);
  bVar3 = (byte)param_3;
  if ((uint)param_1[1] < param_3) {
    pbVar6 = pbVar2;
    if (pbVar2[param_1[1]] != 0) {
      pbVar6 = pbVar2 + param_1[1];
    }
    while( true ) {
      while( true ) {
        if (pbVar1 <= pbVar6 + param_3) {
          pbVar6 = (byte *)(param_1 + 2);
          while( true ) {
            while( true ) {
              if (pbVar2 <= pbVar6) {
                return 0;
              }
              if (pbVar1 <= pbVar6 + param_3) {
                return 0;
              }
              if (*pbVar6 == 0) break;
              pbVar6 = pbVar6 + *pbVar6;
            }
            uVar5 = 1;
            pbVar4 = pbVar6;
            while (pbVar4 = pbVar4 + 1, *pbVar4 == 0) {
              uVar5 = uVar5 + 1;
            }
            if (param_3 <= uVar5) break;
            param_2 = param_2 - uVar5;
            pbVar6 = pbVar4;
            if (param_2 < param_3) {
              return 0;
            }
          }
          if (pbVar6 + param_3 < pbVar1) {
            *param_1 = (int)(pbVar6 + param_3);
            param_1[1] = uVar5 - param_3;
          }
          else {
            param_1[1] = 0;
            *param_1 = (int)(param_1 + 2);
          }
          *pbVar6 = bVar3;
          pbVar2 = pbVar6 + 8;
          goto LAB_00407c42;
        }
        if (*pbVar6 == 0) break;
        pbVar6 = pbVar6 + *pbVar6;
      }
      uVar5 = 1;
      pbVar4 = pbVar6;
      while (pbVar4 = pbVar4 + 1, *pbVar4 == 0) {
        uVar5 = uVar5 + 1;
      }
      if (param_3 <= uVar5) break;
      if (pbVar6 == pbVar2) {
        param_1[1] = uVar5;
        pbVar6 = pbVar4;
      }
      else {
        param_2 = param_2 - uVar5;
        pbVar6 = pbVar4;
        if (param_2 < param_3) {
          return 0;
        }
      }
    }
    if (pbVar6 + param_3 < pbVar1) {
      *param_1 = (int)(pbVar6 + param_3);
      param_1[1] = uVar5 - param_3;
    }
    else {
      param_1[1] = 0;
      *param_1 = (int)(param_1 + 2);
    }
    *pbVar6 = bVar3;
    pbVar2 = pbVar6 + 8;
  }
  else {
    *pbVar2 = bVar3;
    if (pbVar2 + param_3 < pbVar1) {
      *param_1 = *param_1 + param_3;
      param_1[1] = param_1[1] - param_3;
    }
    else {
      param_1[1] = 0;
      *param_1 = (int)(param_1 + 2);
    }
    pbVar2 = pbVar2 + 8;
  }
LAB_00407c42:
  return (int)pbVar2 * 0x10 + (int)param_1 * -0xf;
}



Function: FUN_00407c53
----------------------------------------

undefined4 __cdecl FUN_00407c53(int param_1,int *param_2,byte *param_3,uint param_4)

{
  byte *pbVar1;
  int *piVar2;
  byte bVar3;
  byte *pbVar4;
  int iVar5;
  uint uVar6;
  
  uVar6 = (uint)*param_3;
  piVar2 = (int *)(param_1 + 0x18 + ((int)param_2 - *(int *)(param_1 + 0x10) >> 0xc) * 8);
  if (param_4 < uVar6) {
    *param_3 = (byte)param_4;
    *piVar2 = *piVar2 + (uVar6 - param_4);
    piVar2[1] = 0xf1;
  }
  else {
    if (param_4 <= uVar6) {
      return 0;
    }
    pbVar1 = param_3 + param_4;
    if (param_2 + 0x3e < pbVar1) {
      return 0;
    }
    for (pbVar4 = param_3 + uVar6; (pbVar4 < pbVar1 && (*pbVar4 == 0)); pbVar4 = pbVar4 + 1) {
    }
    if (pbVar4 != pbVar1) {
      return 0;
    }
    *param_3 = (byte)param_4;
    if ((param_3 <= (byte *)*param_2) && ((byte *)*param_2 < pbVar1)) {
      if (pbVar1 < param_2 + 0x3e) {
        iVar5 = 0;
        *param_2 = (int)pbVar1;
        bVar3 = *pbVar1;
        while (bVar3 == 0) {
          iVar5 = iVar5 + 1;
          bVar3 = pbVar1[iVar5];
        }
        param_2[1] = iVar5;
      }
      else {
        param_2[1] = 0;
        *param_2 = (int)(param_2 + 2);
      }
    }
    *piVar2 = *piVar2 + (uVar6 - param_4);
  }
  return 1;
}



Function: FUN_00407cfc
----------------------------------------

void FUN_00407cfc(void)

{
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_00411544);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_00411534);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_00411524);
  InitializeCriticalSection((LPCRITICAL_SECTION)PTR_DAT_00411504);
  return;
}



Function: FUN_00407d25
----------------------------------------

void __cdecl FUN_00407d25(int param_1)

{
  int *piVar1;
  LPCRITICAL_SECTION lpCriticalSection;
  
  piVar1 = (int *)(&DAT_00411500 + param_1 * 4);
  if (*(int *)(&DAT_00411500 + param_1 * 4) == 0) {
    lpCriticalSection = (LPCRITICAL_SECTION)_malloc(0x18);
    if (lpCriticalSection == (LPCRITICAL_SECTION)0x0) {
      __amsg_exit(0x11);
    }
    FUN_00407d25(0x11);
    if (*piVar1 == 0) {
      InitializeCriticalSection(lpCriticalSection);
      *piVar1 = (int)lpCriticalSection;
    }
    else {
      FUN_00404d98((undefined *)lpCriticalSection);
    }
    FUN_00407d86(0x11);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)*piVar1);
  return;
}



Function: FUN_00407d86
----------------------------------------

void __cdecl FUN_00407d86(int param_1)

{
  LeaveCriticalSection(*(LPCRITICAL_SECTION *)(&DAT_00411500 + param_1 * 4));
  return;
}



Function: FUN_00407d9b
----------------------------------------

undefined4 __cdecl FUN_00407d9b(undefined4 param_1)

{
  int iVar1;
  
  if (DAT_004122a4 != (code *)0x0) {
    iVar1 = (*DAT_004122a4)(param_1);
    if (iVar1 != 0) {
      return 1;
    }
  }
  return 0;
}



Function: FUN_00407e72
----------------------------------------

void __cdecl FUN_00407e72(uint param_1)

{
  if ((0x4115bf < param_1) && (param_1 < 0x411821)) {
    FUN_00407d25(((int)(param_1 - 0x4115c0) >> 5) + 0x1c);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
  return;
}



Function: FUN_00407ea1
----------------------------------------

void __cdecl FUN_00407ea1(int param_1,int param_2)

{
  if (param_1 < 0x14) {
    FUN_00407d25(param_1 + 0x1c);
    return;
  }
  EnterCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x20));
  return;
}



Function: FUN_00407ec4
----------------------------------------

void __cdecl FUN_00407ec4(uint param_1)

{
  if ((0x4115bf < param_1) && (param_1 < 0x411821)) {
    FUN_00407d86(((int)(param_1 - 0x4115c0) >> 5) + 0x1c);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_1 + 0x20));
  return;
}



Function: FUN_00407ef3
----------------------------------------

void __cdecl FUN_00407ef3(int param_1,int param_2)

{
  if (param_1 < 0x14) {
    FUN_00407d86(param_1 + 0x1c);
    return;
  }
  LeaveCriticalSection((LPCRITICAL_SECTION)(param_2 + 0x20));
  return;
}



Function: FUN_00407f16
----------------------------------------

undefined4 __cdecl FUN_00407f16(uint param_1)

{
  undefined4 uVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_004137c0) &&
     ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_0040a376(param_1);
    uVar1 = FUN_00407f73(param_1);
    FUN_0040a3d5(param_1);
    return uVar1;
  }
  pDVar2 = FUN_00405095();
  *pDVar2 = 9;
  pDVar2 = FUN_0040509e();
  *pDVar2 = 0;
  return 0xffffffff;
}



Function: FUN_00407f73
----------------------------------------

undefined4 __cdecl FUN_00407f73(uint param_1)

{
  int iVar1;
  int iVar2;
  HANDLE hObject;
  BOOL BVar3;
  DWORD DVar4;
  undefined4 uVar5;
  
  iVar1 = FUN_0040a334(param_1);
  if (iVar1 != -1) {
    if ((param_1 == 1) || (param_1 == 2)) {
      iVar1 = FUN_0040a334(2);
      iVar2 = FUN_0040a334(1);
      if (iVar2 == iVar1) goto LAB_00407fc1;
    }
    hObject = (HANDLE)FUN_0040a334(param_1);
    BVar3 = CloseHandle(hObject);
    if (BVar3 == 0) {
      DVar4 = GetLastError();
      goto LAB_00407fc3;
    }
  }
LAB_00407fc1:
  DVar4 = 0;
LAB_00407fc3:
  FUN_0040a2b5(param_1);
  *(undefined1 *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) = 0;
  if (DVar4 == 0) {
    uVar5 = 0;
  }
  else {
    FUN_00405022(DVar4);
    uVar5 = 0xffffffff;
  }
  return uVar5;
}



Function: __freebuf
----------------------------------------

/* Library Function - Single Match
    __freebuf
   
   Library: Visual Studio 2003 Release */

void __cdecl __freebuf(FILE *_File)

{
  if (((_File->_flag & 0x83U) != 0) && ((_File->_flag & 8U) != 0)) {
    FUN_00404d98(_File->_base);
    *(ushort *)&_File->_flag = (ushort)_File->_flag & 0xfbf7;
    _File->_ptr = (char *)0x0;
    _File->_base = (char *)0x0;
    _File->_cnt = 0;
  }
  return;
}



Function: FUN_00408021
----------------------------------------

uint __cdecl FUN_00408021(undefined4 *param_1)

{
  byte bVar1;
  uint uVar2;
  int iVar3;
  undefined *puVar4;
  
  uVar2 = param_1[3];
  if (((uVar2 & 0x83) != 0) && ((uVar2 & 0x40) == 0)) {
    if ((uVar2 & 2) == 0) {
      param_1[3] = uVar2 | 1;
      if ((uVar2 & 0x10c) == 0) {
        FUN_0040a3f7(param_1);
      }
      else {
        *param_1 = param_1[2];
      }
      iVar3 = FUN_004080fd(param_1[4],(char *)param_1[2],(char *)param_1[6]);
      param_1[1] = iVar3;
      if ((iVar3 != 0) && (iVar3 != -1)) {
        if ((param_1[3] & 0x82) == 0) {
          uVar2 = param_1[4];
          if (uVar2 == 0xffffffff) {
            puVar4 = &DAT_0040f408;
          }
          else {
            puVar4 = (undefined *)((&DAT_004136c0)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 0x24);
          }
          if ((puVar4[4] & 0x82) == 0x82) {
            param_1[3] = param_1[3] | 0x2000;
          }
        }
        if (((param_1[6] == 0x200) && ((param_1[3] & 8) != 0)) && ((param_1[3] & 0x400) == 0)) {
          param_1[6] = 0x1000;
        }
        param_1[1] = iVar3 + -1;
        bVar1 = *(byte *)*param_1;
        *param_1 = (byte *)*param_1 + 1;
        return (uint)bVar1;
      }
      param_1[3] = param_1[3] | (-(uint)(iVar3 != 0) & 0x10) + 0x10;
      param_1[1] = 0;
    }
    else {
      param_1[3] = uVar2 | 0x20;
    }
  }
  return 0xffffffff;
}



Function: FUN_004080fd
----------------------------------------

int __cdecl FUN_004080fd(uint param_1,char *param_2,char *param_3)

{
  int iVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_004137c0) &&
     ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_0040a376(param_1);
    iVar1 = FUN_00408162(param_1,param_2,param_3);
    FUN_0040a3d5(param_1);
    return iVar1;
  }
  pDVar2 = FUN_00405095();
  *pDVar2 = 9;
  pDVar2 = FUN_0040509e();
  *pDVar2 = 0;
  return -1;
}



Function: FUN_00408162
----------------------------------------

int __cdecl FUN_00408162(uint param_1,char *param_2,char *param_3)

{
  int *piVar1;
  byte *pbVar2;
  char cVar3;
  byte bVar4;
  BOOL BVar5;
  DWORD DVar6;
  DWORD *pDVar7;
  char *pcVar8;
  int iVar9;
  DWORD local_10;
  char *local_c;
  char local_5;
  
  local_c = (char *)0x0;
  if (param_3 != (char *)0x0) {
    piVar1 = &DAT_004136c0 + ((int)param_1 >> 5);
    iVar9 = (param_1 & 0x1f) * 0x24;
    bVar4 = *(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + iVar9 + 4);
    if ((bVar4 & 2) == 0) {
      pcVar8 = param_2;
      if (((bVar4 & 0x48) != 0) &&
         (cVar3 = *(char *)((&DAT_004136c0)[(int)param_1 >> 5] + iVar9 + 5), cVar3 != '\n')) {
        param_3 = param_3 + -1;
        *param_2 = cVar3;
        pcVar8 = param_2 + 1;
        local_c = (char *)0x1;
        *(undefined1 *)(*piVar1 + 5 + iVar9) = 10;
      }
      BVar5 = ReadFile(*(HANDLE *)(*piVar1 + iVar9),pcVar8,(DWORD)param_3,&local_10,
                       (LPOVERLAPPED)0x0);
      if (BVar5 == 0) {
        DVar6 = GetLastError();
        if (DVar6 == 5) {
          pDVar7 = FUN_00405095();
          *pDVar7 = 9;
          pDVar7 = FUN_0040509e();
          *pDVar7 = 5;
        }
        else {
          if (DVar6 == 0x6d) {
            return 0;
          }
          FUN_00405022(DVar6);
        }
        return -1;
      }
      bVar4 = *(byte *)(*piVar1 + 4 + iVar9);
      if ((bVar4 & 0x80) == 0) {
        return (int)local_c + local_10;
      }
      if ((local_10 == 0) || (*param_2 != '\n')) {
        bVar4 = bVar4 & 0xfb;
      }
      else {
        bVar4 = bVar4 | 4;
      }
      *(byte *)(*piVar1 + 4 + iVar9) = bVar4;
      param_3 = param_2;
      local_c = param_2 + (int)local_c + local_10;
      pcVar8 = param_2;
      if (param_2 < local_c) {
        do {
          cVar3 = *param_3;
          if (cVar3 == '\x1a') {
            pbVar2 = (byte *)(*piVar1 + 4 + iVar9);
            bVar4 = *pbVar2;
            if ((bVar4 & 0x40) == 0) {
              *pbVar2 = bVar4 | 2;
            }
            break;
          }
          if (cVar3 == '\r') {
            if (param_3 < local_c + -1) {
              if (param_3[1] == '\n') {
                param_3 = param_3 + 2;
                goto LAB_004082ed;
              }
              *pcVar8 = '\r';
              pcVar8 = pcVar8 + 1;
              param_3 = param_3 + 1;
            }
            else {
              param_3 = param_3 + 1;
              BVar5 = ReadFile(*(HANDLE *)(*piVar1 + iVar9),&local_5,1,&local_10,(LPOVERLAPPED)0x0);
              if (((BVar5 == 0) && (DVar6 = GetLastError(), DVar6 != 0)) || (local_10 == 0)) {
LAB_00408307:
                *pcVar8 = '\r';
LAB_0040830a:
                pcVar8 = pcVar8 + 1;
              }
              else if ((*(byte *)(*piVar1 + 4 + iVar9) & 0x48) == 0) {
                if ((pcVar8 == param_2) && (local_5 == '\n')) {
LAB_004082ed:
                  *pcVar8 = '\n';
                  goto LAB_0040830a;
                }
                FUN_004083a0(param_1,-1,1);
                if (local_5 != '\n') goto LAB_00408307;
              }
              else {
                if (local_5 == '\n') goto LAB_004082ed;
                *pcVar8 = '\r';
                pcVar8 = pcVar8 + 1;
                *(char *)(*piVar1 + 5 + iVar9) = local_5;
              }
            }
          }
          else {
            *pcVar8 = cVar3;
            pcVar8 = pcVar8 + 1;
            param_3 = param_3 + 1;
          }
        } while (param_3 < local_c);
      }
      return (int)pcVar8 - (int)param_2;
    }
  }
  return 0;
}



Function: FUN_0040833b
----------------------------------------

DWORD __cdecl FUN_0040833b(uint param_1,LONG param_2,DWORD param_3)

{
  DWORD DVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_004137c0) &&
     ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_0040a376(param_1);
    DVar1 = FUN_004083a0(param_1,param_2,param_3);
    FUN_0040a3d5(param_1);
    return DVar1;
  }
  pDVar2 = FUN_00405095();
  *pDVar2 = 9;
  pDVar2 = FUN_0040509e();
  *pDVar2 = 0;
  return 0xffffffff;
}



Function: FUN_004083a0
----------------------------------------

DWORD __cdecl FUN_004083a0(uint param_1,LONG param_2,DWORD param_3)

{
  byte *pbVar1;
  HANDLE hFile;
  DWORD *pDVar2;
  DWORD DVar3;
  uint uVar4;
  
  hFile = (HANDLE)FUN_0040a334(param_1);
  if (hFile == (HANDLE)0xffffffff) {
    pDVar2 = FUN_00405095();
    *pDVar2 = 9;
  }
  else {
    DVar3 = SetFilePointer(hFile,param_2,(PLONG)0x0,param_3);
    if (DVar3 == 0xffffffff) {
      uVar4 = GetLastError();
    }
    else {
      uVar4 = 0;
    }
    if (uVar4 == 0) {
      pbVar1 = (byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
      *pbVar1 = *pbVar1 & 0xfd;
      return DVar3;
    }
    FUN_00405022(uVar4);
  }
  return 0xffffffff;
}



Function: FUN_00408413
----------------------------------------

uint __cdecl FUN_00408413(uint param_1,int *param_2)

{
  uint uVar1;
  uint uVar2;
  char *pcVar3;
  int *piVar4;
  byte bVar5;
  undefined3 extraout_var;
  undefined *puVar6;
  int *piVar7;
  
  piVar4 = param_2;
  uVar1 = param_2[3];
  uVar2 = param_2[4];
  if (((uVar1 & 0x82) == 0) || ((uVar1 & 0x40) != 0)) {
LAB_0040851f:
    param_2[3] = uVar1 | 0x20;
  }
  else {
    if ((uVar1 & 1) != 0) {
      param_2[1] = 0;
      if ((uVar1 & 0x10) == 0) goto LAB_0040851f;
      *param_2 = param_2[2];
      param_2[3] = uVar1 & 0xfffffffe;
    }
    uVar1 = param_2[3];
    param_2[1] = 0;
    param_2 = (int *)0x0;
    piVar4[3] = uVar1 & 0xffffffef | 2;
    if (((uVar1 & 0x10c) == 0) &&
       (((piVar4 != (int *)&DAT_004115e0 && (piVar4 != (int *)&DAT_00411600)) ||
        (bVar5 = FUN_0040a43b(uVar2), CONCAT31(extraout_var,bVar5) == 0)))) {
      FUN_0040a3f7(piVar4);
    }
    if ((*(ushort *)(piVar4 + 3) & 0x108) == 0) {
      piVar7 = (int *)0x1;
      param_2 = (int *)FUN_0040852b(uVar2,(char *)&param_1,1);
    }
    else {
      pcVar3 = (char *)piVar4[2];
      piVar7 = (int *)(*piVar4 - (int)pcVar3);
      *piVar4 = (int)(pcVar3 + 1);
      piVar4[1] = piVar4[6] + -1;
      if ((int)piVar7 < 1) {
        if (uVar2 == 0xffffffff) {
          puVar6 = &DAT_0040f408;
        }
        else {
          puVar6 = (undefined *)((&DAT_004136c0)[(int)uVar2 >> 5] + (uVar2 & 0x1f) * 0x24);
        }
        if ((puVar6[4] & 0x20) != 0) {
          FUN_0040833b(uVar2,0,2);
        }
      }
      else {
        param_2 = (int *)FUN_0040852b(uVar2,pcVar3,(uint)piVar7);
      }
      *(undefined1 *)piVar4[2] = (undefined1)param_1;
    }
    if (param_2 == piVar7) {
      return param_1 & 0xff;
    }
    piVar4[3] = piVar4[3] | 0x20;
  }
  return 0xffffffff;
}



Function: FUN_0040852b
----------------------------------------

int __cdecl FUN_0040852b(uint param_1,char *param_2,uint param_3)

{
  int iVar1;
  DWORD *pDVar2;
  
  if ((param_1 < DAT_004137c0) &&
     ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    FUN_0040a376(param_1);
    iVar1 = FUN_00408590(param_1,param_2,param_3);
    FUN_0040a3d5(param_1);
    return iVar1;
  }
  pDVar2 = FUN_00405095();
  *pDVar2 = 9;
  pDVar2 = FUN_0040509e();
  *pDVar2 = 0;
  return -1;
}



Function: FUN_00408590
----------------------------------------

int __cdecl FUN_00408590(DWORD param_1,char *param_2,uint param_3)

{
  int *piVar1;
  char *pcVar2;
  char cVar3;
  int iVar4;
  char *pcVar5;
  BOOL BVar6;
  DWORD *pDVar7;
  char local_418 [1028];
  int local_14;
  DWORD local_10;
  DWORD local_c;
  char *local_8;
  
  local_c = 0;
  local_14 = 0;
  if (param_3 == 0) {
LAB_004085a9:
    iVar4 = 0;
  }
  else {
    piVar1 = &DAT_004136c0 + ((int)param_1 >> 5);
    iVar4 = (param_1 & 0x1f) * 0x24;
    if ((*(byte *)(*piVar1 + 4 + iVar4) & 0x20) != 0) {
      FUN_004083a0(param_1,0,2);
    }
    if ((*(byte *)((undefined4 *)(*piVar1 + iVar4) + 1) & 0x80) == 0) {
      BVar6 = WriteFile(*(HANDLE *)(*piVar1 + iVar4),param_2,param_3,&local_10,(LPOVERLAPPED)0x0);
      if (BVar6 == 0) {
        param_1 = GetLastError();
      }
      else {
        local_c = local_10;
        param_1 = 0;
      }
LAB_00408678:
      if (local_c != 0) {
        return local_c - local_14;
      }
      if (param_1 == 0) goto LAB_004086ea;
      if (param_1 == 5) {
        pDVar7 = FUN_00405095();
        *pDVar7 = 9;
        pDVar7 = FUN_0040509e();
        *pDVar7 = 5;
      }
      else {
        FUN_00405022(param_1);
      }
    }
    else {
      local_8 = param_2;
      param_1 = 0;
      if (param_3 != 0) {
        do {
          pcVar5 = local_418;
          do {
            if (param_3 <= (uint)((int)local_8 - (int)param_2)) break;
            pcVar2 = local_8 + 1;
            cVar3 = *local_8;
            local_8 = pcVar2;
            if (cVar3 == '\n') {
              local_14 = local_14 + 1;
              *pcVar5 = '\r';
              pcVar5 = pcVar5 + 1;
            }
            *pcVar5 = cVar3;
            pcVar5 = pcVar5 + 1;
          } while ((int)pcVar5 - (int)local_418 < 0x400);
          BVar6 = WriteFile(*(HANDLE *)(*piVar1 + iVar4),local_418,(int)pcVar5 - (int)local_418,
                            &local_10,(LPOVERLAPPED)0x0);
          if (BVar6 == 0) {
            param_1 = GetLastError();
            goto LAB_00408678;
          }
          local_c = local_c + local_10;
          if (((int)local_10 < (int)pcVar5 - (int)local_418) ||
             (param_3 <= (uint)((int)local_8 - (int)param_2))) goto LAB_00408678;
        } while( true );
      }
LAB_004086ea:
      if (((*(byte *)(*piVar1 + 4 + iVar4) & 0x40) != 0) && (*param_2 == '\x1a')) goto LAB_004085a9;
      pDVar7 = FUN_00405095();
      *pDVar7 = 0x1c;
      pDVar7 = FUN_0040509e();
      *pDVar7 = 0;
    }
    iVar4 = -1;
  }
  return iVar4;
}



Function: FUN_0040871b
----------------------------------------

DWORD __cdecl FUN_0040871b(uint param_1)

{
  HANDLE hFile;
  BOOL BVar1;
  DWORD DVar2;
  DWORD *pDVar3;
  int iVar4;
  
  if (DAT_004137c0 <= param_1) {
LAB_0040879c:
    pDVar3 = FUN_00405095();
    *pDVar3 = 9;
    return 0xffffffff;
  }
  iVar4 = (param_1 & 0x1f) * 0x24;
  if ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + iVar4) & 1) == 0) goto LAB_0040879c;
  FUN_0040a376(param_1);
  if ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + iVar4) & 1) != 0) {
    hFile = (HANDLE)FUN_0040a334(param_1);
    BVar1 = FlushFileBuffers(hFile);
    if (BVar1 == 0) {
      DVar2 = GetLastError();
    }
    else {
      DVar2 = 0;
    }
    if (DVar2 == 0) goto LAB_00408791;
    pDVar3 = FUN_0040509e();
    *pDVar3 = DVar2;
  }
  pDVar3 = FUN_00405095();
  *pDVar3 = 9;
  DVar2 = 0xffffffff;
LAB_00408791:
  FUN_0040a3d5(param_1);
  return DVar2;
}



Function: FUN_004087ae
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 * __cdecl FUN_004087ae(LPCSTR param_1,char *param_2,uint param_3,undefined4 *param_4)

{
  char cVar1;
  bool bVar2;
  bool bVar3;
  bool bVar4;
  uint uVar5;
  uint uVar6;
  
  bVar4 = false;
  bVar3 = false;
  cVar1 = *param_2;
  if (cVar1 == 'a') {
    uVar5 = 0x109;
  }
  else {
    if (cVar1 == 'r') {
      uVar5 = 0;
      uVar6 = DAT_004122bc | 1;
      goto LAB_004087ef;
    }
    if (cVar1 != 'w') {
      return (undefined4 *)0x0;
    }
    uVar5 = 0x301;
  }
  uVar6 = DAT_004122bc | 2;
LAB_004087ef:
  bVar2 = true;
LAB_004087f2:
  cVar1 = param_2[1];
  param_2 = param_2 + 1;
  if ((cVar1 == '\0') || (!bVar2)) {
    uVar5 = FUN_0040a464(param_1,uVar5,param_3,0x1a4);
    if ((int)uVar5 < 0) {
      return (undefined4 *)0x0;
    }
    _DAT_004122a8 = _DAT_004122a8 + 1;
    param_4[3] = uVar6;
    param_4[1] = 0;
    *param_4 = 0;
    param_4[2] = 0;
    param_4[7] = 0;
    param_4[4] = uVar5;
    return param_4;
  }
  if (cVar1 < 'U') {
    if (cVar1 == 'T') {
      if ((uVar5 & 0x1000) == 0) {
        uVar5 = uVar5 | 0x1000;
        goto LAB_004087f2;
      }
    }
    else if (cVar1 == '+') {
      if ((uVar5 & 2) == 0) {
        uVar5 = uVar5 & 0xfffffffe | 2;
        uVar6 = uVar6 & 0xfffffffc | 0x80;
        goto LAB_004087f2;
      }
    }
    else if (cVar1 == 'D') {
      if ((uVar5 & 0x40) == 0) {
        uVar5 = uVar5 | 0x40;
        goto LAB_004087f2;
      }
    }
    else if (cVar1 == 'R') {
      if (!bVar3) {
        bVar3 = true;
        uVar5 = uVar5 | 0x10;
        goto LAB_004087f2;
      }
    }
    else if ((cVar1 == 'S') && (!bVar3)) {
      bVar3 = true;
      uVar5 = uVar5 | 0x20;
      goto LAB_004087f2;
    }
  }
  else {
    if (cVar1 == 'b') {
      if ((uVar5 & 0xc000) != 0) goto LAB_004088d2;
      uVar5 = uVar5 | 0x8000;
      goto LAB_004087f2;
    }
    if (cVar1 == 'c') {
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 | 0x4000;
        goto LAB_004087f2;
      }
    }
    else {
      if (cVar1 != 'n') {
        if ((cVar1 != 't') || ((uVar5 & 0xc000) != 0)) goto LAB_004088d2;
        uVar5 = uVar5 | 0x4000;
        goto LAB_004087f2;
      }
      if (!bVar4) {
        bVar4 = true;
        uVar6 = uVar6 & 0xffffbfff;
        goto LAB_004087f2;
      }
    }
  }
LAB_004088d2:
  bVar2 = false;
  goto LAB_004087f2;
}



Function: FUN_0040891e
----------------------------------------

undefined4 * FUN_0040891e(void)

{
  int iVar1;
  void *pvVar2;
  int iVar3;
  undefined4 *puVar4;
  
  puVar4 = (undefined4 *)0x0;
  FUN_00407d25(2);
  iVar3 = 0;
  if (0 < DAT_00413680) {
    do {
      iVar1 = *(int *)(DAT_00412668 + iVar3 * 4);
      if (iVar1 == 0) {
        iVar3 = iVar3 * 4;
        pvVar2 = _malloc(0x38);
        *(void **)(iVar3 + DAT_00412668) = pvVar2;
        if (*(int *)(iVar3 + DAT_00412668) != 0) {
          InitializeCriticalSection((LPCRITICAL_SECTION)(*(int *)(iVar3 + DAT_00412668) + 0x20));
          EnterCriticalSection((LPCRITICAL_SECTION)(*(int *)(iVar3 + DAT_00412668) + 0x20));
          puVar4 = *(undefined4 **)(iVar3 + DAT_00412668);
LAB_004089c2:
          if (puVar4 != (undefined4 *)0x0) {
            puVar4[4] = 0xffffffff;
            puVar4[1] = 0;
            puVar4[3] = 0;
            puVar4[2] = 0;
            *puVar4 = 0;
            puVar4[7] = 0;
          }
        }
        break;
      }
      if ((*(byte *)(iVar1 + 0xc) & 0x83) == 0) {
        FUN_00407ea1(iVar3,iVar1);
        iVar1 = *(int *)(DAT_00412668 + iVar3 * 4);
        if ((*(byte *)(iVar1 + 0xc) & 0x83) == 0) {
          puVar4 = *(undefined4 **)(DAT_00412668 + iVar3 * 4);
          goto LAB_004089c2;
        }
        FUN_00407ef3(iVar3,iVar1);
      }
      iVar3 = iVar3 + 1;
    } while (iVar3 < DAT_00413680);
  }
  FUN_00407d86(2);
  return puVar4;
}



Function: FUN_004089e6
----------------------------------------

int __cdecl FUN_004089e6(int *param_1,byte *param_2,undefined4 *param_3)

{
  int iVar1;
  uint uVar2;
  WCHAR *pWVar3;
  WCHAR *pWVar4;
  undefined4 uVar5;
  short *psVar6;
  int *piVar7;
  LPSTR pCVar8;
  byte bVar9;
  int iVar10;
  uint uVar11;
  LPSTR pCVar12;
  ulonglong uVar13;
  undefined8 uVar14;
  ulonglong uVar15;
  undefined1 local_24c [511];
  undefined1 local_4d;
  undefined4 local_4c;
  undefined4 local_48;
  uint local_44;
  uint local_40;
  CHAR local_3c [4];
  undefined4 local_38;
  int local_34;
  int local_30;
  int local_2c;
  int local_28;
  int local_24;
  int local_20;
  char local_1a;
  char local_19;
  int local_18;
  int local_14;
  LPSTR local_10;
  WCHAR *local_c;
  uint local_8;
  
  local_34 = 0;
  bVar9 = *param_2;
  param_2 = param_2 + 1;
  local_10 = (LPSTR)0x0;
  local_18 = 0;
  do {
    if ((bVar9 == 0) || (local_18 < 0)) {
      return local_18;
    }
    if (((char)bVar9 < ' ') || ('x' < (char)bVar9)) {
      uVar2 = 0;
    }
    else {
      uVar2 = (byte)"Runtime Error!\n\nProgram: "[(char)bVar9 + 0x18] & 0xf;
    }
    local_34 = (int)(char)(&DAT_0040d4c0)[uVar2 * 8 + local_34] >> 4;
    switch(local_34) {
    case 0:
switchD_00408a54_caseD_0:
      local_28 = 0;
      if ((PTR_DAT_00411848[(uint)bVar9 * 2 + 1] & 0x80) != 0) {
        FUN_00409127((int)(char)bVar9,param_1,&local_18);
        bVar9 = *param_2;
        param_2 = param_2 + 1;
      }
      FUN_00409127((int)(char)bVar9,param_1,&local_18);
      break;
    case 1:
      local_14 = -1;
      local_38 = 0;
      local_2c = 0;
      local_24 = 0;
      local_20 = 0;
      local_8 = 0;
      local_28 = 0;
      break;
    case 2:
      if (bVar9 == 0x20) {
        local_8 = local_8 | 2;
      }
      else if (bVar9 == 0x23) {
        local_8 = local_8 | 0x80;
      }
      else if (bVar9 == 0x2b) {
        local_8 = local_8 | 1;
      }
      else if (bVar9 == 0x2d) {
        local_8 = local_8 | 4;
      }
      else if (bVar9 == 0x30) {
        local_8 = local_8 | 8;
      }
      break;
    case 3:
      if (bVar9 == 0x2a) {
        local_24 = FUN_004091c5((int *)&param_3);
        if (local_24 < 0) {
          local_8 = local_8 | 4;
          local_24 = -local_24;
        }
      }
      else {
        local_24 = (char)bVar9 + -0x30 + local_24 * 10;
      }
      break;
    case 4:
      local_14 = 0;
      break;
    case 5:
      if (bVar9 == 0x2a) {
        local_14 = FUN_004091c5((int *)&param_3);
        if (local_14 < 0) {
          local_14 = -1;
        }
      }
      else {
        local_14 = (char)bVar9 + -0x30 + local_14 * 10;
      }
      break;
    case 6:
      if (bVar9 == 0x49) {
        if ((*param_2 != 0x36) || (param_2[1] != 0x34)) {
          local_34 = 0;
          goto switchD_00408a54_caseD_0;
        }
        param_2 = param_2 + 2;
        local_8 = local_8 | 0x8000;
      }
      else if (bVar9 == 0x68) {
        local_8 = local_8 | 0x20;
      }
      else if (bVar9 == 0x6c) {
        local_8 = local_8 | 0x10;
      }
      else if (bVar9 == 0x77) {
        local_8 = local_8 | 0x800;
      }
      break;
    case 7:
      pWVar4 = local_c;
      if ((char)bVar9 < 'h') {
        if ((char)bVar9 < 'e') {
          if ((char)bVar9 < 'Y') {
            if (bVar9 == 0x58) {
LAB_00408e65:
              local_30 = 7;
LAB_00408e6c:
              local_10 = (LPSTR)0x10;
              if ((local_8 & 0x80) != 0) {
                local_1a = '0';
                local_19 = (char)local_30 + 'Q';
                local_20 = 2;
              }
              goto LAB_00408ed6;
            }
            if (bVar9 != 0x43) {
              if ((bVar9 != 0x45) && (bVar9 != 0x47)) {
                if (bVar9 == 0x53) {
                  if ((local_8 & 0x830) == 0) {
                    local_8 = local_8 | 0x800;
                  }
                  goto LAB_00408c13;
                }
                goto LAB_00408ff0;
              }
              local_38 = 1;
              bVar9 = bVar9 + 0x20;
              goto LAB_00408c74;
            }
            if ((local_8 & 0x830) == 0) {
              local_8 = local_8 | 0x800;
            }
LAB_00408ca1:
            if ((local_8 & 0x810) == 0) {
              uVar5 = FUN_004091c5((int *)&param_3);
              local_24c[0] = (char)uVar5;
              local_10 = (LPSTR)0x1;
            }
            else {
              uVar5 = FUN_004091e2((int *)&param_3);
              local_10 = FUN_0040a733(local_24c,(WCHAR)uVar5);
              if ((int)local_10 < 0) {
                local_2c = 1;
              }
            }
            pWVar4 = (WCHAR *)local_24c;
          }
          else if (bVar9 == 0x5a) {
            psVar6 = (short *)FUN_004091c5((int *)&param_3);
            if ((psVar6 == (short *)0x0) ||
               (pWVar4 = *(WCHAR **)(psVar6 + 2), pWVar4 == (WCHAR *)0x0)) {
              local_c = (WCHAR *)PTR_s__null__00411840;
              pWVar4 = (WCHAR *)PTR_s__null__00411840;
              goto LAB_00408de6;
            }
            if ((local_8 & 0x800) == 0) {
              local_28 = 0;
              local_10 = (LPSTR)(int)*psVar6;
            }
            else {
              local_28 = 1;
              local_10 = (LPSTR)((uint)(int)*psVar6 >> 1);
            }
          }
          else {
            if (bVar9 == 99) goto LAB_00408ca1;
            if (bVar9 == 100) goto LAB_00408ecb;
          }
        }
        else {
LAB_00408c74:
          local_8 = local_8 | 0x40;
          pWVar4 = (WCHAR *)local_24c;
          if (local_14 < 0) {
            local_14 = 6;
          }
          else if ((local_14 == 0) && (bVar9 == 0x67)) {
            local_14 = 1;
          }
          local_4c = *param_3;
          local_48 = param_3[1];
          param_3 = param_3 + 2;
          local_c = pWVar4;
          (*(code *)PTR_FUN_00411b60)(&local_4c,local_24c,(int)(char)bVar9,local_14,local_38);
          uVar2 = local_8 & 0x80;
          if ((uVar2 != 0) && (local_14 == 0)) {
            (*(code *)PTR_FUN_00411b6c)(local_24c);
          }
          if ((bVar9 == 0x67) && (uVar2 == 0)) {
            (*(code *)PTR_FUN_00411b64)(local_24c);
          }
          if (local_24c[0] == '-') {
            local_8 = local_8 | 0x100;
            pWVar4 = (WCHAR *)(local_24c + 1);
            local_c = pWVar4;
          }
LAB_00408de6:
          local_10 = (LPSTR)_strlen((char *)pWVar4);
          pWVar4 = local_c;
        }
      }
      else {
        if (bVar9 == 0x69) {
LAB_00408ecb:
          local_8 = local_8 | 0x40;
        }
        else {
          if (bVar9 == 0x6e) {
            piVar7 = (int *)FUN_004091c5((int *)&param_3);
            if ((local_8 & 0x20) == 0) {
              *piVar7 = local_18;
            }
            else {
              *(undefined2 *)piVar7 = (undefined2)local_18;
            }
            local_2c = 1;
            break;
          }
          if (bVar9 == 0x6f) {
            local_10 = (LPSTR)0x8;
            if ((local_8 & 0x80) != 0) {
              local_8 = local_8 | 0x200;
            }
            goto LAB_00408ed6;
          }
          if (bVar9 == 0x70) {
            local_14 = 8;
            goto LAB_00408e65;
          }
          if (bVar9 == 0x73) {
LAB_00408c13:
            iVar10 = local_14;
            if (local_14 == -1) {
              iVar10 = 0x7fffffff;
            }
            pWVar3 = (WCHAR *)FUN_004091c5((int *)&param_3);
            if ((local_8 & 0x810) == 0) {
              pWVar4 = pWVar3;
              if (pWVar3 == (WCHAR *)0x0) {
                pWVar3 = (WCHAR *)PTR_s__null__00411840;
                pWVar4 = (WCHAR *)PTR_s__null__00411840;
              }
              for (; (iVar10 != 0 && ((char)*pWVar3 != '\0')); pWVar3 = (WCHAR *)((int)pWVar3 + 1))
              {
                iVar10 = iVar10 + -1;
              }
              local_10 = (LPSTR)((int)pWVar3 - (int)pWVar4);
            }
            else {
              if (pWVar3 == (WCHAR *)0x0) {
                pWVar3 = (WCHAR *)PTR_DAT_00411844;
              }
              local_28 = 1;
              for (pWVar4 = pWVar3; (iVar10 != 0 && (*pWVar4 != L'\0')); pWVar4 = pWVar4 + 1) {
                iVar10 = iVar10 + -1;
              }
              local_10 = (LPSTR)((int)pWVar4 - (int)pWVar3 >> 1);
              pWVar4 = pWVar3;
            }
            goto LAB_00408ff0;
          }
          if (bVar9 != 0x75) {
            if (bVar9 != 0x78) goto LAB_00408ff0;
            local_30 = 0x27;
            goto LAB_00408e6c;
          }
        }
        local_10 = (LPSTR)0xa;
LAB_00408ed6:
        if ((local_8 & 0x8000) == 0) {
          if ((local_8 & 0x20) == 0) {
            if ((local_8 & 0x40) == 0) {
              uVar2 = FUN_004091c5((int *)&param_3);
              uVar13 = (ulonglong)uVar2;
              goto LAB_00408f29;
            }
            uVar2 = FUN_004091c5((int *)&param_3);
          }
          else if ((local_8 & 0x40) == 0) {
            uVar2 = FUN_004091c5((int *)&param_3);
            uVar2 = uVar2 & 0xffff;
          }
          else {
            uVar5 = FUN_004091c5((int *)&param_3);
            uVar2 = (uint)(short)uVar5;
          }
          uVar13 = (ulonglong)(int)uVar2;
        }
        else {
          uVar13 = FUN_004091d2((int *)&param_3);
        }
LAB_00408f29:
        iVar10 = (int)(uVar13 >> 0x20);
        if ((((local_8 & 0x40) != 0) && (iVar10 == 0 || (longlong)uVar13 < 0)) &&
           ((longlong)uVar13 < 0)) {
          local_8 = local_8 | 0x100;
          uVar13 = CONCAT44(-(iVar10 + (uint)((int)uVar13 != 0)),-(int)uVar13);
        }
        uVar2 = (uint)(uVar13 >> 0x20);
        uVar15 = uVar13 & 0xffffffff;
        if ((local_8 & 0x8000) == 0) {
          uVar2 = 0;
        }
        if (local_14 < 0) {
          local_14 = 1;
        }
        else {
          local_8 = local_8 & 0xfffffff7;
        }
        if ((int)uVar13 == 0 && uVar2 == 0) {
          local_20 = 0;
        }
        local_c = (WCHAR *)&local_4d;
        while( true ) {
          uVar11 = (uint)uVar15;
          iVar10 = local_14 + -1;
          if ((local_14 < 1) && (uVar11 == 0 && uVar2 == 0)) break;
          local_40 = (int)local_10 >> 0x1f;
          local_44 = (uint)local_10;
          local_14 = iVar10;
          uVar14 = __aullrem(uVar11,uVar2,(uint)local_10,local_40);
          iVar10 = (int)uVar14 + 0x30;
          uVar15 = __aulldiv(uVar11,uVar2,local_44,local_40);
          uVar2 = (uint)(uVar15 >> 0x20);
          if (0x39 < iVar10) {
            iVar10 = iVar10 + local_30;
          }
          pWVar4 = (WCHAR *)((int)local_c + -1);
          *(char *)local_c = (char)iVar10;
          local_c = pWVar4;
        }
        iVar1 = -(int)local_c;
        local_10 = &local_4d + iVar1;
        pWVar4 = (WCHAR *)((int)local_c + 1);
        local_14 = iVar10;
        if (((local_8 & 0x200) != 0) && ((*(char *)pWVar4 != '0' || (local_10 == (LPSTR)0x0)))) {
          *(char *)local_c = '0';
          local_10 = (LPSTR)((int)&local_4c + iVar1);
          pWVar4 = local_c;
        }
      }
LAB_00408ff0:
      local_c = pWVar4;
      uVar2 = local_8;
      if (local_2c == 0) {
        if ((local_8 & 0x40) != 0) {
          if ((local_8 & 0x100) == 0) {
            if ((local_8 & 1) == 0) {
              if ((local_8 & 2) == 0) goto LAB_00409028;
              local_1a = ' ';
            }
            else {
              local_1a = '+';
            }
          }
          else {
            local_1a = '-';
          }
          local_20 = 1;
        }
LAB_00409028:
        iVar10 = (local_24 - local_20) - (int)local_10;
        if ((local_8 & 0xc) == 0) {
          FUN_0040915c(0x20,iVar10,param_1,&local_18);
        }
        FUN_0040918d(&local_1a,local_20,param_1,&local_18);
        if (((uVar2 & 8) != 0) && ((uVar2 & 4) == 0)) {
          FUN_0040915c(0x30,iVar10,param_1,&local_18);
        }
        if ((local_28 == 0) || (pCVar12 = local_10, pWVar4 = local_c, (int)local_10 < 1)) {
          FUN_0040918d((char *)local_c,(int)local_10,param_1,&local_18);
        }
        else {
          do {
            pCVar12 = pCVar12 + -1;
            pCVar8 = FUN_0040a733(local_3c,*pWVar4);
            if ((int)pCVar8 < 1) break;
            FUN_0040918d(local_3c,(int)pCVar8,param_1,&local_18);
            pWVar4 = pWVar4 + 1;
          } while (pCVar12 != (LPSTR)0x0);
        }
        if ((local_8 & 4) != 0) {
          FUN_0040915c(0x20,iVar10,param_1,&local_18);
        }
      }
    }
    bVar9 = *param_2;
    param_2 = param_2 + 1;
  } while( true );
}



Function: FUN_00409127
----------------------------------------

void __cdecl FUN_00409127(uint param_1,int *param_2,int *param_3)

{
  int *piVar1;
  uint uVar2;
  
  piVar1 = param_2 + 1;
  *piVar1 = *piVar1 + -1;
  if (*piVar1 < 0) {
    uVar2 = FUN_00408413(param_1,param_2);
  }
  else {
    *(undefined1 *)*param_2 = (undefined1)param_1;
    *param_2 = *param_2 + 1;
    uVar2 = param_1 & 0xff;
  }
  if (uVar2 == 0xffffffff) {
    *param_3 = -1;
    return;
  }
  *param_3 = *param_3 + 1;
  return;
}



Function: FUN_0040915c
----------------------------------------

void __cdecl FUN_0040915c(uint param_1,int param_2,int *param_3,int *param_4)

{
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      FUN_00409127(param_1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



Function: FUN_0040918d
----------------------------------------

void __cdecl FUN_0040918d(char *param_1,int param_2,int *param_3,int *param_4)

{
  char cVar1;
  
  if (0 < param_2) {
    do {
      param_2 = param_2 + -1;
      cVar1 = *param_1;
      param_1 = param_1 + 1;
      FUN_00409127((int)cVar1,param_3,param_4);
      if (*param_4 == -1) {
        return;
      }
    } while (0 < param_2);
  }
  return;
}



Function: FUN_004091c5
----------------------------------------

undefined4 __cdecl FUN_004091c5(int *param_1)

{
  *param_1 = *param_1 + 4;
  return *(undefined4 *)(*param_1 + -4);
}



Function: FUN_004091d2
----------------------------------------

undefined8 __cdecl FUN_004091d2(int *param_1)

{
  *param_1 = *param_1 + 8;
  return *(undefined8 *)(*param_1 + -8);
}



Function: FUN_004091e2
----------------------------------------

undefined4 __cdecl FUN_004091e2(int *param_1)

{
  *param_1 = *param_1 + 4;
  return CONCAT22((short)((uint)*param_1 >> 0x10),*(undefined2 *)(*param_1 + -4));
}



Function: FUN_004091f0
----------------------------------------

uint __thiscall FUN_004091f0(void *this,int param_1,uint param_2)

{
  BOOL BVar1;
  int iVar2;
  undefined4 local_8;
  
  if (param_1 + 1U < 0x101) {
    param_1._2_2_ = *(ushort *)(PTR_DAT_00411848 + param_1 * 2);
  }
  else {
    if ((PTR_DAT_00411848[(param_1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      local_8 = CONCAT31((int3)((uint)this >> 8),(char)param_1) & 0xffff00ff;
      iVar2 = 1;
    }
    else {
      local_8._0_2_ = CONCAT11((char)param_1,(char)((uint)param_1 >> 8));
      local_8 = CONCAT22((short)((uint)this >> 0x10),(undefined2)local_8) & 0xff00ffff;
      iVar2 = 2;
    }
    BVar1 = FUN_0040a8e5(1,(LPCSTR)&local_8,iVar2,(LPWORD)((int)&param_1 + 2),0,0,1);
    if (BVar1 == 0) {
      return 0;
    }
  }
  return param_1._2_2_ & param_2;
}



Function: FUN_004092a4
----------------------------------------

void __cdecl FUN_004092a4(undefined4 param_1)

{
  FUN_004092b5(param_1,0,4);
  return;
}



Function: FUN_004092b5
----------------------------------------

undefined4 FUN_004092b5(byte param_1,uint param_2,byte param_3)

{
  if (((&DAT_00412561)[param_1] & param_3) == 0) {
    if (param_2 == 0) {
      param_2 = 0;
    }
    else {
      param_2 = *(ushort *)(&DAT_00411852 + (uint)param_1 * 2) & param_2;
    }
    if (param_2 == 0) {
      return 0;
    }
  }
  return 1;
}



Function: FUN_004092e6
----------------------------------------

undefined4 __cdecl FUN_004092e6(int param_1)

{
  BYTE *pBVar1;
  byte bVar2;
  byte bVar3;
  UINT CodePage;
  UINT *pUVar4;
  BOOL BVar5;
  uint uVar6;
  uint uVar7;
  BYTE *pBVar8;
  int iVar9;
  byte *pbVar10;
  int iVar11;
  byte *pbVar12;
  undefined4 uVar13;
  undefined4 *puVar14;
  _cpinfo local_1c;
  uint local_8;
  
  FUN_00407d25(0x19);
  CodePage = FUN_00409493(param_1);
  if (CodePage != DAT_00412440) {
    if (CodePage != 0) {
      iVar11 = 0;
      pUVar4 = &DAT_00411a68;
LAB_00409323:
      if (*pUVar4 != CodePage) goto code_r0x00409327;
      local_8 = 0;
      puVar14 = (undefined4 *)&DAT_00412560;
      for (iVar9 = 0x40; iVar9 != 0; iVar9 = iVar9 + -1) {
        *puVar14 = 0;
        puVar14 = puVar14 + 1;
      }
      *(undefined1 *)puVar14 = 0;
      pbVar12 = &DAT_00411a78 + iVar11 * 0x30;
      do {
        bVar2 = *pbVar12;
        pbVar10 = pbVar12;
        while ((bVar2 != 0 && (bVar2 = pbVar10[1], bVar2 != 0))) {
          uVar7 = (uint)*pbVar10;
          if (uVar7 <= bVar2) {
            bVar3 = (&DAT_00411a60)[local_8];
            do {
              (&DAT_00412561)[uVar7] = (&DAT_00412561)[uVar7] | bVar3;
              uVar7 = uVar7 + 1;
            } while (uVar7 <= bVar2);
          }
          pbVar10 = pbVar10 + 2;
          bVar2 = *pbVar10;
        }
        local_8 = local_8 + 1;
        pbVar12 = pbVar12 + 8;
      } while (local_8 < 4);
      DAT_0041245c = 1;
      DAT_00412440 = CodePage;
      DAT_00412664 = FUN_004094dd(CodePage);
      DAT_00412450 = (&DAT_00411a6c)[iVar11 * 0xc];
      DAT_00412454 = (&DAT_00411a70)[iVar11 * 0xc];
      DAT_00412458 = (&DAT_00411a74)[iVar11 * 0xc];
      goto LAB_00409477;
    }
    goto LAB_00409472;
  }
  goto LAB_0040930d;
code_r0x00409327:
  pUVar4 = pUVar4 + 0xc;
  iVar11 = iVar11 + 1;
  if (0x411b57 < (int)pUVar4) goto code_r0x00409332;
  goto LAB_00409323;
code_r0x00409332:
  BVar5 = GetCPInfo(CodePage,&local_1c);
  uVar7 = 1;
  if (BVar5 == 1) {
    DAT_00412664 = 0;
    puVar14 = (undefined4 *)&DAT_00412560;
    for (iVar11 = 0x40; iVar11 != 0; iVar11 = iVar11 + -1) {
      *puVar14 = 0;
      puVar14 = puVar14 + 1;
    }
    *(undefined1 *)puVar14 = 0;
    if (local_1c.MaxCharSize < 2) {
      DAT_0041245c = 0;
      DAT_00412440 = CodePage;
    }
    else {
      DAT_00412440 = CodePage;
      if (local_1c.LeadByte[0] != '\0') {
        pBVar8 = local_1c.LeadByte + 1;
        do {
          bVar2 = *pBVar8;
          if (bVar2 == 0) break;
          for (uVar6 = (uint)pBVar8[-1]; uVar6 <= bVar2; uVar6 = uVar6 + 1) {
            (&DAT_00412561)[uVar6] = (&DAT_00412561)[uVar6] | 4;
          }
          pBVar1 = pBVar8 + 1;
          pBVar8 = pBVar8 + 2;
        } while (*pBVar1 != 0);
      }
      do {
        (&DAT_00412561)[uVar7] = (&DAT_00412561)[uVar7] | 8;
        uVar7 = uVar7 + 1;
      } while (uVar7 < 0xff);
      DAT_00412664 = FUN_004094dd(CodePage);
      DAT_0041245c = 1;
    }
    DAT_00412450 = 0;
    DAT_00412454 = 0;
    DAT_00412458 = 0;
  }
  else {
    if (DAT_004122ac == 0) {
      uVar13 = 0xffffffff;
      goto LAB_00409484;
    }
LAB_00409472:
    FUN_00409510();
  }
LAB_00409477:
  FUN_00409539();
LAB_0040930d:
  uVar13 = 0;
LAB_00409484:
  FUN_00407d86(0x19);
  return uVar13;
}



Function: FUN_00409493
----------------------------------------

int __cdecl FUN_00409493(int param_1)

{
  int iVar1;
  bool bVar2;
  
  if (param_1 == -2) {
    DAT_004122ac = 1;
                    /* WARNING: Could not recover jumptable at 0x004094ad. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    iVar1 = GetOEMCP();
    return iVar1;
  }
  if (param_1 == -3) {
    DAT_004122ac = 1;
                    /* WARNING: Could not recover jumptable at 0x004094c2. Too many branches */
                    /* WARNING: Treating indirect jump as call */
    iVar1 = GetACP();
    return iVar1;
  }
  bVar2 = param_1 == -4;
  if (bVar2) {
    param_1 = DAT_004122dc;
  }
  DAT_004122ac = (uint)bVar2;
  return param_1;
}



Function: FUN_004094dd
----------------------------------------

undefined4 __cdecl FUN_004094dd(int param_1)

{
  if (param_1 == 0x3a4) {
    return 0x411;
  }
  if (param_1 == 0x3a8) {
    return 0x804;
  }
  if (param_1 == 0x3b5) {
    return 0x412;
  }
  if (param_1 != 0x3b6) {
    return 0;
  }
  return 0x404;
}



Function: FUN_00409510
----------------------------------------

void FUN_00409510(void)

{
  int iVar1;
  undefined4 *puVar2;
  
  puVar2 = (undefined4 *)&DAT_00412560;
  for (iVar1 = 0x40; iVar1 != 0; iVar1 = iVar1 + -1) {
    *puVar2 = 0;
    puVar2 = puVar2 + 1;
  }
  *(undefined1 *)puVar2 = 0;
  DAT_00412440 = 0;
  DAT_0041245c = 0;
  DAT_00412664 = 0;
  DAT_00412450 = 0;
  DAT_00412454 = 0;
  DAT_00412458 = 0;
  return;
}



Function: FUN_00409539
----------------------------------------

void FUN_00409539(void)

{
  BOOL BVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint uVar5;
  ushort *puVar6;
  undefined1 uVar7;
  BYTE *pBVar8;
  CHAR *pCVar9;
  WORD local_518 [256];
  WCHAR local_318 [128];
  WCHAR local_218 [128];
  CHAR local_118 [256];
  _cpinfo local_18;
  
  BVar1 = GetCPInfo(DAT_00412440,&local_18);
  if (BVar1 == 1) {
    uVar2 = 0;
    do {
      local_118[uVar2] = (CHAR)uVar2;
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
    local_118[0] = ' ';
    if (local_18.LeadByte[0] != 0) {
      pBVar8 = local_18.LeadByte + 1;
      do {
        uVar2 = (uint)local_18.LeadByte[0];
        if (uVar2 <= *pBVar8) {
          uVar4 = (*pBVar8 - uVar2) + 1;
          uVar5 = uVar4 >> 2;
          pCVar9 = local_118 + uVar2;
          while (uVar5 != 0) {
            uVar5 = uVar5 - 1;
            builtin_memcpy(pCVar9,"    ",4);
            pCVar9 = pCVar9 + 4;
          }
          for (uVar4 = uVar4 & 3; uVar4 != 0; uVar4 = uVar4 - 1) {
            *pCVar9 = ' ';
            pCVar9 = pCVar9 + 1;
          }
        }
        local_18.LeadByte[0] = pBVar8[1];
        pBVar8 = pBVar8 + 2;
      } while (local_18.LeadByte[0] != 0);
    }
    FUN_0040a8e5(1,local_118,0x100,local_518,DAT_00412440,DAT_00412664,0);
    FUN_0040aa2e(DAT_00412664,0x100,local_118,0x100,local_218,0x100,DAT_00412440,0);
    FUN_0040aa2e(DAT_00412664,0x200,local_118,0x100,local_318,0x100,DAT_00412440,0);
    uVar2 = 0;
    puVar6 = local_518;
    do {
      if ((*puVar6 & 1) == 0) {
        if ((*puVar6 & 2) != 0) {
          (&DAT_00412561)[uVar2] = (&DAT_00412561)[uVar2] | 0x20;
          uVar7 = *(undefined1 *)((int)local_318 + uVar2);
          goto LAB_00409645;
        }
        (&DAT_00412460)[uVar2] = 0;
      }
      else {
        (&DAT_00412561)[uVar2] = (&DAT_00412561)[uVar2] | 0x10;
        uVar7 = *(undefined1 *)((int)local_218 + uVar2);
LAB_00409645:
        (&DAT_00412460)[uVar2] = uVar7;
      }
      uVar2 = uVar2 + 1;
      puVar6 = puVar6 + 1;
    } while (uVar2 < 0x100);
  }
  else {
    uVar2 = 0;
    do {
      if ((uVar2 < 0x41) || (0x5a < uVar2)) {
        if ((0x60 < uVar2) && (uVar2 < 0x7b)) {
          (&DAT_00412561)[uVar2] = (&DAT_00412561)[uVar2] | 0x20;
          cVar3 = (char)uVar2 + -0x20;
          goto LAB_0040968f;
        }
        (&DAT_00412460)[uVar2] = 0;
      }
      else {
        (&DAT_00412561)[uVar2] = (&DAT_00412561)[uVar2] | 0x10;
        cVar3 = (char)uVar2 + ' ';
LAB_0040968f:
        (&DAT_00412460)[uVar2] = cVar3;
      }
      uVar2 = uVar2 + 1;
    } while (uVar2 < 0x100);
  }
  return;
}



Function: FUN_004096be
----------------------------------------

void FUN_004096be(void)

{
  if (DAT_004137c8 == 0) {
    FUN_004092e6(-3);
    DAT_004137c8 = 1;
  }
  return;
}



Function: FUN_004096da
----------------------------------------

int * __cdecl FUN_004096da(int param_1,int param_2)

{
  int iVar1;
  uint *puVar2;
  uint *puVar3;
  uint *_Size;
  int *local_24;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d538;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  puVar2 = (uint *)(param_1 * param_2);
  puVar3 = puVar2;
  ExceptionList = &local_14;
  if (puVar2 < (uint *)0xffffffe1) {
    if (puVar2 == (uint *)0x0) {
      puVar3 = (uint *)0x1;
    }
    puVar3 = (uint *)((int)puVar3 + 0xfU & 0xfffffff0);
    ExceptionList = &local_14;
  }
  do {
    local_24 = (int *)0x0;
    if (puVar3 < (uint *)0xffffffe1) {
      if (DAT_004136a4 == 3) {
        if (puVar2 <= DAT_0041369c) {
          FUN_00407d25(9);
          local_8 = 0;
          local_24 = FUN_00406e84(puVar2);
          local_8 = 0xffffffff;
          FUN_00409773();
          _Size = puVar2;
          if (local_24 == (int *)0x0) goto LAB_004097c7;
LAB_004097b6:
          _memset(local_24,0,(size_t)_Size);
        }
LAB_004097c2:
        if (local_24 != (int *)0x0) {
          ExceptionList = local_14;
          return local_24;
        }
      }
      else {
        if ((DAT_004136a4 != 2) || (DAT_004114fc < puVar3)) goto LAB_004097c2;
        FUN_00407d25(9);
        local_8 = 1;
        local_24 = FUN_00407927((uint)puVar3 >> 4);
        local_8 = 0xffffffff;
        FUN_004097fc();
        _Size = puVar3;
        if (local_24 != (int *)0x0) goto LAB_004097b6;
      }
LAB_004097c7:
      local_24 = (int *)HeapAlloc(DAT_004136a0,8,(SIZE_T)puVar3);
    }
    if (local_24 != (int *)0x0) {
      ExceptionList = local_14;
      return local_24;
    }
    if (DAT_004122a0 == 0) {
      ExceptionList = local_14;
      return (int *)0x0;
    }
    iVar1 = FUN_00407d9b(puVar3);
    if (iVar1 == 0) {
      ExceptionList = local_14;
      return (int *)0x0;
    }
  } while( true );
}



Function: FUN_00409773
----------------------------------------

void FUN_00409773(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_004097fc
----------------------------------------

void FUN_004097fc(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_00409817
----------------------------------------

void __thiscall FUN_00409817(void *this,byte *param_1,int *param_2,void *param_3)

{
  FUN_0040982e(this,param_1,param_2,param_3,0);
  return;
}



Function: FUN_0040982e
----------------------------------------

void * __thiscall FUN_0040982e(void *this,byte *param_1,int *param_2,void *param_3,uint param_4)

{
  void *pvVar1;
  uint uVar2;
  void *pvVar3;
  uint uVar4;
  DWORD *pDVar5;
  void *this_00;
  byte bVar6;
  undefined *puVar7;
  void *local_c;
  byte *local_8;
  
  local_c = (void *)0x0;
  bVar6 = *param_1;
  local_8 = param_1 + 1;
  while( true ) {
    if (DAT_00411a54 < 2) {
      uVar2 = (byte)PTR_DAT_00411848[(uint)bVar6 * 2] & 8;
      this = PTR_DAT_00411848;
    }
    else {
      puVar7 = (undefined *)0x8;
      uVar2 = FUN_004091f0(this,(uint)bVar6,8);
      this = puVar7;
    }
    if (uVar2 == 0) break;
    bVar6 = *local_8;
    local_8 = local_8 + 1;
  }
  if (bVar6 == 0x2d) {
    param_4 = param_4 | 2;
LAB_00409889:
    bVar6 = *local_8;
    local_8 = local_8 + 1;
  }
  else if (bVar6 == 0x2b) goto LAB_00409889;
  if ((((int)param_3 < 0) || (param_3 == (void *)0x1)) || (0x24 < (int)param_3)) {
    if (param_2 != (int *)0x0) {
      *param_2 = (int)param_1;
    }
    return (void *)0x0;
  }
  this_00 = (void *)0x10;
  if (param_3 == (void *)0x0) {
    if (bVar6 != 0x30) {
      param_3 = (void *)0xa;
      goto LAB_004098f3;
    }
    if ((*local_8 != 0x78) && (*local_8 != 0x58)) {
      param_3 = (void *)0x8;
      goto LAB_004098f3;
    }
    param_3 = (void *)0x10;
  }
  if (((param_3 == (void *)0x10) && (bVar6 == 0x30)) && ((*local_8 == 0x78 || (*local_8 == 0x58))))
  {
    bVar6 = local_8[1];
    local_8 = local_8 + 2;
  }
LAB_004098f3:
  pvVar3 = (void *)(0xffffffff / ZEXT48(param_3));
  do {
    uVar2 = (uint)bVar6;
    if (DAT_00411a54 < 2) {
      uVar4 = (byte)PTR_DAT_00411848[uVar2 * 2] & 4;
    }
    else {
      pvVar1 = (void *)0x4;
      uVar4 = FUN_004091f0(this_00,uVar2,4);
      this_00 = pvVar1;
    }
    if (uVar4 == 0) {
      if (DAT_00411a54 < 2) {
        uVar2 = *(ushort *)(PTR_DAT_00411848 + uVar2 * 2) & 0x103;
      }
      else {
        uVar2 = FUN_004091f0(this_00,uVar2,0x103);
      }
      if (uVar2 == 0) {
LAB_0040999f:
        local_8 = local_8 + -1;
        if ((param_4 & 8) == 0) {
          if (param_2 != (int *)0x0) {
            local_8 = param_1;
          }
          local_c = (void *)0x0;
        }
        else if (((param_4 & 4) != 0) ||
                (((param_4 & 1) == 0 &&
                 ((((param_4 & 2) != 0 && ((void *)0x80000000 < local_c)) ||
                  (((param_4 & 2) == 0 && ((void *)0x7fffffff < local_c)))))))) {
          pDVar5 = FUN_00405095();
          *pDVar5 = 0x22;
          if ((param_4 & 1) == 0) {
            local_c = (void *)(((param_4 & 2) != 0) + 0x7fffffff);
          }
          else {
            local_c = (void *)0xffffffff;
          }
        }
        if (param_2 != (int *)0x0) {
          *param_2 = (int)local_8;
        }
        if ((param_4 & 2) == 0) {
          return local_c;
        }
        return (void *)-(int)local_c;
      }
      uVar2 = FUN_0040ac52((int)(char)bVar6);
      this_00 = (void *)(uVar2 - 0x37);
    }
    else {
      this_00 = (void *)((char)bVar6 + -0x30);
    }
    if (param_3 <= this_00) goto LAB_0040999f;
    if ((local_c < pvVar3) ||
       ((local_c == pvVar3 && (this_00 <= (void *)(0xffffffff % ZEXT48(param_3)))))) {
      local_c = (void *)((int)local_c * (int)param_3 + (int)this_00);
      param_4 = param_4 | 8;
    }
    else {
      param_4 = param_4 | 0xc;
    }
    bVar6 = *local_8;
    local_8 = local_8 + 1;
  } while( true );
}



Function: _strchr
----------------------------------------

/* Library Function - Single Match
    _strchr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strchr(char *_Str,int _Val)

{
  uint uVar1;
  char cVar2;
  uint uVar3;
  uint uVar4;
  uint *puVar5;
  
  uVar1 = (uint)_Str & 3;
  while (uVar1 != 0) {
    if ((char)*(uint *)_Str == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)*(uint *)_Str == '\0') {
      return (char *)0x0;
    }
    uVar1 = (uint)((int)_Str + 1) & 3;
    _Str = (char *)((int)_Str + 1);
  }
  while( true ) {
    while( true ) {
      uVar1 = *(uint *)_Str;
      uVar4 = uVar1 ^ CONCAT22(CONCAT11((char)_Val,(char)_Val),CONCAT11((char)_Val,(char)_Val));
      uVar3 = uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff;
      puVar5 = (uint *)((int)_Str + 4);
      if (((uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff) & 0x81010100) != 0) break;
      _Str = (char *)puVar5;
      if ((uVar3 & 0x81010100) != 0) {
        if ((uVar3 & 0x1010100) != 0) {
          return (char *)0x0;
        }
        if ((uVar1 + 0x7efefeff & 0x80000000) == 0) {
          return (char *)0x0;
        }
      }
    }
    uVar1 = *(uint *)_Str;
    if ((char)uVar1 == (char)_Val) {
      return (char *)(uint *)_Str;
    }
    if ((char)uVar1 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 8);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 1);
    }
    if (cVar2 == '\0') break;
    cVar2 = (char)(uVar1 >> 0x10);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 2);
    }
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
    cVar2 = (char)(uVar1 >> 0x18);
    if (cVar2 == (char)_Val) {
      return (char *)((int)_Str + 3);
    }
    _Str = (char *)puVar5;
    if (cVar2 == '\0') {
      return (char *)0x0;
    }
  }
  return (char *)0x0;
}



Function: _strstr
----------------------------------------

/* Library Function - Single Match
    _strstr
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strstr(char *_Str,char *_SubStr)

{
  char *pcVar1;
  char *pcVar2;
  char cVar3;
  uint uVar4;
  char cVar5;
  uint uVar6;
  uint uVar7;
  char *pcVar8;
  uint *puVar9;
  char *pcVar10;
  
  cVar3 = *_SubStr;
  if (cVar3 == '\0') {
    return _Str;
  }
  if (_SubStr[1] == '\0') {
    uVar4 = (uint)_Str & 3;
    while (uVar4 != 0) {
      if ((char)*(uint *)_Str == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)*(uint *)_Str == '\0') {
        return (char *)0x0;
      }
      uVar4 = (uint)((int)_Str + 1) & 3;
      _Str = (char *)((int)_Str + 1);
    }
    while( true ) {
      while( true ) {
        uVar4 = *(uint *)_Str;
        uVar7 = uVar4 ^ CONCAT22(CONCAT11(cVar3,cVar3),CONCAT11(cVar3,cVar3));
        uVar6 = uVar4 ^ 0xffffffff ^ uVar4 + 0x7efefeff;
        puVar9 = (uint *)((int)_Str + 4);
        if (((uVar7 ^ 0xffffffff ^ uVar7 + 0x7efefeff) & 0x81010100) != 0) break;
        _Str = (char *)puVar9;
        if ((uVar6 & 0x81010100) != 0) {
          if ((uVar6 & 0x1010100) != 0) {
            return (char *)0x0;
          }
          if ((uVar4 + 0x7efefeff & 0x80000000) == 0) {
            return (char *)0x0;
          }
        }
      }
      uVar4 = *(uint *)_Str;
      if ((char)uVar4 == cVar3) {
        return (char *)(uint *)_Str;
      }
      if ((char)uVar4 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 8);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 1);
      }
      if (cVar5 == '\0') break;
      cVar5 = (char)(uVar4 >> 0x10);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 2);
      }
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
      cVar5 = (char)(uVar4 >> 0x18);
      if (cVar5 == cVar3) {
        return (char *)((int)_Str + 3);
      }
      _Str = (char *)puVar9;
      if (cVar5 == '\0') {
        return (char *)0x0;
      }
    }
    return (char *)0x0;
  }
  do {
    cVar5 = *_Str;
    do {
      while (_Str = _Str + 1, cVar5 != cVar3) {
        if (cVar5 == '\0') {
          return (char *)0x0;
        }
        cVar5 = *_Str;
      }
      cVar5 = *_Str;
      pcVar10 = _Str + 1;
      pcVar8 = _SubStr;
    } while (cVar5 != _SubStr[1]);
    do {
      if (pcVar8[2] == '\0') {
LAB_00409b83:
        return _Str + -1;
      }
      if (*pcVar10 != pcVar8[2]) break;
      pcVar1 = pcVar8 + 3;
      if (*pcVar1 == '\0') goto LAB_00409b83;
      pcVar2 = pcVar10 + 1;
      pcVar8 = pcVar8 + 2;
      pcVar10 = pcVar10 + 2;
    } while (*pcVar1 == *pcVar2);
  } while( true );
}



Function: _strncmp
----------------------------------------

/* Library Function - Single Match
    _strncmp
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

int __cdecl _strncmp(char *_Str1,char *_Str2,size_t _MaxCount)

{
  char cVar1;
  char cVar2;
  size_t sVar3;
  int iVar4;
  uint uVar5;
  char *pcVar6;
  char *pcVar7;
  
  sVar3 = _MaxCount;
  pcVar6 = _Str1;
  if (_MaxCount != 0) {
    do {
      if (sVar3 == 0) break;
      sVar3 = sVar3 - 1;
      cVar1 = *pcVar6;
      pcVar6 = pcVar6 + 1;
    } while (cVar1 != '\0');
    iVar4 = _MaxCount - sVar3;
    do {
      pcVar6 = _Str2;
      pcVar7 = _Str1;
      if (iVar4 == 0) break;
      iVar4 = iVar4 + -1;
      pcVar7 = _Str1 + 1;
      pcVar6 = _Str2 + 1;
      cVar2 = *_Str1;
      cVar1 = *_Str2;
      _Str2 = pcVar6;
      _Str1 = pcVar7;
    } while (cVar1 == cVar2);
    uVar5 = 0;
    if ((byte)pcVar6[-1] <= (byte)pcVar7[-1]) {
      if (pcVar6[-1] == pcVar7[-1]) {
        return 0;
      }
      uVar5 = 0xfffffffe;
    }
    _MaxCount = ~uVar5;
  }
  return _MaxCount;
}



Function: FUN_00409bc8
----------------------------------------

int __cdecl FUN_00409bc8(undefined4 param_1,undefined4 param_2,undefined4 param_3)

{
  HMODULE hModule;
  int iVar1;
  
  iVar1 = 0;
  if (DAT_004122b0 == (FARPROC)0x0) {
    hModule = LoadLibraryA("user32.dll");
    if (hModule != (HMODULE)0x0) {
      DAT_004122b0 = GetProcAddress(hModule,"MessageBoxA");
      if (DAT_004122b0 != (FARPROC)0x0) {
        DAT_004122b4 = GetProcAddress(hModule,"GetActiveWindow");
        DAT_004122b8 = GetProcAddress(hModule,"GetLastActivePopup");
        goto LAB_00409c17;
      }
    }
    iVar1 = 0;
  }
  else {
LAB_00409c17:
    if (DAT_004122b4 != (FARPROC)0x0) {
      iVar1 = (*DAT_004122b4)();
      if ((iVar1 != 0) && (DAT_004122b8 != (FARPROC)0x0)) {
        iVar1 = (*DAT_004122b8)(iVar1);
      }
    }
    iVar1 = (*DAT_004122b0)(iVar1,param_1,param_2,param_3);
  }
  return iVar1;
}



Function: _strncpy
----------------------------------------

/* Library Function - Single Match
    _strncpy
   
   Libraries: Visual Studio 1998 Debug, Visual Studio 1998 Release */

char * __cdecl _strncpy(char *_Dest,char *_Source,size_t _Count)

{
  uint uVar1;
  uint uVar2;
  char cVar3;
  uint uVar4;
  uint *puVar5;
  
  if (_Count == 0) {
    return _Dest;
  }
  puVar5 = (uint *)_Dest;
  if (((uint)_Source & 3) != 0) {
    while( true ) {
      uVar4 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 1);
      *(char *)puVar5 = (char)uVar4;
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
      if (_Count == 0) {
        return _Dest;
      }
      if ((char)uVar4 == '\0') break;
      if (((uint)_Source & 3) == 0) {
        uVar4 = _Count >> 2;
        goto joined_r0x00409c9e;
      }
    }
    do {
      if (((uint)puVar5 & 3) == 0) {
        uVar4 = _Count >> 2;
        cVar3 = '\0';
        if (uVar4 == 0) goto LAB_00409cdb;
        goto LAB_00409d49;
      }
      *(char *)puVar5 = '\0';
      puVar5 = (uint *)((int)puVar5 + 1);
      _Count = _Count - 1;
    } while (_Count != 0);
    return _Dest;
  }
  uVar4 = _Count >> 2;
  if (uVar4 != 0) {
    do {
      uVar1 = *(uint *)_Source;
      uVar2 = *(uint *)_Source;
      _Source = (char *)((int)_Source + 4);
      if (((uVar1 ^ 0xffffffff ^ uVar1 + 0x7efefeff) & 0x81010100) != 0) {
        if ((char)uVar2 == '\0') {
          *puVar5 = 0;
joined_r0x00409d45:
          while( true ) {
            uVar4 = uVar4 - 1;
            puVar5 = puVar5 + 1;
            if (uVar4 == 0) break;
LAB_00409d49:
            *puVar5 = 0;
          }
          cVar3 = '\0';
          _Count = _Count & 3;
          if (_Count != 0) goto LAB_00409cdb;
          return _Dest;
        }
        if ((char)(uVar2 >> 8) == '\0') {
          *puVar5 = uVar2 & 0xff;
          goto joined_r0x00409d45;
        }
        if ((uVar2 & 0xff0000) == 0) {
          *puVar5 = uVar2 & 0xffff;
          goto joined_r0x00409d45;
        }
        if ((uVar2 & 0xff000000) == 0) {
          *puVar5 = uVar2;
          goto joined_r0x00409d45;
        }
      }
      *puVar5 = uVar2;
      puVar5 = puVar5 + 1;
      uVar4 = uVar4 - 1;
joined_r0x00409c9e:
    } while (uVar4 != 0);
    _Count = _Count & 3;
    if (_Count == 0) {
      return _Dest;
    }
  }
  do {
    cVar3 = (char)*(uint *)_Source;
    _Source = (char *)((int)_Source + 1);
    *(char *)puVar5 = cVar3;
    puVar5 = (uint *)((int)puVar5 + 1);
    if (cVar3 == '\0') {
      while (_Count = _Count - 1, _Count != 0) {
LAB_00409cdb:
        *(char *)puVar5 = cVar3;
        puVar5 = (uint *)((int)puVar5 + 1);
      }
      return _Dest;
    }
    _Count = _Count - 1;
  } while (_Count != 0);
  return _Dest;
}



Function: FUN_00409d60
----------------------------------------

undefined4 * __cdecl FUN_00409d60(undefined4 *param_1,undefined4 *param_2,uint param_3)

{
  uint uVar1;
  uint uVar2;
  undefined4 *puVar3;
  undefined4 *puVar4;
  
  if ((param_2 < param_1) && (param_1 < (undefined4 *)(param_3 + (int)param_2))) {
    puVar3 = (undefined4 *)((param_3 - 4) + (int)param_2);
    puVar4 = (undefined4 *)((param_3 - 4) + (int)param_1);
    if (((uint)puVar4 & 3) == 0) {
      uVar1 = param_3 >> 2;
      uVar2 = param_3 & 3;
      if (7 < uVar1) {
        for (; uVar1 != 0; uVar1 = uVar1 - 1) {
          *puVar4 = *puVar3;
          puVar3 = puVar3 + -1;
          puVar4 = puVar4 + -1;
        }
        switch(uVar2) {
        case 0:
          return param_1;
        case 2:
          goto switchD_00409f17_caseD_2;
        case 3:
          goto switchD_00409f17_caseD_3;
        }
        goto switchD_00409f17_caseD_1;
      }
    }
    else {
      switch(param_3) {
      case 0:
        goto switchD_00409f17_caseD_0;
      case 1:
        goto switchD_00409f17_caseD_1;
      case 2:
        goto switchD_00409f17_caseD_2;
      case 3:
        goto switchD_00409f17_caseD_3;
      default:
        uVar1 = param_3 - ((uint)puVar4 & 3);
        switch((uint)puVar4 & 3) {
        case 1:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          puVar3 = (undefined4 *)((int)puVar3 + -1);
          uVar1 = uVar1 >> 2;
          puVar4 = (undefined4 *)((int)puVar4 - 1);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_00409f17_caseD_2;
            case 3:
              goto switchD_00409f17_caseD_3;
            }
            goto switchD_00409f17_caseD_1;
          }
          break;
        case 2:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          puVar3 = (undefined4 *)((int)puVar3 + -2);
          puVar4 = (undefined4 *)((int)puVar4 - 2);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_00409f17_caseD_2;
            case 3:
              goto switchD_00409f17_caseD_3;
            }
            goto switchD_00409f17_caseD_1;
          }
          break;
        case 3:
          uVar2 = uVar1 & 3;
          *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
          *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
          uVar1 = uVar1 >> 2;
          *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
          puVar3 = (undefined4 *)((int)puVar3 + -3);
          puVar4 = (undefined4 *)((int)puVar4 - 3);
          if (7 < uVar1) {
            for (; uVar1 != 0; uVar1 = uVar1 - 1) {
              *puVar4 = *puVar3;
              puVar3 = puVar3 + -1;
              puVar4 = puVar4 + -1;
            }
            switch(uVar2) {
            case 0:
              return param_1;
            case 2:
              goto switchD_00409f17_caseD_2;
            case 3:
              goto switchD_00409f17_caseD_3;
            }
            goto switchD_00409f17_caseD_1;
          }
        }
      }
    }
    switch(uVar1) {
    case 7:
      puVar4[7 - uVar1] = puVar3[7 - uVar1];
    case 6:
      puVar4[6 - uVar1] = puVar3[6 - uVar1];
    case 5:
      puVar4[5 - uVar1] = puVar3[5 - uVar1];
    case 4:
      puVar4[4 - uVar1] = puVar3[4 - uVar1];
    case 3:
      puVar4[3 - uVar1] = puVar3[3 - uVar1];
    case 2:
      puVar4[2 - uVar1] = puVar3[2 - uVar1];
    case 1:
      puVar4[1 - uVar1] = puVar3[1 - uVar1];
      puVar3 = puVar3 + -uVar1;
      puVar4 = puVar4 + -uVar1;
    }
    switch(uVar2) {
    case 1:
switchD_00409f17_caseD_1:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      return param_1;
    case 2:
switchD_00409f17_caseD_2:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      return param_1;
    case 3:
switchD_00409f17_caseD_3:
      *(undefined1 *)((int)puVar4 + 3) = *(undefined1 *)((int)puVar3 + 3);
      *(undefined1 *)((int)puVar4 + 2) = *(undefined1 *)((int)puVar3 + 2);
      *(undefined1 *)((int)puVar4 + 1) = *(undefined1 *)((int)puVar3 + 1);
      return param_1;
    }
switchD_00409f17_caseD_0:
    return param_1;
  }
  puVar3 = param_1;
  if (((uint)param_1 & 3) == 0) {
    uVar1 = param_3 >> 2;
    uVar2 = param_3 & 3;
    if (7 < uVar1) {
      for (; uVar1 != 0; uVar1 = uVar1 - 1) {
        *puVar3 = *param_2;
        param_2 = param_2 + 1;
        puVar3 = puVar3 + 1;
      }
      switch(uVar2) {
      case 0:
        return param_1;
      case 2:
        goto switchD_00409d95_caseD_2;
      case 3:
        goto switchD_00409d95_caseD_3;
      }
      goto switchD_00409d95_caseD_1;
    }
  }
  else {
    switch(param_3) {
    case 0:
      goto switchD_00409d95_caseD_0;
    case 1:
      goto switchD_00409d95_caseD_1;
    case 2:
      goto switchD_00409d95_caseD_2;
    case 3:
      goto switchD_00409d95_caseD_3;
    default:
      uVar1 = (param_3 - 4) + ((uint)param_1 & 3);
      switch((uint)param_1 & 3) {
      case 1:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 2) = *(undefined1 *)((int)param_2 + 2);
        param_2 = (undefined4 *)((int)param_2 + 3);
        puVar3 = (undefined4 *)((int)param_1 + 3);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_00409d95_caseD_2;
          case 3:
            goto switchD_00409d95_caseD_3;
          }
          goto switchD_00409d95_caseD_1;
        }
        break;
      case 2:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        uVar1 = uVar1 >> 2;
        *(undefined1 *)((int)param_1 + 1) = *(undefined1 *)((int)param_2 + 1);
        param_2 = (undefined4 *)((int)param_2 + 2);
        puVar3 = (undefined4 *)((int)param_1 + 2);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_00409d95_caseD_2;
          case 3:
            goto switchD_00409d95_caseD_3;
          }
          goto switchD_00409d95_caseD_1;
        }
        break;
      case 3:
        uVar2 = uVar1 & 3;
        *(undefined1 *)param_1 = *(undefined1 *)param_2;
        param_2 = (undefined4 *)((int)param_2 + 1);
        uVar1 = uVar1 >> 2;
        puVar3 = (undefined4 *)((int)param_1 + 1);
        if (7 < uVar1) {
          for (; uVar1 != 0; uVar1 = uVar1 - 1) {
            *puVar3 = *param_2;
            param_2 = param_2 + 1;
            puVar3 = puVar3 + 1;
          }
          switch(uVar2) {
          case 0:
            return param_1;
          case 2:
            goto switchD_00409d95_caseD_2;
          case 3:
            goto switchD_00409d95_caseD_3;
          }
          goto switchD_00409d95_caseD_1;
        }
      }
    }
  }
  switch(uVar1) {
  case 7:
    puVar3[uVar1 - 7] = param_2[uVar1 - 7];
  case 6:
    puVar3[uVar1 - 6] = param_2[uVar1 - 6];
  case 5:
    puVar3[uVar1 - 5] = param_2[uVar1 - 5];
  case 4:
    puVar3[uVar1 - 4] = param_2[uVar1 - 4];
  case 3:
    puVar3[uVar1 - 3] = param_2[uVar1 - 3];
  case 2:
    puVar3[uVar1 - 2] = param_2[uVar1 - 2];
  case 1:
    puVar3[uVar1 - 1] = param_2[uVar1 - 1];
    param_2 = param_2 + uVar1;
    puVar3 = puVar3 + uVar1;
  }
  switch(uVar2) {
  case 1:
switchD_00409d95_caseD_1:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    return param_1;
  case 2:
switchD_00409d95_caseD_2:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    return param_1;
  case 3:
switchD_00409d95_caseD_3:
    *(undefined1 *)puVar3 = *(undefined1 *)param_2;
    *(undefined1 *)((int)puVar3 + 1) = *(undefined1 *)((int)param_2 + 1);
    *(undefined1 *)((int)puVar3 + 2) = *(undefined1 *)((int)param_2 + 2);
    return param_1;
  }
switchD_00409d95_caseD_0:
  return param_1;
}



Function: FUN_0040a116
----------------------------------------

uint FUN_0040a116(void)

{
  undefined4 *puVar1;
  undefined4 *puVar2;
  int *piVar3;
  uint uVar4;
  int local_8;
  int local_4;
  
  uVar4 = 0xffffffff;
  FUN_00407d25(0x12);
  local_8 = 0;
  local_4 = 0;
  piVar3 = &DAT_004136c0;
  while (puVar2 = (undefined4 *)*piVar3, puVar1 = puVar2, puVar2 != (undefined4 *)0x0) {
    for (; puVar2 < puVar1 + 0x120; puVar2 = puVar2 + 9) {
      if ((*(byte *)(puVar2 + 1) & 1) == 0) {
        if (puVar2[2] == 0) {
          FUN_00407d25(0x11);
          if (puVar2[2] == 0) {
            InitializeCriticalSection((LPCRITICAL_SECTION)(puVar2 + 3));
            puVar2[2] = puVar2[2] + 1;
          }
          FUN_00407d86(0x11);
        }
        EnterCriticalSection((LPCRITICAL_SECTION)(puVar2 + 3));
        if ((*(byte *)(puVar2 + 1) & 1) == 0) {
          *puVar2 = 0xffffffff;
          uVar4 = ((int)puVar2 - *piVar3) / 0x24 + local_4;
          if (uVar4 != 0xffffffff) goto LAB_0040a228;
          break;
        }
        LeaveCriticalSection((LPCRITICAL_SECTION)(puVar2 + 3));
      }
      puVar1 = (undefined4 *)*piVar3;
    }
    local_4 = local_4 + 0x20;
    piVar3 = piVar3 + 1;
    local_8 = local_8 + 1;
    if (0x4137bf < (int)piVar3) goto LAB_0040a228;
  }
  puVar2 = (undefined4 *)_malloc(0x480);
  if (puVar2 != (undefined4 *)0x0) {
    DAT_004137c0 = DAT_004137c0 + 0x20;
    (&DAT_004136c0)[local_8] = puVar2;
    puVar1 = puVar2;
    for (; puVar2 < puVar1 + 0x120; puVar2 = puVar2 + 9) {
      *(undefined1 *)(puVar2 + 1) = 0;
      *puVar2 = 0xffffffff;
      puVar2[2] = 0;
      *(undefined1 *)((int)puVar2 + 5) = 10;
      puVar1 = (undefined4 *)(&DAT_004136c0)[local_8];
    }
    uVar4 = local_8 << 5;
    FUN_0040a376(uVar4);
  }
LAB_0040a228:
  FUN_00407d86(0x12);
  return uVar4;
}



Function: FUN_0040a239
----------------------------------------

undefined4 __cdecl FUN_0040a239(uint param_1,HANDLE param_2)

{
  DWORD *pDVar1;
  int iVar2;
  DWORD nStdHandle;
  
  if (param_1 < DAT_004137c0) {
    iVar2 = (param_1 & 0x1f) * 0x24;
    if (*(int *)((&DAT_004136c0)[(int)param_1 >> 5] + iVar2) == -1) {
      if (DAT_0040f204 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_0040a292;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,param_2);
      }
LAB_0040a292:
      *(HANDLE *)((&DAT_004136c0)[(int)param_1 >> 5] + iVar2) = param_2;
      return 0;
    }
  }
  pDVar1 = FUN_00405095();
  *pDVar1 = 9;
  pDVar1 = FUN_0040509e();
  *pDVar1 = 0;
  return 0xffffffff;
}



Function: FUN_0040a2b5
----------------------------------------

undefined4 __cdecl FUN_0040a2b5(uint param_1)

{
  int *piVar1;
  DWORD *pDVar2;
  int iVar3;
  DWORD nStdHandle;
  
  if (param_1 < DAT_004137c0) {
    iVar3 = (param_1 & 0x1f) * 0x24;
    piVar1 = (int *)((&DAT_004136c0)[(int)param_1 >> 5] + iVar3);
    if (((*(byte *)(piVar1 + 1) & 1) != 0) && (*piVar1 != -1)) {
      if (DAT_0040f204 == 1) {
        if (param_1 == 0) {
          nStdHandle = 0xfffffff6;
        }
        else if (param_1 == 1) {
          nStdHandle = 0xfffffff5;
        }
        else {
          if (param_1 != 2) goto LAB_0040a311;
          nStdHandle = 0xfffffff4;
        }
        SetStdHandle(nStdHandle,(HANDLE)0x0);
      }
LAB_0040a311:
      *(undefined4 *)((&DAT_004136c0)[(int)param_1 >> 5] + iVar3) = 0xffffffff;
      return 0;
    }
  }
  pDVar2 = FUN_00405095();
  *pDVar2 = 9;
  pDVar2 = FUN_0040509e();
  *pDVar2 = 0;
  return 0xffffffff;
}



Function: FUN_0040a334
----------------------------------------

undefined4 __cdecl FUN_0040a334(uint param_1)

{
  DWORD *pDVar1;
  
  if ((param_1 < DAT_004137c0) &&
     ((*(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 1) != 0)) {
    return *(undefined4 *)((&DAT_004136c0)[(int)param_1 >> 5] + (param_1 & 0x1f) * 0x24);
  }
  pDVar1 = FUN_00405095();
  *pDVar1 = 9;
  pDVar1 = FUN_0040509e();
  *pDVar1 = 0;
  return 0xffffffff;
}



Function: FUN_0040a376
----------------------------------------

void __cdecl FUN_0040a376(uint param_1)

{
  int iVar1;
  int iVar2;
  
  iVar2 = (param_1 & 0x1f) * 0x24;
  iVar1 = (&DAT_004136c0)[(int)param_1 >> 5] + iVar2;
  if (*(int *)(iVar1 + 8) == 0) {
    FUN_00407d25(0x11);
    if (*(int *)(iVar1 + 8) == 0) {
      InitializeCriticalSection((LPCRITICAL_SECTION)(iVar1 + 0xc));
      *(int *)(iVar1 + 8) = *(int *)(iVar1 + 8) + 1;
    }
    FUN_00407d86(0x11);
  }
  EnterCriticalSection((LPCRITICAL_SECTION)((&DAT_004136c0)[(int)param_1 >> 5] + 0xc + iVar2));
  return;
}



Function: FUN_0040a3d5
----------------------------------------

void __cdecl FUN_0040a3d5(uint param_1)

{
  LeaveCriticalSection
            ((LPCRITICAL_SECTION)
             ((&DAT_004136c0)[(int)param_1 >> 5] + 0xc + (param_1 & 0x1f) * 0x24));
  return;
}



Function: FUN_0040a3f7
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl FUN_0040a3f7(undefined4 *param_1)

{
  void *pvVar1;
  
  _DAT_004122a8 = _DAT_004122a8 + 1;
  pvVar1 = _malloc(0x1000);
  param_1[2] = pvVar1;
  if (pvVar1 == (void *)0x0) {
    param_1[3] = param_1[3] | 4;
    param_1[2] = param_1 + 5;
    param_1[6] = 2;
  }
  else {
    param_1[3] = param_1[3] | 8;
    param_1[6] = 0x1000;
  }
  param_1[1] = 0;
  *param_1 = param_1[2];
  return;
}



Function: FUN_0040a43b
----------------------------------------

byte __cdecl FUN_0040a43b(uint param_1)

{
  if (DAT_004137c0 <= param_1) {
    return 0;
  }
  return *(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) & 0x40;
}



Function: FUN_0040a464
----------------------------------------

uint __cdecl FUN_0040a464(LPCSTR param_1,uint param_2,uint param_3,uint param_4)

{
  byte *pbVar1;
  uint uVar2;
  uint uVar3;
  DWORD *pDVar4;
  HANDLE hFile;
  DWORD DVar5;
  int iVar6;
  int iVar7;
  bool bVar8;
  _SECURITY_ATTRIBUTES local_20;
  DWORD local_14;
  DWORD local_10;
  DWORD local_c;
  byte local_5;
  
  bVar8 = (param_2 & 0x80) == 0;
  local_20.nLength = 0xc;
  local_20.lpSecurityDescriptor = (LPVOID)0x0;
  if (bVar8) {
    local_5 = 0;
  }
  else {
    local_5 = 0x10;
  }
  local_20.bInheritHandle = (BOOL)bVar8;
  if (((param_2 & 0x8000) == 0) && (((param_2 & 0x4000) != 0 || (DAT_004122e8 != 0x8000)))) {
    local_5 = local_5 | 0x80;
  }
  uVar2 = param_2 & 3;
  if (uVar2 == 0) {
    local_10 = 0x80000000;
  }
  else if (uVar2 == 1) {
    local_10 = 0x40000000;
  }
  else {
    if (uVar2 != 2) goto LAB_0040a568;
    local_10 = 0xc0000000;
  }
  if (param_3 == 0x10) {
    local_14 = 0;
  }
  else if (param_3 == 0x20) {
    local_14 = 1;
  }
  else if (param_3 == 0x30) {
    local_14 = 2;
  }
  else {
    if (param_3 != 0x40) goto LAB_0040a568;
    local_14 = 3;
  }
  uVar2 = param_2 & 0x700;
  if (uVar2 < 0x401) {
    if ((uVar2 == 0x400) || (uVar2 == 0)) {
      local_c = 3;
    }
    else if (uVar2 == 0x100) {
      local_c = 4;
    }
    else {
      if (uVar2 == 0x200) goto LAB_0040a582;
      if (uVar2 != 0x300) goto LAB_0040a568;
      local_c = 2;
    }
  }
  else {
    if (uVar2 != 0x500) {
      if (uVar2 == 0x600) {
LAB_0040a582:
        local_c = 5;
        goto LAB_0040a592;
      }
      if (uVar2 != 0x700) {
LAB_0040a568:
        pDVar4 = FUN_00405095();
        *pDVar4 = 0x16;
        pDVar4 = FUN_0040509e();
        *pDVar4 = 0;
        return 0xffffffff;
      }
    }
    local_c = 1;
  }
LAB_0040a592:
  uVar2 = 0x80;
  if (((param_2 & 0x100) != 0) && ((~DAT_004120e8 & param_4 & 0x80) == 0)) {
    uVar2 = 1;
  }
  if ((param_2 & 0x40) != 0) {
    uVar2 = uVar2 | 0x4000000;
    local_10 = CONCAT13(local_10._3_1_,0x10000);
  }
  if ((param_2 & 0x1000) != 0) {
    uVar2 = uVar2 | 0x100;
  }
  if ((param_2 & 0x20) == 0) {
    if ((param_2 & 0x10) != 0) {
      uVar2 = uVar2 | 0x10000000;
    }
  }
  else {
    uVar2 = uVar2 | 0x8000000;
  }
  uVar3 = FUN_0040a116();
  if (uVar3 == 0xffffffff) {
    pDVar4 = FUN_00405095();
    *pDVar4 = 0x18;
    pDVar4 = FUN_0040509e();
    *pDVar4 = 0;
    return 0xffffffff;
  }
  hFile = CreateFileA(param_1,local_10,local_14,&local_20,local_c,uVar2,(HANDLE)0x0);
  if (hFile != (HANDLE)0xffffffff) {
    DVar5 = GetFileType(hFile);
    if (DVar5 != 0) {
      if (DVar5 == 2) {
        local_5 = local_5 | 0x40;
      }
      else if (DVar5 == 3) {
        local_5 = local_5 | 8;
      }
      FUN_0040a239(uVar3,hFile);
      iVar7 = (uVar3 & 0x1f) * 0x24;
      param_1._3_1_ = local_5 & 0x48;
      *(byte *)((&DAT_004136c0)[(int)uVar3 >> 5] + 4 + iVar7) = local_5 | 1;
      if ((((local_5 & 0x48) == 0) && ((local_5 & 0x80) != 0)) && ((param_2 & 2) != 0)) {
        local_14 = FUN_004083a0(uVar3,-1,2);
        if (local_14 == 0xffffffff) {
          pDVar4 = FUN_0040509e();
          if (*pDVar4 == 0x83) goto LAB_0040a70c;
        }
        else {
          param_3 = param_3 & 0xffffff;
          iVar6 = FUN_00408162(uVar3,(char *)((int)&param_3 + 3),(char *)0x1);
          if ((((iVar6 != 0) || (param_3._3_1_ != '\x1a')) ||
              (iVar6 = FUN_0040ad8d(uVar3,local_14), iVar6 != -1)) &&
             (DVar5 = FUN_004083a0(uVar3,0,0), DVar5 != 0xffffffff)) goto LAB_0040a70c;
        }
        FUN_00407f16(uVar3);
        uVar2 = 0xffffffff;
      }
      else {
LAB_0040a70c:
        uVar2 = uVar3;
        if ((param_1._3_1_ == 0) && ((param_2 & 8) != 0)) {
          pbVar1 = (byte *)((&DAT_004136c0)[(int)uVar3 >> 5] + 4 + iVar7);
          *pbVar1 = *pbVar1 | 0x20;
        }
      }
      goto LAB_0040a725;
    }
    CloseHandle(hFile);
  }
  DVar5 = GetLastError();
  FUN_00405022(DVar5);
  uVar2 = 0xffffffff;
LAB_0040a725:
  FUN_0040a3d5(uVar3);
  return uVar2;
}



Function: FUN_0040a733
----------------------------------------

LPSTR __cdecl FUN_0040a733(LPSTR param_1,WCHAR param_2)

{
  LPSTR pCVar1;
  bool bVar2;
  
  InterlockedIncrement((LONG *)&DAT_0041243c);
  bVar2 = DAT_00412438 != 0;
  if (bVar2) {
    InterlockedDecrement((LONG *)&DAT_0041243c);
    FUN_00407d25(0x13);
  }
  pCVar1 = FUN_0040a78c(param_1,param_2);
  if (bVar2) {
    FUN_00407d86(0x13);
  }
  else {
    InterlockedDecrement((LONG *)&DAT_0041243c);
  }
  return pCVar1;
}



Function: FUN_0040a78c
----------------------------------------

LPSTR __cdecl FUN_0040a78c(LPSTR param_1,WCHAR param_2)

{
  LPSTR pCVar1;
  DWORD *pDVar2;
  
  pCVar1 = param_1;
  if (param_1 == (LPSTR)0x0) {
    return param_1;
  }
  if (DAT_004122cc == 0) {
    if ((ushort)param_2 < 0x100) {
      *param_1 = (CHAR)param_2;
      return (LPSTR)0x1;
    }
  }
  else {
    param_1 = (LPSTR)0x0;
    pCVar1 = (LPSTR)WideCharToMultiByte(DAT_004122dc,0x220,&param_2,1,pCVar1,DAT_00411a54,
                                        (LPCSTR)0x0,(LPBOOL)&param_1);
    if ((pCVar1 != (LPSTR)0x0) && (param_1 == (LPSTR)0x0)) {
      return pCVar1;
    }
  }
  pDVar2 = FUN_00405095();
  *pDVar2 = 0x2a;
  return (LPSTR)0xffffffff;
}



Function: __aulldiv
----------------------------------------

/* Library Function - Single Match
    __aulldiv
   
   Library: Visual Studio */

undefined8 __aulldiv(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  int iVar4;
  uint uVar5;
  uint uVar6;
  uint uVar7;
  uint uVar8;
  uint uVar9;
  
  uVar3 = param_1;
  uVar8 = param_4;
  uVar6 = param_2;
  uVar9 = param_3;
  if (param_4 == 0) {
    uVar3 = param_2 / param_3;
    iVar4 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) /
                 (ulonglong)param_3);
  }
  else {
    do {
      uVar5 = uVar8 >> 1;
      uVar9 = uVar9 >> 1 | (uint)((uVar8 & 1) != 0) << 0x1f;
      uVar7 = uVar6 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar6 & 1) != 0) << 0x1f;
      uVar8 = uVar5;
      uVar6 = uVar7;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar7,uVar3) / (ulonglong)uVar9;
    iVar4 = (int)uVar1;
    lVar2 = (ulonglong)param_3 * (uVar1 & 0xffffffff);
    uVar3 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar8 = uVar3 + iVar4 * param_4;
    if (((CARRY4(uVar3,iVar4 * param_4)) || (param_2 < uVar8)) ||
       ((param_2 <= uVar8 && (param_1 < (uint)lVar2)))) {
      iVar4 = iVar4 + -1;
    }
    uVar3 = 0;
  }
  return CONCAT44(uVar3,iVar4);
}



Function: __aullrem
----------------------------------------

/* Library Function - Single Match
    __aullrem
   
   Library: Visual Studio */

undefined8 __aullrem(uint param_1,uint param_2,uint param_3,uint param_4)

{
  ulonglong uVar1;
  longlong lVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  int iVar6;
  int iVar7;
  uint uVar8;
  uint uVar9;
  uint uVar10;
  bool bVar11;
  
  uVar3 = param_1;
  uVar4 = param_4;
  uVar9 = param_2;
  uVar10 = param_3;
  if (param_4 == 0) {
    iVar6 = (int)(((ulonglong)param_2 % (ulonglong)param_3 << 0x20 | (ulonglong)param_1) %
                 (ulonglong)param_3);
    iVar7 = 0;
  }
  else {
    do {
      uVar5 = uVar4 >> 1;
      uVar10 = uVar10 >> 1 | (uint)((uVar4 & 1) != 0) << 0x1f;
      uVar8 = uVar9 >> 1;
      uVar3 = uVar3 >> 1 | (uint)((uVar9 & 1) != 0) << 0x1f;
      uVar4 = uVar5;
      uVar9 = uVar8;
    } while (uVar5 != 0);
    uVar1 = CONCAT44(uVar8,uVar3) / (ulonglong)uVar10;
    uVar3 = (int)uVar1 * param_4;
    lVar2 = (uVar1 & 0xffffffff) * (ulonglong)param_3;
    uVar9 = (uint)((ulonglong)lVar2 >> 0x20);
    uVar4 = (uint)lVar2;
    uVar10 = uVar9 + uVar3;
    if (((CARRY4(uVar9,uVar3)) || (param_2 < uVar10)) || ((param_2 <= uVar10 && (param_1 < uVar4))))
    {
      bVar11 = uVar4 < param_3;
      uVar4 = uVar4 - param_3;
      uVar10 = (uVar10 - param_4) - (uint)bVar11;
    }
    iVar6 = -(uVar4 - param_1);
    iVar7 = -(uint)(uVar4 - param_1 != 0) - ((uVar10 - param_2) - (uint)(uVar4 < param_1));
  }
  return CONCAT44(iVar7,iVar6);
}



Function: FUN_0040a8e5
----------------------------------------

BOOL __cdecl
FUN_0040a8e5(DWORD param_1,LPCSTR param_2,int param_3,LPWORD param_4,UINT param_5,LCID param_6,
            int param_7)

{
  undefined1 *puVar1;
  BOOL BVar2;
  int iVar3;
  WORD local_20 [2];
  undefined1 *local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d598;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffc8;
  iVar3 = DAT_004122c0;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffc8;
  if (DAT_004122c0 == 0) {
    ExceptionList = &local_14;
    BVar2 = GetStringTypeW(1,L"",1,local_20);
    iVar3 = 1;
    puVar1 = local_1c;
    if (BVar2 == 0) {
      BVar2 = GetStringTypeA(0,1,"",1,local_20);
      if (BVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      iVar3 = 2;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  DAT_004122c0 = iVar3;
  if (DAT_004122c0 != 2) {
    if (DAT_004122c0 == 1) {
      if (param_5 == 0) {
        param_5 = DAT_004122dc;
      }
      iVar3 = MultiByteToWideChar(param_5,(-(uint)(param_7 != 0) & 8) + 1,param_2,param_3,
                                  (LPWSTR)0x0,0);
      if (iVar3 != 0) {
        local_8 = 0;
        FUN_00404a80();
        local_1c = &stack0xffffffc8;
        _memset(&stack0xffffffc8,0,iVar3 * 2);
        local_8 = 0xffffffff;
        if ((&stack0x00000000 != (undefined1 *)0x38) &&
           (iVar3 = MultiByteToWideChar(param_5,1,param_2,param_3,(LPWSTR)&stack0xffffffc8,iVar3),
           iVar3 != 0)) {
          BVar2 = GetStringTypeW(param_1,(LPCWSTR)&stack0xffffffc8,iVar3,param_4);
          ExceptionList = local_14;
          return BVar2;
        }
      }
    }
    ExceptionList = local_14;
    return 0;
  }
  if (param_6 == 0) {
    param_6 = DAT_004122cc;
  }
  BVar2 = GetStringTypeA(param_6,param_1,param_2,param_3,param_4);
  ExceptionList = local_14;
  return BVar2;
}



Function: FUN_0040aa2e
----------------------------------------

int __cdecl
FUN_0040aa2e(LCID param_1,uint param_2,char *param_3,int param_4,LPWSTR param_5,int param_6,
            UINT param_7,int param_8)

{
  int iVar1;
  int iVar2;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d5a8;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  ExceptionList = &local_14;
  if (DAT_004122e4 == 0) {
    ExceptionList = &local_14;
    iVar1 = LCMapStringW(0,0x100,L"",1,(LPWSTR)0x0,0);
    if (iVar1 == 0) {
      iVar1 = LCMapStringA(0,0x100,"",1,(LPSTR)0x0,0);
      if (iVar1 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_004122e4 = 2;
    }
    else {
      DAT_004122e4 = 1;
    }
  }
  if (0 < param_4) {
    param_4 = FUN_0040bba5(param_3,param_4);
  }
  if (DAT_004122e4 == 2) {
    iVar1 = LCMapStringA(param_1,param_2,param_3,param_4,(LPSTR)param_5,param_6);
    ExceptionList = local_14;
    return iVar1;
  }
  if (DAT_004122e4 == 1) {
    if (param_7 == 0) {
      param_7 = DAT_004122dc;
    }
    iVar1 = MultiByteToWideChar(param_7,(-(uint)(param_8 != 0) & 8) + 1,param_3,param_4,(LPWSTR)0x0,
                                0);
    if (iVar1 != 0) {
      local_8 = 0;
      FUN_00404a80();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined1 *)0x3c) &&
         (iVar2 = MultiByteToWideChar(param_7,1,param_3,param_4,(LPWSTR)&stack0xffffffc4,iVar1),
         iVar2 != 0)) {
        iVar2 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          if ((param_2 & 0x400) == 0) {
            local_8 = 1;
            FUN_00404a80();
            local_8 = 0xffffffff;
            if (&stack0x00000000 == (undefined1 *)0x3c) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,
                                 (LPWSTR)&stack0xffffffc4,iVar2);
            if (iVar1 == 0) {
              ExceptionList = local_14;
              return 0;
            }
            if (param_6 == 0) {
              param_6 = 0;
              param_5 = (LPWSTR)0x0;
            }
            iVar2 = WideCharToMultiByte(param_7,0x220,(LPCWSTR)&stack0xffffffc4,iVar2,(LPSTR)param_5
                                        ,param_6,(LPCSTR)0x0,(LPBOOL)0x0);
            iVar1 = iVar2;
          }
          else {
            if (param_6 == 0) {
              ExceptionList = local_14;
              return iVar2;
            }
            if (param_6 < iVar2) {
              ExceptionList = local_14;
              return 0;
            }
            iVar1 = LCMapStringW(param_1,param_2,(LPCWSTR)&stack0xffffffc4,iVar1,param_5,param_6);
          }
          if (iVar1 != 0) {
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



Function: FUN_0040ac52
----------------------------------------

uint __cdecl FUN_0040ac52(uint param_1)

{
  void *extraout_ECX;
  bool bVar1;
  void *this;
  
  if (DAT_004122cc == 0) {
    if ((0x60 < (int)param_1) && ((int)param_1 < 0x7b)) {
      return param_1 - 0x20;
    }
  }
  else {
    InterlockedIncrement((LONG *)&DAT_0041243c);
    bVar1 = DAT_00412438 != 0;
    this = extraout_ECX;
    if (bVar1) {
      InterlockedDecrement((LONG *)&DAT_0041243c);
      this = (void *)0x13;
      FUN_00407d25(0x13);
    }
    param_1 = FUN_0040acc1(this,param_1);
    if (bVar1) {
      FUN_00407d86(0x13);
    }
    else {
      InterlockedDecrement((LONG *)&DAT_0041243c);
    }
  }
  return param_1;
}



Function: FUN_0040acc1
----------------------------------------

uint __thiscall FUN_0040acc1(void *this,uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  void *local_8;
  
  uVar1 = param_1;
  if (DAT_004122cc == 0) {
    if ((0x60 < (int)param_1) && ((int)param_1 < 0x7b)) {
      uVar1 = param_1 - 0x20;
    }
  }
  else {
    local_8 = this;
    if ((int)param_1 < 0x100) {
      if (DAT_00411a54 < 2) {
        uVar2 = (byte)PTR_DAT_00411848[param_1 * 2] & 2;
      }
      else {
        uVar2 = FUN_004091f0(this,param_1,2);
      }
      if (uVar2 == 0) {
        return uVar1;
      }
    }
    if ((PTR_DAT_00411848[((int)uVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      param_1 = CONCAT31((int3)(param_1 >> 8),(char)uVar1) & 0xffff00ff;
      iVar3 = 1;
    }
    else {
      uVar2 = param_1 >> 0x10;
      param_1._0_2_ = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
      param_1 = CONCAT22((short)uVar2,(undefined2)param_1) & 0xff00ffff;
      iVar3 = 2;
    }
    iVar3 = FUN_0040aa2e(DAT_004122cc,0x200,(char *)&param_1,iVar3,(LPWSTR)&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        uVar1 = (uint)local_8 & 0xff;
      }
      else {
        uVar1 = (uint)local_8 & 0xffff;
      }
    }
  }
  return uVar1;
}



Function: FUN_0040ad8d
----------------------------------------

int __cdecl FUN_0040ad8d(uint param_1,int param_2)

{
  DWORD DVar1;
  DWORD DVar2;
  int iVar3;
  uint uVar4;
  int iVar5;
  DWORD *pDVar6;
  HANDLE hFile;
  BOOL BVar7;
  int iVar8;
  uint uVar9;
  char local_1008 [4064];
  undefined4 uStackY_28;
  
  FUN_00404a80();
  iVar8 = 0;
  DVar1 = FUN_004083a0(param_1,0,1);
  if ((DVar1 == 0xffffffff) || (DVar2 = FUN_004083a0(param_1,0,2), DVar2 == 0xffffffff)) {
    iVar8 = -1;
  }
  else {
    uVar9 = param_2 - DVar2;
    if ((int)uVar9 < 1) {
      if ((int)uVar9 < 0) {
        FUN_004083a0(param_1,param_2,0);
        hFile = (HANDLE)FUN_0040a334(param_1);
        BVar7 = SetEndOfFile(hFile);
        iVar8 = (BVar7 != 0) - 1;
        if (iVar8 == -1) {
          pDVar6 = FUN_00405095();
          *pDVar6 = 0xd;
          DVar2 = GetLastError();
          pDVar6 = FUN_0040509e();
          *pDVar6 = DVar2;
        }
      }
    }
    else {
      _memset(local_1008,0,0x1000);
      uStackY_28 = 0x40adfa;
      iVar3 = FUN_0040aebb(param_1,0x8000);
      do {
        uVar4 = 0x1000;
        if ((int)uVar9 < 0x1000) {
          uVar4 = uVar9;
        }
        iVar5 = FUN_00408590(param_1,local_1008,uVar4);
        if (iVar5 == -1) {
          pDVar6 = FUN_0040509e();
          if (*pDVar6 == 5) {
            pDVar6 = FUN_00405095();
            *pDVar6 = 0xd;
          }
          iVar8 = -1;
          break;
        }
        uVar9 = uVar9 - iVar5;
      } while (0 < (int)uVar9);
      FUN_0040aebb(param_1,iVar3);
    }
    FUN_004083a0(param_1,DVar1,0);
  }
  return iVar8;
}



Function: FUN_0040aeb2
----------------------------------------

void FUN_0040aeb2(void)

{
  __amsg_exit(2);
  return;
}



Function: FUN_0040aebb
----------------------------------------

int __cdecl FUN_0040aebb(uint param_1,int param_2)

{
  byte bVar1;
  DWORD *pDVar2;
  byte bVar3;
  
  bVar1 = *(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24);
  if (param_2 == 0x8000) {
    bVar3 = bVar1 & 0x7f;
  }
  else {
    if (param_2 != 0x4000) {
      pDVar2 = FUN_00405095();
      *pDVar2 = 0x16;
      return -1;
    }
    bVar3 = bVar1 | 0x80;
  }
  *(byte *)((&DAT_004136c0)[(int)param_1 >> 5] + 4 + (param_1 & 0x1f) * 0x24) = bVar3;
  return (-(uint)((bVar1 & 0x80) != 0) & 0xffffc000) + 0x8000;
}



Function: FUN_0040af20
----------------------------------------

int __cdecl FUN_0040af20(byte *param_1,byte *param_2)

{
  byte bVar1;
  int iVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *param_2;
    if (bVar1 == 0) break;
    param_2 = param_2 + 1;
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  iVar2 = -1;
  do {
    iVar2 = iVar2 + 1;
    bVar1 = *param_1;
    if (bVar1 == 0) {
      return iVar2;
    }
    param_1 = param_1 + 1;
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return iVar2;
}



Function: FUN_0040af60
----------------------------------------

byte * __cdecl FUN_0040af60(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte abStack_28 [32];
  
  abStack_28[0x1c] = 0;
  abStack_28[0x1d] = 0;
  abStack_28[0x1e] = 0;
  abStack_28[0x1f] = 0;
  abStack_28[0x18] = 0;
  abStack_28[0x19] = 0;
  abStack_28[0x1a] = 0;
  abStack_28[0x1b] = 0;
  abStack_28[0x14] = 0;
  abStack_28[0x15] = 0;
  abStack_28[0x16] = 0;
  abStack_28[0x17] = 0;
  abStack_28[0x10] = 0;
  abStack_28[0x11] = 0;
  abStack_28[0x12] = 0;
  abStack_28[0x13] = 0;
  abStack_28[0xc] = 0;
  abStack_28[0xd] = 0;
  abStack_28[0xe] = 0;
  abStack_28[0xf] = 0;
  abStack_28[8] = 0;
  abStack_28[9] = 0;
  abStack_28[10] = 0;
  abStack_28[0xb] = 0;
  abStack_28[4] = 0;
  abStack_28[5] = 0;
  abStack_28[6] = 0;
  abStack_28[7] = 0;
  abStack_28[0] = 0;
  abStack_28[1] = 0;
  abStack_28[2] = 0;
  abStack_28[3] = 0;
  while( true ) {
    bVar1 = *param_2;
    if (bVar1 == 0) break;
    param_2 = param_2 + 1;
    abStack_28[(int)(uint)bVar1 >> 3] = abStack_28[(int)(uint)bVar1 >> 3] | '\x01' << (bVar1 & 7);
  }
  do {
    pbVar2 = param_1;
    bVar1 = *pbVar2;
    if (bVar1 == 0) {
      return (byte *)(uint)bVar1;
    }
    param_1 = pbVar2 + 1;
  } while ((abStack_28[(int)(uint)bVar1 >> 3] >> (bVar1 & 7) & 1) == 0);
  return pbVar2;
}



Function: FUN_0040afa0
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

uint __thiscall FUN_0040afa0(void *this,byte *param_1,byte *param_2)

{
  bool bVar1;
  int iVar2;
  byte bVar3;
  byte bVar4;
  byte bVar5;
  uint uVar6;
  void *extraout_ECX;
  void *this_00;
  void *extraout_ECX_00;
  uint uVar7;
  uint uVar8;
  
  iVar2 = _DAT_0041243c;
  if (DAT_004122cc == 0) {
    bVar5 = 0xff;
    do {
      do {
        if (bVar5 == 0) goto LAB_0040afee;
        bVar5 = *param_2;
        param_2 = param_2 + 1;
        bVar4 = *param_1;
        param_1 = param_1 + 1;
      } while (bVar4 == bVar5);
      bVar3 = bVar5 + 0xbf + (-((byte)(bVar5 + 0xbf) < 0x1a) & 0x20U) + 0x41;
      bVar4 = bVar4 + 0xbf;
      bVar5 = bVar4 + (-(bVar4 < 0x1a) & 0x20U) + 0x41;
    } while (bVar5 == bVar3);
    bVar5 = (bVar5 < bVar3) * -2 + 1;
LAB_0040afee:
    uVar6 = (uint)(char)bVar5;
  }
  else {
    LOCK();
    _DAT_0041243c = _DAT_0041243c + 1;
    UNLOCK();
    bVar1 = 0 < DAT_00412438;
    if (bVar1) {
      LOCK();
      UNLOCK();
      _DAT_0041243c = iVar2;
      FUN_00407d25(0x13);
      this = extraout_ECX;
    }
    uVar8 = (uint)bVar1;
    uVar6 = 0xff;
    uVar7 = 0;
    do {
      do {
        if ((char)uVar6 == '\0') goto LAB_0040b04f;
        bVar5 = *param_2;
        uVar6 = CONCAT31((int3)(uVar6 >> 8),bVar5);
        param_2 = param_2 + 1;
        bVar4 = *param_1;
        uVar7 = CONCAT31((int3)(uVar7 >> 8),bVar4);
        param_1 = param_1 + 1;
      } while (bVar5 == bVar4);
      uVar7 = FUN_0040b733(this,uVar7);
      uVar6 = FUN_0040b733(this_00,uVar6);
      this = extraout_ECX_00;
    } while ((byte)uVar7 == (byte)uVar6);
    uVar7 = (uint)((byte)uVar7 < (byte)uVar6);
    uVar6 = (1 - uVar7) - (uint)(uVar7 != 0);
LAB_0040b04f:
    if (uVar8 == 0) {
      LOCK();
      _DAT_0041243c = _DAT_0041243c + -1;
      UNLOCK();
    }
    else {
      FUN_00407d86(0x13);
    }
  }
  return uVar6;
}



Function: FUN_0040b070
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void * __cdecl FUN_0040b070(byte *param_1,char *param_2,void *param_3)

{
  char cVar1;
  int iVar2;
  byte bVar3;
  ushort uVar4;
  uint uVar5;
  void *this;
  uint uVar6;
  bool bVar7;
  uint uVar8;
  
  iVar2 = _DAT_0041243c;
  if (param_3 != (void *)0x0) {
    if (DAT_004122cc == 0) {
      do {
        bVar3 = *param_1;
        cVar1 = *param_2;
        uVar4 = CONCAT11(bVar3,cVar1);
        if (bVar3 == 0) break;
        uVar4 = CONCAT11(bVar3,cVar1);
        uVar6 = (uint)uVar4;
        if (cVar1 == '\0') break;
        param_1 = param_1 + 1;
        param_2 = param_2 + 1;
        if ((0x40 < bVar3) && (bVar3 < 0x5b)) {
          uVar6 = (uint)CONCAT11(bVar3 + 0x20,cVar1);
        }
        uVar4 = (ushort)uVar6;
        bVar3 = (byte)uVar6;
        if ((0x40 < bVar3) && (bVar3 < 0x5b)) {
          uVar4 = (ushort)CONCAT31((int3)(uVar6 >> 8),bVar3 + 0x20);
        }
        bVar3 = (byte)(uVar4 >> 8);
        bVar7 = bVar3 < (byte)uVar4;
        if (bVar3 != (byte)uVar4) goto LAB_0040b0cf;
        param_3 = (void *)((int)param_3 + -1);
      } while (param_3 != (void *)0x0);
      param_3 = (void *)0x0;
      bVar3 = (byte)(uVar4 >> 8);
      bVar7 = bVar3 < (byte)uVar4;
      if (bVar3 != (byte)uVar4) {
LAB_0040b0cf:
        param_3 = (void *)0xffffffff;
        if (!bVar7) {
          param_3 = (void *)0x1;
        }
      }
    }
    else {
      LOCK();
      _DAT_0041243c = _DAT_0041243c + 1;
      UNLOCK();
      bVar7 = 0 < DAT_00412438;
      if (bVar7) {
        LOCK();
        UNLOCK();
        _DAT_0041243c = iVar2;
        FUN_00407d25(0x13);
      }
      uVar8 = (uint)bVar7;
      uVar5 = 0;
      uVar6 = 0;
      do {
        uVar5 = CONCAT31((int3)(uVar5 >> 8),*param_1);
        uVar6 = CONCAT31((int3)(uVar6 >> 8),*param_2);
        if ((uVar5 == 0) || (uVar6 == 0)) break;
        param_1 = param_1 + 1;
        param_2 = param_2 + 1;
        uVar6 = FUN_0040b733(param_3,uVar6);
        uVar5 = FUN_0040b733(this,uVar5);
        bVar7 = uVar5 < uVar6;
        if (uVar5 != uVar6) goto LAB_0040b145;
        param_3 = (void *)((int)param_3 + -1);
      } while (param_3 != (void *)0x0);
      param_3 = (void *)0x0;
      bVar7 = uVar5 < uVar6;
      if (uVar5 != uVar6) {
LAB_0040b145:
        param_3 = (void *)0xffffffff;
        if (!bVar7) {
          param_3 = (void *)0x1;
        }
      }
      if (uVar8 == 0) {
        LOCK();
        _DAT_0041243c = _DAT_0041243c + -1;
        UNLOCK();
      }
      else {
        FUN_00407d86(0x13);
      }
    }
  }
  return param_3;
}



Function: FUN_0040b171
----------------------------------------

void FUN_0040b171(void)

{
  if (DAT_00412428 == 0) {
    FUN_00407d25(0xb);
    if (DAT_00412428 == 0) {
      FUN_0040b19f();
      DAT_00412428 = DAT_00412428 + 1;
    }
    FUN_00407d86(0xb);
  }
  return;
}



Function: FUN_0040b19f
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void FUN_0040b19f(void)

{
  char cVar1;
  char cVar2;
  uint *_Str1;
  DWORD DVar3;
  int iVar4;
  size_t sVar5;
  void *this;
  uint *_Source;
  int local_8;
  
  FUN_00407d25(0xc);
  DAT_00411e38 = 0xffffffff;
  DAT_00411e28 = 0xffffffff;
  DAT_00412370 = 0;
  _Str1 = (uint *)FUN_0040b7fe("TZ");
  if (_Str1 == (uint *)0x0) {
    FUN_00407d86(0xc);
    DVar3 = GetTimeZoneInformation((LPTIME_ZONE_INFORMATION)&DAT_00412378);
    if (DVar3 == 0xffffffff) {
      return;
    }
    DAT_00411d90 = (void *)(DAT_00412378 * 0x3c);
    DAT_00412370 = 1;
    if (DAT_004123be != 0) {
      DAT_00411d90 = (void *)((int)DAT_00411d90 + DAT_004123cc * 0x3c);
    }
    if ((DAT_00412412 == 0) || (DAT_00412420 == 0)) {
      DAT_00411d94 = 0;
      _DAT_00411d98 = 0;
    }
    else {
      DAT_00411d94 = 1;
      _DAT_00411d98 = (DAT_00412420 - DAT_004123cc) * 0x3c;
    }
    iVar4 = WideCharToMultiByte(DAT_004122dc,0x220,(LPCWSTR)&DAT_0041237c,-1,PTR_DAT_00411e1c,0x3f,
                                (LPCSTR)0x0,&local_8);
    if ((iVar4 == 0) || (local_8 != 0)) {
      *PTR_DAT_00411e1c = 0;
    }
    else {
      PTR_DAT_00411e1c[0x3f] = 0;
    }
    iVar4 = WideCharToMultiByte(DAT_004122dc,0x220,(LPCWSTR)&DAT_004123d0,-1,PTR_DAT_00411e20,0x3f,
                                (LPCSTR)0x0,&local_8);
    if ((iVar4 != 0) && (local_8 == 0)) {
      PTR_DAT_00411e20[0x3f] = 0;
      return;
    }
LAB_0040b410:
    *PTR_DAT_00411e20 = 0;
  }
  else {
    if (((char)*_Str1 != '\0') &&
       ((DAT_00412424 == (uint *)0x0 ||
        (iVar4 = _strcmp((char *)_Str1,(char *)DAT_00412424), iVar4 != 0)))) {
      FUN_00404d98((undefined *)DAT_00412424);
      sVar5 = _strlen((char *)_Str1);
      DAT_00412424 = (uint *)_malloc(sVar5 + 1);
      if (DAT_00412424 != (uint *)0x0) {
        FUN_00404b30(DAT_00412424,_Str1);
        FUN_00407d86(0xc);
        _strncpy(PTR_DAT_00411e1c,(char *)_Str1,3);
        _Source = (uint *)((int)_Str1 + 3);
        PTR_DAT_00411e1c[3] = 0;
        cVar2 = *(char *)_Source;
        if (cVar2 == '-') {
          _Source = _Str1 + 1;
        }
        iVar4 = FUN_00405b70(this,(byte *)_Source);
        DAT_00411d90 = (void *)(iVar4 * 0xe10);
        for (; (cVar1 = (char)*_Source, cVar1 == '+' || (('/' < cVar1 && (cVar1 < ':'))));
            _Source = (uint *)((int)_Source + 1)) {
        }
        if ((char)*_Source == ':') {
          _Source = (uint *)((int)_Source + 1);
          iVar4 = FUN_00405b70(DAT_00411d90,(byte *)_Source);
          DAT_00411d90 = (void *)((int)DAT_00411d90 + iVar4 * 0x3c);
          for (; ('/' < (char)*_Source && ((char)*_Source < ':'));
              _Source = (uint *)((int)_Source + 1)) {
          }
          if ((char)*_Source == ':') {
            _Source = (uint *)((int)_Source + 1);
            iVar4 = FUN_00405b70(DAT_00411d90,(byte *)_Source);
            DAT_00411d90 = (void *)((int)DAT_00411d90 + iVar4);
            for (; ('/' < (char)*_Source && ((char)*_Source < ':'));
                _Source = (uint *)((int)_Source + 1)) {
            }
          }
        }
        if (cVar2 == '-') {
          DAT_00411d90 = (void *)-(int)DAT_00411d90;
        }
        DAT_00411d94 = (int)(char)*_Source;
        if (DAT_00411d94 != 0) {
          _strncpy(PTR_DAT_00411e20,(char *)_Source,3);
          PTR_DAT_00411e20[3] = 0;
          return;
        }
        goto LAB_0040b410;
      }
    }
    FUN_00407d86(0xc);
  }
  return;
}



Function: FUN_0040b426
----------------------------------------

bool __cdecl FUN_0040b426(int *param_1)

{
  bool bVar1;
  
  FUN_00407d25(0xb);
  bVar1 = FUN_0040b447(param_1);
  FUN_00407d86(0xb);
  return bVar1;
}



Function: FUN_0040b447
----------------------------------------

bool __cdecl FUN_0040b447(int *param_1)

{
  int iVar1;
  int iVar2;
  uint uVar3;
  uint uVar4;
  uint uVar5;
  uint uVar6;
  
  if (DAT_00411d94 != 0) {
    uVar5 = param_1[5];
    if ((uVar5 != DAT_00411e28) || (uVar5 != DAT_00411e38)) {
      if (DAT_00412370 == 0) {
        FUN_0040b5f3(1,1,uVar5,4,1,0,0,2,0,0,0);
        FUN_0040b5f3(0,1,param_1[5],10,5,0,0,2,0,0,0);
      }
      else {
        if (DAT_00412410 != 0) {
          uVar6 = (uint)DAT_00412416;
          uVar3 = 0;
          uVar4 = 0;
        }
        else {
          uVar3 = (uint)DAT_00412414;
          uVar6 = 0;
          uVar4 = (uint)DAT_00412416;
        }
        FUN_0040b5f3(1,(uint)(DAT_00412410 == 0),uVar5,(uint)DAT_00412412,uVar4,uVar3,uVar6,
                     (uint)DAT_00412418,(uint)DAT_0041241a,(uint)DAT_0041241c,(uint)DAT_0041241e);
        if (DAT_004123bc != 0) {
          uVar6 = (uint)DAT_004123c2;
          uVar3 = 0;
          uVar4 = 0;
          uVar5 = param_1[5];
        }
        else {
          uVar3 = (uint)DAT_004123c0;
          uVar6 = 0;
          uVar4 = (uint)DAT_004123c2;
          uVar5 = param_1[5];
        }
        FUN_0040b5f3(0,(uint)(DAT_004123bc == 0),uVar5,(uint)DAT_004123be,uVar4,uVar3,uVar6,
                     (uint)DAT_004123c4,(uint)DAT_004123c6,(uint)DAT_004123c8,(uint)DAT_004123ca);
      }
    }
    iVar1 = param_1[7];
    if (DAT_00411e2c < DAT_00411e3c) {
      if ((DAT_00411e2c <= iVar1) && (iVar1 <= DAT_00411e3c)) {
        if ((DAT_00411e2c < iVar1) && (iVar1 < DAT_00411e3c)) {
          return true;
        }
LAB_0040b5bf:
        iVar2 = ((param_1[2] * 0x3c + param_1[1]) * 0x3c + *param_1) * 1000;
        if (iVar1 == DAT_00411e2c) {
          return DAT_00411e30 <= iVar2;
        }
        return iVar2 < DAT_00411e40;
      }
    }
    else {
      if (iVar1 < DAT_00411e3c) {
        return true;
      }
      if (DAT_00411e2c < iVar1) {
        return true;
      }
      if ((iVar1 <= DAT_00411e3c) || (DAT_00411e2c <= iVar1)) goto LAB_0040b5bf;
    }
  }
  return false;
}



Function: FUN_0040b5f3
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

void __cdecl
FUN_0040b5f3(int param_1,int param_2,uint param_3,int param_4,int param_5,int param_6,int param_7,
            int param_8,int param_9,int param_10,int param_11)

{
  int iVar1;
  int iVar2;
  
  if (param_2 == 1) {
    if ((param_3 & 3) == 0) {
      iVar1 = (&DAT_00411e40)[param_4];
    }
    else {
      iVar1 = *(int *)(&DAT_00411e74 + param_4 * 4);
    }
    iVar2 = (int)(param_3 * 0x16d + -0x63db + iVar1 + 1 + ((int)(param_3 - 1) >> 2)) % 7;
    if (param_6 < iVar2) {
      iVar1 = iVar1 + 1 + (param_5 * 7 - iVar2) + param_6;
    }
    else {
      iVar1 = iVar1 + -6 + (param_5 * 7 - iVar2) + param_6;
    }
    if (param_5 == 5) {
      if ((param_3 & 3) == 0) {
        iVar2 = *(int *)(&DAT_00411e44 + param_4 * 4);
      }
      else {
        iVar2 = *(int *)(&DAT_00411e78 + param_4 * 4);
      }
      if (iVar2 < iVar1) {
        iVar1 = iVar1 + -7;
      }
    }
  }
  else {
    if ((param_3 & 3) == 0) {
      iVar1 = (&DAT_00411e40)[param_4];
    }
    else {
      iVar1 = *(int *)(&DAT_00411e74 + param_4 * 4);
    }
    iVar1 = iVar1 + param_7;
  }
  if (param_1 == 1) {
    DAT_00411e28 = param_3;
    DAT_00411e30 = ((param_8 * 0x3c + param_9) * 0x3c + param_10) * 1000 + param_11;
    DAT_00411e2c = iVar1;
  }
  else {
    DAT_00411e40 = ((param_8 * 0x3c + param_9) * 0x3c + _DAT_00411d98 + param_10) * 1000 + param_11;
    if (DAT_00411e40 < 0) {
      DAT_00411e40 = DAT_00411e40 + 86400000;
      DAT_00411e3c = iVar1 + -1;
    }
    else {
      DAT_00411e3c = iVar1;
      if (86399999 < DAT_00411e40) {
        DAT_00411e40 = DAT_00411e40 + -86400000;
        DAT_00411e3c = iVar1 + 1;
      }
    }
    DAT_00411e38 = param_3;
  }
  return;
}



Function: FUN_0040b733
----------------------------------------

uint __thiscall FUN_0040b733(void *this,uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  void *local_8;
  
  uVar1 = param_1;
  if (DAT_004122cc == 0) {
    if ((0x40 < (int)param_1) && ((int)param_1 < 0x5b)) {
      uVar1 = param_1 + 0x20;
    }
  }
  else {
    iVar3 = 1;
    local_8 = this;
    if ((int)param_1 < 0x100) {
      if (DAT_00411a54 < 2) {
        uVar2 = (byte)PTR_DAT_00411848[param_1 * 2] & 1;
      }
      else {
        uVar2 = FUN_004091f0(this,param_1,1);
      }
      if (uVar2 == 0) {
        return uVar1;
      }
    }
    if ((PTR_DAT_00411848[((int)uVar1 >> 8 & 0xffU) * 2 + 1] & 0x80) == 0) {
      param_1 = CONCAT31((int3)(param_1 >> 8),(char)uVar1) & 0xffff00ff;
    }
    else {
      uVar2 = param_1 >> 0x10;
      param_1._0_2_ = CONCAT11((char)uVar1,(char)(uVar1 >> 8));
      param_1 = CONCAT22((short)uVar2,(undefined2)param_1) & 0xff00ffff;
      iVar3 = 2;
    }
    iVar3 = FUN_0040aa2e(DAT_004122cc,0x100,(char *)&param_1,iVar3,(LPWSTR)&local_8,3,0,1);
    if (iVar3 != 0) {
      if (iVar3 == 1) {
        uVar1 = (uint)local_8 & 0xff;
      }
      else {
        uVar1 = (uint)local_8 & 0xffff;
      }
    }
  }
  return uVar1;
}



Function: FUN_0040b7fe
----------------------------------------

int __cdecl FUN_0040b7fe(uchar *param_1)

{
  int iVar1;
  size_t _MaxCount;
  size_t sVar2;
  int *piVar3;
  
  if (((DAT_004137c4 != 0) &&
      ((DAT_00412108 != (int *)0x0 ||
       (((DAT_00412110 != 0 && (iVar1 = FUN_0040b8ba(), iVar1 == 0)) && (DAT_00412108 != (int *)0x0)
        ))))) && (piVar3 = DAT_00412108, param_1 != (uchar *)0x0)) {
    _MaxCount = _strlen((char *)param_1);
    for (; (char *)*piVar3 != (char *)0x0; piVar3 = piVar3 + 1) {
      sVar2 = _strlen((char *)*piVar3);
      if (((_MaxCount < sVar2) && (((uchar *)*piVar3)[_MaxCount] == '=')) &&
         (iVar1 = __mbsnbicoll((uchar *)*piVar3,param_1,_MaxCount), iVar1 == 0)) {
        return *piVar3 + 1 + _MaxCount;
      }
    }
  }
  return 0;
}



Function: __mbsnbicoll
----------------------------------------

/* Library Function - Single Match
    __mbsnbicoll
   
   Library: Visual Studio 2003 Release */

int __cdecl __mbsnbicoll(uchar *_Str1,uchar *_Str2,size_t _MaxCount)

{
  int iVar1;
  
  if (_MaxCount == 0) {
    return 0;
  }
  iVar1 = FUN_0040b928(DAT_00412664,1,_Str1,_MaxCount,_Str2,_MaxCount,DAT_00412440);
  if (iVar1 == 0) {
    return 0x7fffffff;
  }
  return iVar1 + -2;
}



Function: FUN_0040b8ba
----------------------------------------

undefined4 FUN_0040b8ba(void)

{
  LPCWSTR lpWideCharStr;
  size_t _Size;
  uint *lpMultiByteStr;
  int iVar1;
  undefined4 *puVar2;
  
  lpWideCharStr = (LPCWSTR)*DAT_00412110;
  puVar2 = DAT_00412110;
  while( true ) {
    if (lpWideCharStr == (LPCWSTR)0x0) {
      return 0;
    }
    _Size = WideCharToMultiByte(1,0,lpWideCharStr,-1,(LPSTR)0x0,0,(LPCSTR)0x0,(LPBOOL)0x0);
    if (((_Size == 0) || (lpMultiByteStr = (uint *)_malloc(_Size), lpMultiByteStr == (uint *)0x0))
       || (iVar1 = WideCharToMultiByte(1,0,(LPCWSTR)*puVar2,-1,(LPSTR)lpMultiByteStr,_Size,
                                       (LPCSTR)0x0,(LPBOOL)0x0), iVar1 == 0)) break;
    FUN_0040bbd0(lpMultiByteStr,0);
    lpWideCharStr = (LPCWSTR)puVar2[1];
    puVar2 = puVar2 + 1;
  }
  return 0xffffffff;
}



Function: FUN_0040b928
----------------------------------------

int __cdecl
FUN_0040b928(LCID param_1,DWORD param_2,byte *param_3,int param_4,byte *param_5,int param_6,
            UINT param_7)

{
  undefined1 *puVar1;
  int iVar2;
  BOOL BVar3;
  BYTE *pBVar4;
  int iVar5;
  _cpinfo local_40;
  undefined1 *local_2c;
  PCNZWCH local_28;
  int local_24;
  int local_20;
  undefined1 *local_1c;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d728;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  local_1c = &stack0xffffffb0;
  ExceptionList = &local_14;
  puVar1 = &stack0xffffffb0;
  if (DAT_00412434 == 0) {
    ExceptionList = &local_14;
    iVar2 = CompareStringW(0,0,L"",1,L"",1);
    if (iVar2 == 0) {
      iVar2 = CompareStringA(0,0,"",1,"",1);
      if (iVar2 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      DAT_00412434 = 2;
      puVar1 = local_1c;
    }
    else {
      DAT_00412434 = 1;
      puVar1 = local_1c;
    }
  }
  local_1c = puVar1;
  if (0 < param_4) {
    param_4 = FUN_0040bba5((char *)param_3,param_4);
  }
  if (0 < param_6) {
    param_6 = FUN_0040bba5((char *)param_5,param_6);
  }
  if (DAT_00412434 == 2) {
    iVar2 = CompareStringA(param_1,param_2,(PCNZCH)param_3,param_4,(PCNZCH)param_5,param_6);
    ExceptionList = local_14;
    return iVar2;
  }
  if (DAT_00412434 == 1) {
    if (param_7 == 0) {
      param_7 = DAT_004122dc;
    }
    if ((param_4 == 0) || (param_6 == 0)) {
      if (param_4 == param_6) {
        ExceptionList = local_14;
        return 2;
      }
      if (1 < param_6) {
        ExceptionList = local_14;
        return 1;
      }
      if (1 < param_4) {
        ExceptionList = local_14;
        return 3;
      }
      BVar3 = GetCPInfo(param_7,&local_40);
      if (BVar3 == 0) {
        ExceptionList = local_14;
        return 0;
      }
      if (0 < param_4) {
        if (local_40.MaxCharSize < 2) {
          ExceptionList = local_14;
          return 3;
        }
        pBVar4 = local_40.LeadByte;
        while( true ) {
          if (local_40.LeadByte[0] == 0) {
            ExceptionList = local_14;
            return 3;
          }
          if (pBVar4[1] == 0) break;
          if ((*pBVar4 <= *param_3) && (*param_3 <= pBVar4[1])) {
            ExceptionList = local_14;
            return 2;
          }
          pBVar4 = pBVar4 + 2;
          local_40.LeadByte[0] = *pBVar4;
        }
        ExceptionList = local_14;
        return 3;
      }
      if (0 < param_6) {
        if (local_40.MaxCharSize < 2) {
          ExceptionList = local_14;
          return 1;
        }
        pBVar4 = local_40.LeadByte;
        while( true ) {
          if (local_40.LeadByte[0] == 0) {
            ExceptionList = local_14;
            return 1;
          }
          if (pBVar4[1] == 0) break;
          if ((*pBVar4 <= *param_5) && (*param_5 <= pBVar4[1])) {
            ExceptionList = local_14;
            return 2;
          }
          pBVar4 = pBVar4 + 2;
          local_40.LeadByte[0] = *pBVar4;
        }
        ExceptionList = local_14;
        return 1;
      }
    }
    local_20 = MultiByteToWideChar(param_7,9,(LPCSTR)param_3,param_4,(LPWSTR)0x0,0);
    if (local_20 != 0) {
      local_8 = 0;
      FUN_00404a80();
      local_8 = 0xffffffff;
      if ((&stack0x00000000 != (undefined1 *)0x50) &&
         (local_28 = (PCNZWCH)&stack0xffffffb0, local_1c = &stack0xffffffb0,
         iVar2 = MultiByteToWideChar(param_7,1,(LPCSTR)param_3,param_4,(LPWSTR)&stack0xffffffb0,
                                     local_20), iVar2 != 0)) {
        iVar2 = MultiByteToWideChar(param_7,9,(LPCSTR)param_5,param_6,(LPWSTR)0x0,0);
        if (iVar2 != 0) {
          local_8 = 1;
          local_24 = iVar2;
          FUN_00404a80();
          local_8 = 0xffffffff;
          if ((&stack0x00000000 != (undefined1 *)0x50) &&
             (local_2c = &stack0xffffffb0, local_1c = &stack0xffffffb0,
             iVar5 = MultiByteToWideChar(param_7,1,(LPCSTR)param_5,param_6,(LPWSTR)&stack0xffffffb0,
                                         iVar2), iVar5 != 0)) {
            iVar2 = CompareStringW(param_1,param_2,local_28,local_20,(PCNZWCH)&stack0xffffffb0,iVar2
                                  );
            ExceptionList = local_14;
            return iVar2;
          }
        }
      }
    }
  }
  ExceptionList = local_14;
  return 0;
}



Function: FUN_0040bba5
----------------------------------------

int __cdecl FUN_0040bba5(char *param_1,int param_2)

{
  char *pcVar1;
  int iVar2;
  
  pcVar1 = param_1;
  iVar2 = param_2;
  if (param_2 != 0) {
    do {
      iVar2 = iVar2 + -1;
      if (*pcVar1 == '\0') break;
      pcVar1 = pcVar1 + 1;
    } while (iVar2 != 0);
  }
  if (*pcVar1 == '\0') {
    return (int)pcVar1 - (int)param_1;
  }
  return param_2;
}



Function: FUN_0040bbd0
----------------------------------------

undefined4 __cdecl FUN_0040bbd0(uint *param_1,int param_2)

{
  byte *pbVar1;
  uint *puVar2;
  int iVar3;
  byte *pbVar4;
  size_t sVar5;
  uint *lpName;
  byte *pbVar6;
  bool bVar7;
  
  if (param_1 == (uint *)0x0) {
    return 0xffffffff;
  }
  puVar2 = (uint *)FUN_0040c145((byte *)param_1,0x3d);
  if (puVar2 == (uint *)0x0) {
    return 0xffffffff;
  }
  if (param_1 == puVar2) {
    return 0xffffffff;
  }
  bVar7 = *(byte *)((int)puVar2 + 1) == 0;
  if (DAT_00412108 == DAT_0041210c) {
    DAT_00412108 = (byte *)FUN_0040bdaf((int *)DAT_00412108);
  }
  if (DAT_00412108 == (byte *)0x0) {
    if ((param_2 == 0) || (DAT_00412110 == (undefined4 *)0x0)) {
      if (bVar7) {
        return 0;
      }
      DAT_00412108 = (byte *)_malloc(4);
      if (DAT_00412108 == (byte *)0x0) {
        return 0xffffffff;
      }
      pbVar4 = DAT_00412108 + 1;
      pbVar6 = DAT_00412108 + 2;
      pbVar1 = DAT_00412108 + 3;
      DAT_00412108[0] = 0;
      *pbVar4 = 0;
      *pbVar6 = 0;
      *pbVar1 = 0;
      if (DAT_00412110 == (undefined4 *)0x0) {
        DAT_00412110 = (undefined4 *)_malloc(4);
        if (DAT_00412110 == (undefined4 *)0x0) {
          return 0xffffffff;
        }
        *DAT_00412110 = 0;
      }
    }
    else {
      iVar3 = FUN_0040b8ba();
      if (iVar3 != 0) {
        return 0xffffffff;
      }
    }
  }
  pbVar4 = DAT_00412108;
  iVar3 = FUN_0040bd57((uchar *)param_1,(int)puVar2 - (int)param_1);
  if ((iVar3 < 0) || (*(int *)pbVar4 == 0)) {
    if (bVar7) {
      return 0;
    }
    if (iVar3 < 0) {
      iVar3 = -iVar3;
    }
    pbVar4 = FUN_0040be16(pbVar4,(uint *)(iVar3 * 4 + 8));
    if (pbVar4 == (byte *)0x0) {
      return 0xffffffff;
    }
    *(uint **)(pbVar4 + iVar3 * 4) = param_1;
    pbVar6 = pbVar4 + iVar3 * 4 + 4;
    pbVar6[0] = 0;
    pbVar6[1] = 0;
    pbVar6[2] = 0;
    pbVar6[3] = 0;
  }
  else {
    if (!bVar7) {
      *(uint **)(pbVar4 + iVar3 * 4) = param_1;
      goto LAB_0040bd04;
    }
    pbVar6 = pbVar4 + iVar3 * 4;
    FUN_00404d98(*(undefined **)(pbVar4 + iVar3 * 4));
    for (; *(int *)pbVar6 != 0; pbVar6 = pbVar6 + 4) {
      iVar3 = iVar3 + 1;
      *(int *)pbVar6 = *(int *)(pbVar6 + 4);
    }
    pbVar4 = FUN_0040be16(pbVar4,(uint *)(iVar3 << 2));
    if (pbVar4 == (byte *)0x0) goto LAB_0040bd04;
  }
  DAT_00412108 = pbVar4;
LAB_0040bd04:
  if (param_2 != 0) {
    sVar5 = _strlen((char *)param_1);
    lpName = (uint *)_malloc(sVar5 + 2);
    if (lpName != (uint *)0x0) {
      FUN_00404b30(lpName,param_1);
      pbVar4 = (byte *)(((int)lpName - (int)param_1) + (int)puVar2);
      *pbVar4 = 0;
      SetEnvironmentVariableA((LPCSTR)lpName,(LPCSTR)(~-(uint)bVar7 & (uint)(pbVar4 + 1)));
      FUN_00404d98((undefined *)lpName);
    }
  }
  return 0;
}



Function: FUN_0040bd57
----------------------------------------

int __cdecl FUN_0040bd57(uchar *param_1,size_t param_2)

{
  uchar *_Str2;
  int iVar1;
  int *piVar2;
  
  _Str2 = (uchar *)*DAT_00412108;
  piVar2 = DAT_00412108;
  while( true ) {
    if (_Str2 == (uchar *)0x0) {
      return -((int)piVar2 - (int)DAT_00412108 >> 2);
    }
    iVar1 = __mbsnbicoll(param_1,_Str2,param_2);
    if ((iVar1 == 0) &&
       ((*(char *)(*piVar2 + param_2) == '=' || (*(char *)(*piVar2 + param_2) == '\0')))) break;
    _Str2 = (uchar *)piVar2[1];
    piVar2 = piVar2 + 1;
  }
  return (int)piVar2 - (int)DAT_00412108 >> 2;
}



Function: FUN_0040bdaf
----------------------------------------

undefined4 * __cdecl FUN_0040bdaf(int *param_1)

{
  int iVar1;
  int *piVar2;
  undefined4 *puVar3;
  uint *puVar4;
  int iVar5;
  undefined4 *puVar6;
  
  iVar5 = 0;
  if (param_1 != (int *)0x0) {
    iVar1 = *param_1;
    piVar2 = param_1;
    while (iVar1 != 0) {
      piVar2 = piVar2 + 1;
      iVar5 = iVar5 + 1;
      iVar1 = *piVar2;
    }
    puVar3 = (undefined4 *)_malloc(iVar5 * 4 + 4);
    if (puVar3 == (undefined4 *)0x0) {
      __amsg_exit(9);
    }
    puVar4 = (uint *)*param_1;
    puVar6 = puVar3;
    while (puVar4 != (uint *)0x0) {
      param_1 = param_1 + 1;
      puVar4 = FUN_0040c1dc(puVar4);
      *puVar6 = puVar4;
      puVar6 = puVar6 + 1;
      puVar4 = (uint *)*param_1;
    }
    *puVar6 = 0;
    return puVar3;
  }
  return (undefined4 *)0x0;
}



Function: FUN_0040be16
----------------------------------------

byte * __cdecl FUN_0040be16(byte *param_1,uint *param_2)

{
  int iVar1;
  uint *puVar2;
  byte *pbVar3;
  int local_3c;
  uint *local_38;
  byte *local_34;
  int *local_30;
  uint *local_2c;
  byte *local_28;
  uint *local_24;
  void *local_14;
  undefined1 *puStack_10;
  undefined *puStack_c;
  undefined4 local_8;
  
  local_8 = 0xffffffff;
  puStack_c = &DAT_0040d740;
  puStack_10 = &LAB_00406884;
  local_14 = ExceptionList;
  pbVar3 = (byte *)0x0;
  if (param_1 == (byte *)0x0) {
    ExceptionList = &local_14;
    pbVar3 = (byte *)_malloc((size_t)param_2);
  }
  else {
    if (param_2 == (uint *)0x0) {
      ExceptionList = &local_14;
      FUN_00404d98(param_1);
    }
    else {
      ExceptionList = &local_14;
      if (DAT_004136a4 == 3) {
        do {
          local_28 = (byte *)0x0;
          if (param_2 < (uint *)0xffffffe1) {
            FUN_00407d25(9);
            local_8 = 0;
            local_2c = (uint *)FUN_00406b30((int)param_1);
            if (local_2c != (uint *)0x0) {
              if (param_2 <= DAT_0041369c) {
                iVar1 = FUN_00407339(local_2c,(int)param_1,(int)param_2);
                if (iVar1 == 0) {
                  local_28 = (byte *)FUN_00406e84(param_2);
                  if (local_28 != (byte *)0x0) {
                    local_24 = (uint *)(*(int *)(param_1 + -4) - 1);
                    puVar2 = local_24;
                    if (param_2 <= local_24) {
                      puVar2 = param_2;
                    }
                    FUN_004055b0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                    local_2c = (uint *)FUN_00406b30((int)param_1);
                    FUN_00406b5b(local_2c,(int)param_1);
                  }
                }
                else {
                  local_28 = param_1;
                }
              }
              if (local_28 == (byte *)0x0) {
                if (param_2 == (uint *)0x0) {
                  param_2 = (uint *)0x1;
                }
                param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
                local_28 = (byte *)HeapAlloc(DAT_004136a0,0,(SIZE_T)param_2);
                if (local_28 != (byte *)0x0) {
                  local_24 = (uint *)(*(int *)(param_1 + -4) - 1);
                  puVar2 = local_24;
                  if (param_2 <= local_24) {
                    puVar2 = param_2;
                  }
                  FUN_004055b0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                  FUN_00406b5b(local_2c,(int)param_1);
                }
              }
            }
            local_8 = 0xffffffff;
            FUN_0040bfa1();
            if (local_2c == (uint *)0x0) {
              if (param_2 == (uint *)0x0) {
                param_2 = (uint *)0x1;
              }
              param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
              local_28 = (byte *)HeapReAlloc(DAT_004136a0,0,param_1,(SIZE_T)param_2);
            }
          }
          if (local_28 != (byte *)0x0) {
            ExceptionList = local_14;
            return local_28;
          }
          if (DAT_004122a0 == (byte *)0x0) {
            ExceptionList = local_14;
            return (byte *)0x0;
          }
          iVar1 = FUN_00407d9b(param_2);
        } while (iVar1 != 0);
      }
      else {
        ExceptionList = &local_14;
        if (DAT_004136a4 == 2) {
          ExceptionList = &local_14;
          if (param_2 < (uint *)0xffffffe1) {
            if (param_2 == (uint *)0x0) {
              param_2 = (uint *)0x10;
              ExceptionList = &local_14;
            }
            else {
              param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
              ExceptionList = &local_14;
            }
          }
          do {
            local_28 = pbVar3;
            if (param_2 < (uint *)0xffffffe1) {
              FUN_00407d25(9);
              local_8 = 1;
              pbVar3 = (byte *)FUN_0040788b(param_1,&local_3c,(uint *)&local_30);
              local_34 = pbVar3;
              if (pbVar3 == (byte *)0x0) {
                local_28 = (byte *)HeapReAlloc(DAT_004136a0,0,param_1,(SIZE_T)param_2);
              }
              else {
                if (param_2 < DAT_004114fc) {
                  iVar1 = FUN_00407c53(local_3c,local_30,pbVar3,(uint)param_2 >> 4);
                  if (iVar1 == 0) {
                    local_28 = (byte *)FUN_00407927((uint)param_2 >> 4);
                    if (local_28 != (byte *)0x0) {
                      local_38 = (uint *)((uint)*pbVar3 << 4);
                      puVar2 = local_38;
                      if (param_2 <= local_38) {
                        puVar2 = param_2;
                      }
                      FUN_004055b0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                      FUN_004078e2(local_3c,(int)local_30,pbVar3);
                    }
                  }
                  else {
                    local_28 = param_1;
                  }
                }
                if ((local_28 == (byte *)0x0) &&
                   (local_28 = (byte *)HeapAlloc(DAT_004136a0,0,(SIZE_T)param_2),
                   local_28 != (byte *)0x0)) {
                  local_38 = (uint *)((uint)*pbVar3 << 4);
                  puVar2 = local_38;
                  if (param_2 <= local_38) {
                    puVar2 = param_2;
                  }
                  FUN_004055b0((undefined4 *)local_28,(undefined4 *)param_1,(uint)puVar2);
                  FUN_004078e2(local_3c,(int)local_30,pbVar3);
                }
              }
              local_8 = 0xffffffff;
              FUN_0040c0ef();
            }
            if (local_28 != pbVar3) {
              ExceptionList = local_14;
              return local_28;
            }
            if (DAT_004122a0 == pbVar3) {
              ExceptionList = local_14;
              return local_28;
            }
            iVar1 = FUN_00407d9b(param_2);
          } while (iVar1 != 0);
        }
        else {
          do {
            pbVar3 = (byte *)0x0;
            if (param_2 < (uint *)0xffffffe1) {
              if (param_2 == (uint *)0x0) {
                param_2 = (uint *)0x1;
              }
              param_2 = (uint *)((int)param_2 + 0xfU & 0xfffffff0);
              pbVar3 = (byte *)HeapReAlloc(DAT_004136a0,0,param_1,(SIZE_T)param_2);
            }
            if (pbVar3 != (byte *)0x0) {
              ExceptionList = local_14;
              return pbVar3;
            }
            if (DAT_004122a0 == (byte *)0x0) {
              ExceptionList = local_14;
              return (byte *)0x0;
            }
            iVar1 = FUN_00407d9b(param_2);
          } while (iVar1 != 0);
        }
      }
    }
    pbVar3 = (byte *)0x0;
  }
  ExceptionList = local_14;
  return pbVar3;
}



Function: FUN_0040bfa1
----------------------------------------

void FUN_0040bfa1(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_0040c0ef
----------------------------------------

void FUN_0040c0ef(void)

{
  FUN_00407d86(9);
  return;
}



Function: FUN_0040c145
----------------------------------------

byte * __cdecl FUN_0040c145(byte *param_1,uint param_2)

{
  byte bVar1;
  byte *pbVar2;
  uint uVar3;
  
  if (DAT_0041245c == 0) {
    pbVar2 = (byte *)_strchr((char *)param_1,param_2);
  }
  else {
    FUN_00407d25(0x19);
    while( true ) {
      bVar1 = *param_1;
      uVar3 = (uint)bVar1;
      if (bVar1 == 0) break;
      if (((&DAT_00412561)[uVar3] & 4) == 0) {
        pbVar2 = param_1;
        if (param_2 == uVar3) break;
      }
      else {
        pbVar2 = param_1 + 1;
        if (param_1[1] == 0) {
          FUN_00407d86(0x19);
          return (byte *)0x0;
        }
        if (param_2 == CONCAT11(bVar1,param_1[1])) {
          FUN_00407d86(0x19);
          return param_1;
        }
      }
      param_1 = pbVar2 + 1;
    }
    FUN_00407d86(0x19);
    pbVar2 = (byte *)(~-(uint)(param_2 != uVar3) & (uint)param_1);
  }
  return pbVar2;
}



Function: FUN_0040c1dc
----------------------------------------

uint * __cdecl FUN_0040c1dc(uint *param_1)

{
  size_t sVar1;
  uint *puVar2;
  
  if (param_1 != (uint *)0x0) {
    sVar1 = _strlen((char *)param_1);
    puVar2 = (uint *)_malloc(sVar1 + 1);
    if (puVar2 != (uint *)0x0) {
      puVar2 = FUN_00404b30(puVar2,param_1);
      return puVar2;
    }
  }
  return (uint *)0x0;
}



Function: RtlUnwind
----------------------------------------

void RtlUnwind(PVOID TargetFrame,PVOID TargetIp,PEXCEPTION_RECORD ExceptionRecord,PVOID ReturnValue)

{
                    /* WARNING: Could not recover jumptable at 0x0040c210. Too many branches */
                    /* WARNING: Treating indirect jump as call */
  RtlUnwind(TargetFrame,TargetIp,ExceptionRecord,ReturnValue);
  return;
}



Function: FUN_0040c216
----------------------------------------

uint __cdecl FUN_0040c216(byte param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  uint uVar3;
  uint uVar4;
  void *this;
  undefined *puVar5;
  undefined *this_00;
  
  pbVar2 = param_2;
  if (param_2[1] == 0x3a) {
    pbVar2 = param_2 + 2;
  }
  bVar1 = *pbVar2;
  if ((((bVar1 == 0x5c) || (bVar1 == 0x2f)) && (pbVar2[1] == 0)) ||
     (((param_1 & 0x10) != 0 || (uVar4 = 0x8000, bVar1 == 0)))) {
    uVar4 = 0x4040;
  }
  this = (void *)0x2e;
  uVar4 = uVar4 | (uint)(~param_1 & 1 | 2) << 7;
  pbVar2 = FUN_0040c78e(param_2,0x2e);
  if (pbVar2 != (byte *)0x0) {
    puVar5 = &DAT_0040d770;
    uVar3 = FUN_0040c5f9(this,pbVar2,&DAT_0040d770);
    if (uVar3 != 0) {
      this_00 = &DAT_0040d768;
      uVar3 = FUN_0040c5f9(puVar5,pbVar2,&DAT_0040d768);
      if (uVar3 != 0) {
        puVar5 = &DAT_0040d760;
        uVar3 = FUN_0040c5f9(this_00,pbVar2,&DAT_0040d760);
        if (uVar3 != 0) {
          uVar3 = FUN_0040c5f9(puVar5,pbVar2,&DAT_0040d758);
          if (uVar3 != 0) goto LAB_0040c2b7;
        }
      }
    }
    uVar4 = uVar4 | 0x40;
  }
LAB_0040c2b7:
  return (uVar4 & 0x1c0) >> 6 | uVar4 | uVar4 >> 3 & 0x38;
}



Function: FUN_0040c2ce
----------------------------------------

undefined4 __cdecl FUN_0040c2ce(byte *param_1,int *param_2)

{
  byte *pbVar1;
  DWORD *pDVar2;
  uint uVar3;
  uint *_Str;
  size_t sVar4;
  int iVar5;
  UINT UVar6;
  BOOL BVar7;
  DWORD DVar8;
  uint local_268 [65];
  _WIN32_FIND_DATAA local_164;
  int local_24;
  _FILETIME local_20;
  HANDLE local_18;
  _SYSTEMTIME local_14;
  
  pbVar1 = FUN_0040ca25(param_1,&DAT_0040d77c);
  if (pbVar1 != (byte *)0x0) {
LAB_0040c301:
    pDVar2 = FUN_00405095();
    *pDVar2 = 2;
    pDVar2 = FUN_0040509e();
    *pDVar2 = 2;
    return 0xffffffff;
  }
  if (param_1[1] == 0x3a) {
    if ((*param_1 != 0) && (param_1[2] == 0)) goto LAB_0040c301;
    uVar3 = FUN_0040c9aa((int)(char)*param_1);
    local_24 = uVar3 - 0x60;
  }
  else {
    local_24 = FUN_0040c967();
  }
  local_18 = FindFirstFileA((LPCSTR)param_1,&local_164);
  if (local_18 == (HANDLE)0xffffffff) {
    pbVar1 = FUN_0040ca25(param_1,&DAT_0040d778);
    if ((((pbVar1 == (byte *)0x0) ||
         (_Str = FUN_0040c8c2(local_268,(LPCSTR)param_1,0x104), _Str == (uint *)0x0)) ||
        ((sVar4 = _strlen((char *)_Str), sVar4 != 3 &&
         (iVar5 = FUN_0040c589((char *)_Str), iVar5 == 0)))) ||
       (UVar6 = GetDriveTypeA((LPCSTR)_Str), UVar6 < 2)) {
      pDVar2 = FUN_00405095();
      *pDVar2 = 2;
      pDVar2 = FUN_0040509e();
      *pDVar2 = 2;
      return 0xffffffff;
    }
    local_164.dwFileAttributes = 0x10;
    local_164.nFileSizeHigh = 0;
    local_164.nFileSizeLow = 0;
    local_164.cFileName[0] = '\0';
    iVar5 = FUN_0040c800(0x7bc,1,1,0,0,0,-1);
    param_2[7] = iVar5;
    param_2[6] = iVar5;
    param_2[8] = iVar5;
  }
  else {
    BVar7 = FileTimeToLocalFileTime(&local_164.ftLastWriteTime,&local_20);
    if ((BVar7 == 0) || (BVar7 = FileTimeToSystemTime(&local_20,&local_14), BVar7 == 0)) {
LAB_0040c56c:
      DVar8 = GetLastError();
      FUN_00405022(DVar8);
      FindClose(local_18);
      return 0xffffffff;
    }
    iVar5 = FUN_0040c800((uint)local_14.wYear,(uint)local_14.wMonth,(uint)local_14.wDay,
                         (uint)local_14.wHour,(uint)local_14.wMinute,(uint)local_14.wSecond,-1);
    param_2[7] = iVar5;
    if ((local_164.ftLastAccessTime.dwLowDateTime != 0) ||
       (local_164.ftLastAccessTime.dwHighDateTime != 0)) {
      BVar7 = FileTimeToLocalFileTime(&local_164.ftLastAccessTime,&local_20);
      if ((BVar7 == 0) || (BVar7 = FileTimeToSystemTime(&local_20,&local_14), BVar7 == 0))
      goto LAB_0040c56c;
      iVar5 = FUN_0040c800((uint)local_14.wYear,(uint)local_14.wMonth,(uint)local_14.wDay,
                           (uint)local_14.wHour,(uint)local_14.wMinute,(uint)local_14.wSecond,-1);
    }
    param_2[6] = iVar5;
    if ((local_164.ftCreationTime.dwLowDateTime == 0) &&
       (local_164.ftCreationTime.dwHighDateTime == 0)) {
      iVar5 = param_2[7];
    }
    else {
      BVar7 = FileTimeToLocalFileTime(&local_164.ftCreationTime,&local_20);
      if ((BVar7 == 0) || (BVar7 = FileTimeToSystemTime(&local_20,&local_14), BVar7 == 0))
      goto LAB_0040c56c;
      iVar5 = FUN_0040c800((uint)local_14.wYear,(uint)local_14.wMonth,(uint)local_14.wDay,
                           (uint)local_14.wHour,(uint)local_14.wMinute,(uint)local_14.wSecond,-1);
    }
    param_2[8] = iVar5;
    FindClose(local_18);
  }
  uVar3 = FUN_0040c216((byte)local_164.dwFileAttributes,param_1);
  *(short *)((int)param_2 + 6) = (short)uVar3;
  param_2[5] = local_164.nFileSizeLow;
  *param_2 = local_24 + -1;
  param_2[4] = local_24 + -1;
  *(undefined2 *)(param_2 + 2) = 1;
  *(undefined2 *)(param_2 + 1) = 0;
  *(undefined2 *)(param_2 + 3) = 0;
  *(undefined2 *)((int)param_2 + 10) = 0;
  return 0;
}



Function: FUN_0040c589
----------------------------------------

undefined4 __cdecl FUN_0040c589(char *param_1)

{
  char *pcVar1;
  size_t sVar2;
  char *pcVar3;
  char cVar4;
  
  sVar2 = _strlen(param_1);
  if (((4 < sVar2) && ((*param_1 == '\\' || (*param_1 == '/')))) &&
     ((param_1[1] == '\\' || (param_1[1] == '/')))) {
    pcVar3 = param_1 + 3;
    cVar4 = param_1[3];
    while (((cVar4 != '\0' && (cVar4 != '\\')) && (cVar4 != '/'))) {
      pcVar1 = pcVar3 + 1;
      pcVar3 = pcVar3 + 1;
      cVar4 = *pcVar1;
    }
    if ((*pcVar3 != '\0') && (pcVar3 = pcVar3 + 1, *pcVar3 != '\0')) {
      for (; (cVar4 = *pcVar3, cVar4 != '\0' && ((cVar4 != '\\' && (cVar4 != '/'))));
          pcVar3 = pcVar3 + 1) {
      }
      if ((*pcVar3 == '\0') || (pcVar3[1] == '\0')) {
        return 1;
      }
    }
  }
  return 0;
}



Function: FUN_0040c5f9
----------------------------------------

uint __thiscall FUN_0040c5f9(void *this,byte *param_1,byte *param_2)

{
  byte *pbVar1;
  byte bVar2;
  uint uVar3;
  int iVar4;
  byte *pbVar5;
  ushort uVar6;
  ushort uVar7;
  byte *local_10;
  byte *local_c;
  byte local_8;
  byte local_7;
  
  if (DAT_0041245c == 0) {
    uVar3 = FUN_0040afa0(this,param_1,param_2);
  }
  else {
    FUN_00407d25(0x19);
    local_10 = param_2 + -1;
    local_c = param_1 + -1;
    do {
      uVar3 = (uint)*param_1;
      pbVar5 = param_1 + 1;
      pbVar1 = local_c + 1;
      if (((&DAT_00412561)[uVar3] & 4) == 0) {
        param_1 = pbVar5;
        local_c = pbVar1;
        if (((&DAT_00412561)[uVar3] & 0x10) == 0x10) {
          uVar3 = (uint)(byte)(&DAT_00412460)[uVar3];
        }
      }
      else if (*pbVar5 == 0) {
        uVar3 = 0;
        param_1 = pbVar5;
        local_c = pbVar1;
      }
      else {
        iVar4 = FUN_0040aa2e(DAT_00412664,0x200,(char *)pbVar1,2,(LPWSTR)&local_8,2,DAT_00412440,1);
        if (iVar4 == 1) {
          uVar3 = (uint)local_8;
        }
        else {
          if (iVar4 != 2) goto LAB_0040c75d;
          uVar3 = (uint)local_8 * 0x100 + (uint)local_7;
        }
        param_1 = param_1 + 2;
        local_c = local_c + 2;
      }
      bVar2 = *param_2;
      uVar6 = (ushort)bVar2;
      pbVar5 = param_2 + 1;
      pbVar1 = local_10 + 1;
      if (((&DAT_00412561)[bVar2] & 4) == 0) {
        param_2 = pbVar5;
        local_10 = pbVar1;
        if (((&DAT_00412561)[bVar2] & 0x10) == 0x10) {
          uVar6 = (ushort)(byte)(&DAT_00412460)[bVar2];
        }
      }
      else if (*pbVar5 == 0) {
        uVar6 = 0;
        param_2 = pbVar5;
        local_10 = pbVar1;
      }
      else {
        iVar4 = FUN_0040aa2e(DAT_00412664,0x200,(char *)pbVar1,2,(LPWSTR)&local_8,2,DAT_00412440,1);
        if (iVar4 == 1) {
          uVar6 = (ushort)local_8;
        }
        else {
          if (iVar4 != 2) {
LAB_0040c75d:
            FUN_00407d86(0x19);
            return 0x7fffffff;
          }
          uVar6 = (ushort)local_8 * 0x100 + (ushort)local_7;
        }
        param_2 = param_2 + 2;
        local_10 = local_10 + 2;
      }
      uVar7 = (ushort)uVar3;
      if (uVar7 != uVar6) {
        FUN_00407d86(0x19);
        return (-(uint)(uVar6 < uVar7) & 2) - 1;
      }
    } while (uVar7 != 0);
    FUN_00407d86(0x19);
    uVar3 = 0;
  }
  return uVar3;
}



Function: FUN_0040c78e
----------------------------------------

byte * __cdecl FUN_0040c78e(byte *param_1,uint param_2)

{
  byte bVar1;
  ushort uVar2;
  byte *pbVar3;
  byte bVar4;
  byte *pbVar5;
  bool bVar6;
  
  pbVar5 = (byte *)0x0;
  if (DAT_0041245c == 0) {
    pbVar5 = (byte *)_strrchr((char *)param_1,param_2);
  }
  else {
    FUN_00407d25(0x19);
    do {
      bVar4 = *param_1;
      if (((&DAT_00412561)[bVar4] & 4) == 0) {
        bVar6 = param_2 == bVar4;
LAB_0040c7e9:
        pbVar3 = param_1;
        if (bVar6) {
          pbVar5 = param_1;
        }
      }
      else {
        bVar1 = param_1[1];
        pbVar3 = param_1 + 1;
        if (bVar1 == 0) {
          bVar6 = pbVar5 == (byte *)0x0;
          param_1 = pbVar3;
          bVar4 = bVar1;
          goto LAB_0040c7e9;
        }
        uVar2 = CONCAT11(bVar4,bVar1);
        bVar4 = bVar1;
        if (param_2 == uVar2) {
          pbVar5 = param_1;
        }
      }
      param_1 = pbVar3 + 1;
    } while (bVar4 != 0);
    FUN_00407d86(0x19);
  }
  return pbVar5;
}



Function: FUN_0040c800
----------------------------------------

/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

int __cdecl
FUN_0040c800(int param_1,int param_2,int param_3,int param_4,int param_5,int param_6,int param_7)

{
  bool bVar1;
  undefined3 extraout_var;
  int iVar2;
  uint uVar3;
  int iVar4;
  int local_28 [2];
  int local_20;
  int local_18;
  uint local_14;
  int local_c;
  
  uVar3 = param_1 - 0x76c;
  if (((int)uVar3 < 0x46) || (0x8a < (int)uVar3)) {
    iVar2 = -1;
  }
  else {
    iVar4 = *(int *)(&DAT_00411e74 + param_2 * 4) + param_3;
    if (((uVar3 & 3) == 0) && (2 < param_2)) {
      iVar4 = iVar4 + 1;
    }
    FUN_0040b171();
    local_20 = param_4;
    local_18 = param_2 + -1;
    iVar2 = ((param_4 + (uVar3 * 0x16d + iVar4 + (param_1 + -0x76d >> 2)) * 0x18) * 0x3c + param_5)
            * 0x3c + DAT_00411d90 + 0x7c558180 + param_6;
    if ((param_7 == 1) ||
       (((param_7 == -1 && (DAT_00411d94 != 0)) &&
        (local_14 = uVar3, local_c = iVar4, bVar1 = FUN_0040b426(local_28),
        CONCAT31(extraout_var,bVar1) != 0)))) {
      iVar2 = iVar2 + _DAT_00411d98;
    }
  }
  return iVar2;
}



Function: FUN_0040c8c2
----------------------------------------

uint * __cdecl FUN_0040c8c2(uint *param_1,LPCSTR param_2,size_t param_3)

{
  LPCSTR lpFileName;
  uint *puVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  
  lpFileName = param_2;
  if ((param_2 != (LPCSTR)0x0) && (*param_2 != '\0')) {
    puVar1 = param_1;
    if (param_1 == (uint *)0x0) {
      puVar1 = (uint *)_malloc(0x104);
      if (puVar1 == (uint *)0x0) {
        pDVar2 = FUN_00405095();
        *pDVar2 = 0xc;
        return (uint *)0x0;
      }
      param_3 = 0x104;
    }
    DVar3 = GetFullPathNameA(lpFileName,param_3,(LPSTR)puVar1,&param_2);
    if (DVar3 < param_3) {
      if (DVar3 != 0) {
        return puVar1;
      }
      if (param_1 == (uint *)0x0) {
        FUN_00404d98((undefined *)puVar1);
      }
      DVar3 = GetLastError();
      FUN_00405022(DVar3);
    }
    else {
      if (param_1 == (uint *)0x0) {
        FUN_00404d98((undefined *)puVar1);
      }
      pDVar2 = FUN_00405095();
      *pDVar2 = 0x22;
    }
    return (uint *)0x0;
  }
  puVar1 = FUN_0040caba(param_1,param_3);
  return puVar1;
}



Function: FUN_0040c967
----------------------------------------

int FUN_0040c967(void)

{
  DWORD DVar1;
  uint uVar2;
  int iVar3;
  byte local_108;
  char local_107;
  
  iVar3 = 0;
  DVar1 = GetCurrentDirectoryA(0x104,(LPSTR)&local_108);
  if ((DVar1 != 0) && (local_107 == ':')) {
    uVar2 = FUN_0040ac52((uint)local_108);
    iVar3 = uVar2 - 0x40;
  }
  return iVar3;
}



Function: FUN_0040c9aa
----------------------------------------

uint __cdecl FUN_0040c9aa(uint param_1)

{
  uint uVar1;
  uint uVar2;
  int iVar3;
  uint uVar4;
  undefined1 uVar5;
  undefined2 local_8;
  
  uVar4 = param_1;
  if (param_1 < 0x100) {
    if (((&DAT_00412561)[param_1] & 0x10) == 0x10) {
      uVar4 = (uint)(byte)(&DAT_00412460)[param_1];
    }
  }
  else {
    uVar5 = (undefined1)param_1;
    uVar2 = param_1 >> 8;
    uVar1 = param_1 >> 8;
    param_1 = CONCAT13(uVar5,CONCAT12((char)uVar1,(undefined2)param_1));
    if ((((&DAT_00412561)[uVar2 & 0xff] & 4) != 0) &&
       (iVar3 = FUN_0040aa2e(DAT_00412664,0x100,(char *)((int)&param_1 + 2),2,&local_8,2,
                             DAT_00412440,1), iVar3 != 0)) {
      uVar4 = (uint)CONCAT11((undefined1)local_8,local_8._1_1_);
    }
  }
  return uVar4;
}



Function: FUN_0040ca25
----------------------------------------

byte * __cdecl FUN_0040ca25(byte *param_1,byte *param_2)

{
  byte bVar1;
  byte *pbVar2;
  byte *pbVar3;
  
  if (DAT_0041245c == 0) {
    pbVar2 = FUN_0040af60(param_1,param_2);
    return pbVar2;
  }
  FUN_00407d25(0x19);
  bVar1 = *param_1;
  while (bVar1 != 0) {
    bVar1 = *param_2;
    pbVar2 = param_2;
    while (bVar1 != 0) {
      bVar1 = *pbVar2;
      if (((&DAT_00412561)[bVar1] & 4) == 0) {
        pbVar3 = pbVar2;
        if (bVar1 == *param_1) break;
      }
      else if (((bVar1 == *param_1) && (pbVar2[1] == param_1[1])) ||
              (pbVar3 = pbVar2 + 1, pbVar2[1] == 0)) break;
      pbVar2 = pbVar3 + 1;
      bVar1 = *pbVar2;
    }
    if ((*pbVar2 != 0) ||
       ((((&DAT_00412561)[*param_1] & 4) != 0 && (param_1 = param_1 + 1, *param_1 == 0)))) break;
    param_1 = param_1 + 1;
    bVar1 = *param_1;
  }
  FUN_00407d86(0x19);
  return (byte *)(-(uint)(*param_1 != 0) & (uint)param_1);
}



Function: FUN_0040caba
----------------------------------------

uint * __cdecl FUN_0040caba(uint *param_1,size_t param_2)

{
  uint *puVar1;
  
  FUN_00407d25(0xc);
  puVar1 = FUN_0040cae1(0,param_1,param_2);
  FUN_00407d86(0xc);
  return puVar1;
}



Function: FUN_0040cae1
----------------------------------------

uint * __cdecl FUN_0040cae1(uint param_1,uint *param_2,size_t param_3)

{
  int iVar1;
  DWORD *pDVar2;
  DWORD DVar3;
  uint uVar4;
  uint *puVar5;
  uint local_10c [65];
  LPSTR local_8;
  
  uVar4 = param_1;
  if (param_1 == 0) {
    DVar3 = GetCurrentDirectoryA(0x104,(LPSTR)local_10c);
  }
  else {
    iVar1 = FUN_0040cbb6(param_1);
    if (iVar1 == 0) {
      pDVar2 = FUN_0040509e();
      *pDVar2 = 0xf;
      pDVar2 = FUN_00405095();
      *pDVar2 = 0xd;
      return (uint *)0x0;
    }
    param_1 = (uint)CONCAT12(0x2e,CONCAT11(0x3a,(char)uVar4 + '@'));
    DVar3 = GetFullPathNameA((LPCSTR)&param_1,0x104,(LPSTR)local_10c,&local_8);
  }
  if ((DVar3 != 0) && (uVar4 = DVar3 + 1, uVar4 < 0x105)) {
    if (param_2 == (uint *)0x0) {
      if ((int)uVar4 <= (int)param_3) {
        uVar4 = param_3;
      }
      puVar5 = (uint *)_malloc(uVar4);
      if (puVar5 != (uint *)0x0) {
LAB_0040cba2:
        puVar5 = FUN_00404b30(puVar5,local_10c);
        return puVar5;
      }
      pDVar2 = FUN_00405095();
      *pDVar2 = 0xc;
    }
    else {
      puVar5 = param_2;
      if ((int)uVar4 <= (int)param_3) goto LAB_0040cba2;
      pDVar2 = FUN_00405095();
      *pDVar2 = 0x22;
    }
  }
  return (uint *)0x0;
}



Function: FUN_0040cbb6
----------------------------------------

undefined4 __cdecl FUN_0040cbb6(uint param_1)

{
  char cVar1;
  UINT UVar2;
  
  if (param_1 != 0) {
    cVar1 = (char)param_1;
    param_1 = (uint)CONCAT12(0x5c,CONCAT11(0x3a,cVar1 + '@'));
    UVar2 = GetDriveTypeA((LPCSTR)&param_1);
    if ((UVar2 == 0) || (UVar2 == 1)) {
      return 0;
    }
  }
  return 1;
}



